/*! For license information please see ../../../LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{186:function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var i=0,r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},187:function(t,e,n){var r,o=n(250),c=n(213),l=n(252),h=n(253),f=n(254);"undefined"!=typeof ArrayBuffer&&(r=n(255));var d="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),v="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=d||v;e.protocol=3;var y=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},w=o(y),x={type:"error",data:"parser error"},C=n(256);function map(t,e,n){for(var r=new Array(t.length),o=h(t.length,n),c=function(i,t,n){e(t,(function(t,e){r[i]=e,n(t,r)}))},i=0;i<t.length;i++)c(i,t[i],o)}e.encodePacket=function(t,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var data=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&data instanceof ArrayBuffer)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var data=t.data,o=new Uint8Array(data),c=new Uint8Array(1+data.byteLength);c[0]=y[t.type];for(var i=0;i<o.length;i++)c[i+1]=o[i];return r(c.buffer)}(t,n,o);if(void 0!==C&&data instanceof C)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);if(m)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var o=new FileReader;return o.onload=function(){e.encodePacket({type:t.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(t.data)}(t,n,r);var o=new Uint8Array(1);o[0]=y[t.type];var c=new C([o.buffer,t.data]);return r(c)}(t,n,o);if(data&&data.base64)return function(t,n){var r="b"+e.packets[t.type]+t.data.data;return n(r)}(t,o);var c=y[t.type];return void 0!==t.data&&(c+=r?f.encode(String(t.data),{strict:!1}):String(t.data)),o(""+c)},e.encodeBase64Packet=function(t,n){var r,o="b"+e.packets[t.type];if(void 0!==C&&t.data instanceof C){var c=new FileReader;return c.onload=function(){var t=c.result.split(",")[1];n(o+t)},c.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var l=new Uint8Array(t.data),h=new Array(l.length),i=0;i<l.length;i++)h[i]=l[i];r=String.fromCharCode.apply(null,h)}return o+=btoa(r),n(o)},e.decodePacket=function(data,t,n){if(void 0===data)return x;if("string"==typeof data){if("b"===data.charAt(0))return e.decodeBase64Packet(data.substr(1),t);if(n&&!1===(data=function(data){try{data=f.decode(data,{strict:!1})}catch(t){return!1}return data}(data)))return x;var r=data.charAt(0);return Number(r)==r&&w[r]?data.length>1?{type:w[r],data:data.substring(1)}:{type:w[r]}:x}r=new Uint8Array(data)[0];var o=l(data,1);return C&&"blob"===t&&(o=new C([o])),{type:w[r],data:o}},e.decodeBase64Packet=function(t,e){var n=w[t.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:t.substr(1)}};var data=r.decode(t.substr(1));return"blob"===e&&C&&(data=new C([data])),{type:n,data:data}},e.encodePayload=function(t,n,r){"function"==typeof n&&(r=n,n=null);var o=c(t);if(n&&o)return C&&!m?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r);if(!t.length)return r("0:");map(t,(function(t,r){e.encodePacket(t,!!o&&n,!1,(function(t){r(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return r(e.join(""))}))},e.decodePayload=function(data,t,n){if("string"!=typeof data)return e.decodePayloadAsBinary(data,t,n);var r;if("function"==typeof t&&(n=t,t=null),""===data)return n(x,0,1);for(var o,c,l="",i=0,h=data.length;i<h;i++){var f=data.charAt(i);if(":"===f){if(""===l||l!=(o=Number(l)))return n(x,0,1);if(l!=(c=data.substr(i+1,o)).length)return n(x,0,1);if(c.length){if(r=e.decodePacket(c,t,!1),x.type===r.type&&x.data===r.data)return n(x,0,1);if(!1===n(r,i+o,h))return}i+=o,l=""}else l+=f}return""!==l?n(x,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,n){if(!t.length)return n(new ArrayBuffer(0));map(t,(function(t,n){e.encodePacket(t,!0,!0,(function(data){return n(null,data)}))}),(function(t,e){var r=e.reduce((function(t,p){var e;return t+(e="string"==typeof p?p.length:p.byteLength).toString().length+e+2}),0),o=new Uint8Array(r),c=0;return e.forEach((function(p){var t="string"==typeof p,e=p;if(t){for(var view=new Uint8Array(p.length),i=0;i<p.length;i++)view[i]=p.charCodeAt(i);e=view.buffer}o[c++]=t?0:1;var n=e.byteLength.toString();for(i=0;i<n.length;i++)o[c++]=parseInt(n[i]);o[c++]=255;for(view=new Uint8Array(e),i=0;i<view.length;i++)o[c++]=view[i]})),n(o.buffer)}))},e.encodePayloadAsBlob=function(t,n){map(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var view=new Uint8Array(t.length),i=0;i<t.length;i++)view[i]=t.charCodeAt(i);t=view.buffer,e[0]=0}var r=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),o=new Uint8Array(r.length+1);for(i=0;i<r.length;i++)o[i]=parseInt(r[i]);if(o[r.length]=255,C){var c=new C([e.buffer,o.buffer,t]);n(null,c)}}))}),(function(t,e){return n(new C(e))}))},e.decodePayloadAsBinary=function(data,t,n){"function"==typeof t&&(n=t,t=null);for(var r=data,o=[];r.byteLength>0;){for(var c=new Uint8Array(r),h=0===c[0],f="",i=1;255!==c[i];i++){if(f.length>310)return n(x,0,1);f+=c[i]}r=l(r,2+f.length),f=parseInt(f);var d=l(r,0,f);if(h)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(t){var v=new Uint8Array(d);d="";for(i=0;i<v.length;i++)d+=String.fromCharCode(v[i])}o.push(d),r=l(r,f)}var m=o.length;o.forEach((function(r,i){n(e.decodePacket(r,t,!0),i,m)}))}},189:function(t,e,n){(function(r){e.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))}),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(237)(e);const{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(82))},190:function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},n=t.split("&"),i=0,r=n.length;i<r;i++){var o=n[i].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},191:function(t,e){t.exports=function(a,b){var t=function(){};t.prototype=b.prototype,a.prototype=new t,a.prototype.constructor=a}},192:function(t,e,n){(function(r){e.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))}),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(257)(e);const{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(82))},198:function(t,e,n){var r=n(239)("socket.io-parser"),o=n(186),c=n(242),l=n(208),h=n(209);function f(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=f,e.Decoder=m;var d=e.ERROR+'"encode error"';function v(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var o=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===o)return d;n+=o}return r("encoded %j as %s",t,n),n}function m(){this.reconstructor=null}function y(t){this.reconPack=t,this.buffers=[]}function w(t){return{type:e.ERROR,data:"parser error: "+t}}f.prototype.encode=function(t,n){(r("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){c.removeBlobs(t,(function(t){var n=c.deconstructPacket(t),r=v(n.packet),o=n.buffers;o.unshift(r),e(o)}))}(t,n):n([v(t)])},o(m.prototype),m.prototype.add=function(t){var n;if("string"==typeof t)n=function(t){var i=0,p={type:Number(t.charAt(0))};if(null==e.types[p.type])return w("unknown packet type "+p.type);if(e.BINARY_EVENT===p.type||e.BINARY_ACK===p.type){for(var n="";"-"!==t.charAt(++i)&&(n+=t.charAt(i),i!=t.length););if(n!=Number(n)||"-"!==t.charAt(i))throw new Error("Illegal attachments");p.attachments=Number(n)}if("/"===t.charAt(i+1))for(p.nsp="";++i;){if(","===(c=t.charAt(i)))break;if(p.nsp+=c,i===t.length)break}else p.nsp="/";var o=t.charAt(i+1);if(""!==o&&Number(o)==o){for(p.id="";++i;){var c;if(null==(c=t.charAt(i))||Number(c)!=c){--i;break}if(p.id+=t.charAt(i),i===t.length)break}p.id=Number(p.id)}if(t.charAt(++i)){var h=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(i));if(!(!1!==h&&(p.type===e.ERROR||l(h))))return w("invalid payload");p.data=h}return r("decoded %s as %j",t,p),p}(t),e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type?(this.reconstructor=new y(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!h(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",n))}},m.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},y.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=c.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},y.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},199:function(t,e,n){"use strict";(function(t){var r=n(243),o=n(244),c=n(245);function l(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function h(t,e){if(l()<e)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=f.prototype:(null===t&&(t=new f(e)),t.length=e),t}function f(t,e,n){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return m(this,t)}return d(this,t,e,n)}function d(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);f.TYPED_ARRAY_SUPPORT?(t=e).__proto__=f.prototype:t=y(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!f.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|x(e,n),o=(t=h(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(f.isBuffer(e)){var n=0|w(e.length);return 0===(t=h(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?h(t,0):y(t,e);if("Buffer"===e.type&&c(e.data))return y(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function v(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function m(t,e){if(v(e),t=h(t,e<0?0:0|w(e)),!f.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function y(t,e){var n=e.length<0?0:0|w(e.length);t=h(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function w(t){if(t>=l())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l().toString(16)+" bytes");return 0|t}function x(t,e){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(t).length;default:if(r)return Y(t).length;e=(""+e).toLowerCase(),r=!0}}function C(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return _(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return F(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return R(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function S(b,t,e){var i=b[t];b[t]=b[e],b[e]=i}function k(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=f.from(e,r)),f.isBuffer(e))return 0===e.length?-1:O(t,e,n,r,o);if("number"==typeof e)return e&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):O(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function O(t,e,n,r,o){var i,c=1,l=t.length,h=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;c=2,l/=2,h/=2,n/=2}function f(t,i){return 1===c?t[i]:t.readUInt16BE(i*c)}if(o){var d=-1;for(i=n;i<l;i++)if(f(t,i)===f(e,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===h)return d*c}else-1!==d&&(i-=i-d),d=-1}else for(n+h>l&&(n=l-h),i=n;i>=0;i--){for(var v=!0,m=0;m<h;m++)if(f(t,i+m)!==f(e,m)){v=!1;break}if(v)return i}return-1}function M(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var c=e.length;if(c%2!=0)throw new TypeError("Invalid hex string");r>c/2&&(r=c/2);for(var i=0;i<r;++i){var l=parseInt(e.substr(2*i,2),16);if(isNaN(l))return i;t[n+i]=l}return i}function N(t,e,n,r){return G(Y(e,t.length-n),t,n,r)}function A(t,e,n,r){return G(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,n,r)}function E(t,e,n,r){return A(t,e,n,r)}function T(t,e,n,r){return G(X(e),t,n,r)}function D(t,e,n,r){return G(function(t,e){for(var n,r,o,c=[],i=0;i<t.length&&!((e-=2)<0);++i)n=t.charCodeAt(i),r=n>>8,o=n%256,c.push(o),c.push(r);return c}(e,t.length-n),t,n,r)}function R(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,c,l,h,f=t[i],d=null,v=f>239?4:f>223?3:f>191?2:1;if(i+v<=n)switch(v){case 1:f<128&&(d=f);break;case 2:128==(192&(o=t[i+1]))&&(h=(31&f)<<6|63&o)>127&&(d=h);break;case 3:o=t[i+1],c=t[i+2],128==(192&o)&&128==(192&c)&&(h=(15&f)<<12|(63&o)<<6|63&c)>2047&&(h<55296||h>57343)&&(d=h);break;case 4:o=t[i+1],c=t[i+2],l=t[i+3],128==(192&o)&&128==(192&c)&&128==(192&l)&&(h=(15&f)<<18|(63&o)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(d=h)}null===d?(d=65533,v=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),i+=v}return function(t){var e=t.length;if(e<=B)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=B));return n}(r)}e.Buffer=f,e.SlowBuffer=function(t){+t!=t&&(t=0);return f.alloc(+t)},e.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=l(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,e,n){return d(null,t,e,n)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,e,n){return function(t,e,n,r){return v(e),e<=0?h(t,e):void 0!==n?"string"==typeof r?h(t,e).fill(n,r):h(t,e).fill(n):h(t,e)}(null,t,e,n)},f.allocUnsafe=function(t){return m(null,t)},f.allocUnsafeSlow=function(t){return m(null,t)},f.isBuffer=function(b){return!(null==b||!b._isBuffer)},f.compare=function(a,b){if(!f.isBuffer(a)||!f.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var t=a.length,e=b.length,i=0,n=Math.min(t,e);i<n;++i)if(a[i]!==b[i]){t=a[i],e=b[i];break}return t<e?-1:e<t?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,e){if(!c(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=f.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var o=t[i];if(!f.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},f.byteLength=x,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<t;i+=2)S(this,i,i+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<t;i+=4)S(this,i,i+3),S(this,i+1,i+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<t;i+=8)S(this,i,i+7),S(this,i+1,i+6),S(this,i+2,i+5),S(this,i+3,i+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):C.apply(this,arguments)},f.prototype.equals=function(b){if(!f.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===f.compare(this,b)},f.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,e,n,r,o){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var c=(o>>>=0)-(r>>>=0),l=(n>>>=0)-(e>>>=0),h=Math.min(c,l),d=this.slice(r,o),v=t.slice(e,n),i=0;i<h;++i)if(d[i]!==v[i]){c=d[i],l=v[i];break}return c<l?-1:l<c?1:0},f.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},f.prototype.indexOf=function(t,e,n){return k(this,t,e,n,!0)},f.prototype.lastIndexOf=function(t,e,n){return k(this,t,e,n,!1)},f.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var c=!1;;)switch(r){case"hex":return M(this,t,e,n);case"utf8":case"utf-8":return N(this,t,e,n);case"ascii":return A(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return T(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,e,n);default:if(c)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),c=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;function F(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function _(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=K(t[i]);return o}function z(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function L(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function j(t,e,n,r,o,c){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<c)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function V(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function $(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function U(t,e,n,r,o,c){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(t,e,n,r,c){return c||U(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function J(t,e,n,r,c){return c||U(t,0,n,8),o.write(t,e,n,r,52,8),n+8}f.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),f.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=f.prototype;else{var o=e-t;n=new f(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},f.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},f.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},f.prototype.readUInt8=function(t,e){return e||L(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,e){return e||L(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,e){return e||L(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,e){return e||L(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,e){return e||L(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},f.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},f.prototype.readInt8=function(t,e){return e||L(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,e){e||L(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt16BE=function(t,e){e||L(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt32LE=function(t,e){return e||L(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,e){return e||L(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,e){return e||L(t,4,this.length),o.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,e){return e||L(t,4,this.length),o.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,e){return e||L(t,8,this.length),o.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,e){return e||L(t,8,this.length),o.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},f.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},f.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},f.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):V(this,t,e,!0),e+2},f.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):V(this,t,e,!1),e+2},f.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):$(this,t,e,!0),e+4},f.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):$(this,t,e,!1),e+4},f.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);j(this,t,e,n,o-1,-o)}var i=0,c=1,sub=0;for(this[e]=255&t;++i<n&&(c*=256);)t<0&&0===sub&&0!==this[e+i-1]&&(sub=1),this[e+i]=(t/c>>0)-sub&255;return e+n},f.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);j(this,t,e,n,o-1,-o)}var i=n-1,c=1,sub=0;for(this[e+i]=255&t;--i>=0&&(c*=256);)t<0&&0===sub&&0!==this[e+i+1]&&(sub=1),this[e+i]=(t/c>>0)-sub&255;return e+n},f.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},f.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):V(this,t,e,!0),e+2},f.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):V(this,t,e,!1),e+2},f.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):$(this,t,e,!0),e+4},f.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):$(this,t,e,!1),e+4},f.prototype.writeFloatLE=function(t,e,n){return W(this,t,e,!0,n)},f.prototype.writeFloatBE=function(t,e,n){return W(this,t,e,!1,n)},f.prototype.writeDoubleLE=function(t,e,n){return J(this,t,e,!0,n)},f.prototype.writeDoubleBE=function(t,e,n){return J(this,t,e,!1,n)},f.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},f.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var code=t.charCodeAt(0);code<256&&(t=code)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var o=f.isBuffer(t)?t:Y(new f(t,r).toString()),c=o.length;for(i=0;i<n-e;++i)this[i+e]=o[i%c]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function K(t){return t<16?"0"+t.toString(16):t.toString(16)}function Y(t,e){var n;e=e||1/0;for(var r=t.length,o=null,c=[],i=0;i<r;++i){if((n=t.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&c.push(239,191,189);continue}if(i+1===r){(e-=3)>-1&&c.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&c.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&c.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;c.push(n)}else if(n<2048){if((e-=2)<0)break;c.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;c.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;c.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return c}function X(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(35))},200:function(t,e,n){var r=n(248),o=n(201);t.exports=function(t){var e=t.xdomain,n=t.xscheme,c=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&c)return new XDomainRequest}catch(t){}if(!e)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},201:function(t,e){t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},202:function(t,e,n){var r=n(187),o=n(186);function c(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=c,o(c.prototype),c.prototype.onError=function(t,desc){var e=new Error(t);return e.type="TransportError",e.description=desc,this.emit("error",e),this},c.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},c.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},c.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},c.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},c.prototype.onData=function(data){var t=r.decodePacket(data,this.socket.binaryType);this.onPacket(t)},c.prototype.onPacket=function(t){this.emit("packet",t)},c.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},207:function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,b=t.indexOf("["),o=t.indexOf("]");-1!=b&&-1!=o&&(t=t.substring(0,b)+t.substring(b,o).replace(/:/g,";")+t.substring(o,t.length));for(var c=n.exec(t||""),l={},i=14;i--;)l[r[i]]=c[i]||"";return-1!=b&&-1!=o&&(l.source=e,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l}},208:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},209:function(t,e,n){(function(e){t.exports=function(t){return n&&e.isBuffer(t)||r&&(t instanceof ArrayBuffer||o(t))};var n="function"==typeof e&&"function"==typeof e.isBuffer,r="function"==typeof ArrayBuffer,o=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}}).call(this,n(199).Buffer)},210:function(t,e,n){var r=n(246),o=n(216),c=n(186),l=n(198),h=n(217),f=n(218),d=n(189)("socket.io-client:manager"),v=n(215),m=n(263),y=Object.prototype.hasOwnProperty;function w(t,e){if(!(this instanceof w))return new w(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new m({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||l;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=w,w.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)y.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},w.prototype.updateSocketIds=function(){for(var t in this.nsps)y.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},w.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},c(w.prototype),w.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},w.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},w.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},w.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},w.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},w.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},w.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},w.prototype.open=w.prototype.connect=function(t,e){if(d("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;d("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var c=h(n,"open",(function(){o.onopen(),t&&t()})),l=h(n,"error",(function(data){if(d("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",data),t){var e=new Error("Connection error");e.data=data,t(e)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var f=this._timeout;d("connect attempt will timeout after %d",f);var v=setTimeout((function(){d("connect attempt timed out after %d",f),c.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",f)}),f);this.subs.push({destroy:function(){clearTimeout(v)}})}return this.subs.push(c),this.subs.push(l),this},w.prototype.onopen=function(){d("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(h(t,"data",f(this,"ondata"))),this.subs.push(h(t,"ping",f(this,"onping"))),this.subs.push(h(t,"pong",f(this,"onpong"))),this.subs.push(h(t,"error",f(this,"onerror"))),this.subs.push(h(t,"close",f(this,"onclose"))),this.subs.push(h(this.decoder,"decoded",f(this,"ondecoded")))},w.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},w.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},w.prototype.ondata=function(data){this.decoder.add(data)},w.prototype.ondecoded=function(t){this.emit("packet",t)},w.prototype.onerror=function(t){d("error",t),this.emitAll("error",t)},w.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new o(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",c),n.on("connect",(function(){n.id=r.generateId(t)})),this.autoConnect&&c()}function c(){~v(r.connecting,n)||r.connecting.push(n)}return n},w.prototype.destroy=function(t){var e=v(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},w.prototype.packet=function(t){d("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(n){for(var i=0;i<n.length;i++)e.engine.write(n[i],t.options);e.encoding=!1,e.processPacketQueue()})))},w.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},w.prototype.cleanup=function(){d("cleanup");for(var t=this.subs.length,i=0;i<t;i++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},w.prototype.close=w.prototype.disconnect=function(){d("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},w.prototype.onclose=function(t){d("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},w.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();d("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout((function(){t.skipReconnect||(d("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(d("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(d("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(n)}})}},w.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},211:function(t,e,n){var r=n(200),o=n(249),c=n(259),l=n(260);e.polling=function(t){var e=!1,n=!1,l=!1!==t.jsonp;if("undefined"!=typeof location){var h="https:"===location.protocol,f=location.port;f||(f=h?443:80),e=t.hostname!==location.hostname||f!==t.port,n=t.secure!==h}if(t.xdomain=e,t.xscheme=n,"open"in new r(t)&&!t.forceJSONP)return new o(t);if(!l)throw new Error("JSONP disabled");return new c(t)},e.websocket=l},212:function(t,e,n){var r=n(202),o=n(190),c=n(187),l=n(191),h=n(214),f=n(192)("engine.io-client:polling");t.exports=v;var d=null!=new(n(200))({xdomain:!1}).responseType;function v(t){var e=t&&t.forceBase64;d&&!e||(this.supportsBinary=!1),r.call(this,t)}l(v,r),v.prototype.name="polling",v.prototype.doOpen=function(){this.poll()},v.prototype.pause=function(t){var e=this;function n(){f("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(f("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){f("pre-pause polling complete"),--r||n()}))),this.writable||(f("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){f("pre-pause writing complete"),--r||n()})))}else n()},v.prototype.poll=function(){f("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},v.prototype.onData=function(data){var t=this;f("polling got data %s",data);c.decodePayload(data,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():f('ignoring poll - transport state "%s"',this.readyState))},v.prototype.doClose=function(){var t=this;function e(){f("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(f("transport open - closing"),e()):(f("transport not open - deferring close"),this.once("open",e))},v.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};c.encodePayload(t,this.supportsBinary,(function(data){e.doWrite(data,n)}))},v.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=h()),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t}},213:function(t,e,n){(function(e){var r=n(251),o=Object.prototype.toString,c="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);t.exports=function t(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,o=n.length;i<o;i++)if(t(n[i]))return!0;return!1}if("function"==typeof e&&e.isBuffer&&e.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||c&&n instanceof Blob||l&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return t(n.toJSON(),!0);for(var h in n)if(Object.prototype.hasOwnProperty.call(n,h)&&t(n[h]))return!0;return!1}}).call(this,n(199).Buffer)},214:function(t,e,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),c=64,map={},l=0,i=0;function h(t){var e="";do{e=o[t%c]+e,t=Math.floor(t/c)}while(t>0);return e}function f(){var t=h(+new Date);return t!==r?(l=0,r=t):t+"."+h(l++)}for(;i<c;i++)map[o[i]]=i;f.encode=h,f.decode=function(t){var e=0;for(i=0;i<t.length;i++)e=e*c+map[t.charAt(i)];return e},t.exports=f},215:function(t,e){var n=[].indexOf;t.exports=function(t,e){if(n)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1}},216:function(t,e,n){var r=n(198),o=n(186),c=n(262),l=n(217),h=n(218),f=n(189)("socket.io-client:socket"),d=n(190),v=n(213);t.exports=w;var m={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},y=o.prototype.emit;function w(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(w.prototype),w.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[l(t,"open",h(this,"onopen")),l(t,"packet",h(this,"onpacket")),l(t,"close",h(this,"onclose"))]}},w.prototype.open=w.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},w.prototype.send=function(){var t=c(arguments);return t.unshift("message"),this.emit.apply(this,t),this},w.prototype.emit=function(t){if(m.hasOwnProperty(t))return y.apply(this,arguments),this;var e=c(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:v(e))?r.BINARY_EVENT:r.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(f("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},w.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},w.prototype.onopen=function(){if(f("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?d.encode(this.query):this.query;f("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},w.prototype.onclose=function(t){f("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},w.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===r.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},w.prototype.onevent=function(t){var e=t.data||[];f("emitting event %j",e),null!=t.id&&(f("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?y.apply(this,e):this.receiveBuffer.push(e)},w.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var o=c(arguments);f("sending ack %j",o),e.packet({type:v(o)?r.BINARY_ACK:r.ACK,id:t,data:o})}}},w.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(f("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):f("bad ack %s",t.id)},w.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},w.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++)y.apply(this,this.receiveBuffer[i]);for(this.receiveBuffer=[],i=0;i<this.sendBuffer.length;i++)this.packet(this.sendBuffer[i]);this.sendBuffer=[]},w.prototype.ondisconnect=function(){f("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},w.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++)this.subs[i].destroy();this.subs=null}this.io.destroy(this)},w.prototype.close=w.prototype.disconnect=function(){return this.connected&&(f("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},w.prototype.compress=function(t){return this.flags.compress=t,this},w.prototype.binary=function(t){return this.flags.binary=t,this}},217:function(t,e){t.exports=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}},218:function(t,e){var n=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}},219:function(t,e,n){"use strict";n.r(e),n.d(e,"CellSelection",(function(){return Ir})),n.d(e,"TableMap",(function(){return xr})),n.d(e,"__clipCells",(function(){return Wr})),n.d(e,"__insertCells",(function(){return Kr})),n.d(e,"__pastedCells",(function(){return qr})),n.d(e,"addColumn",(function(){return uo})),n.d(e,"addColumnAfter",(function(){return ho})),n.d(e,"addColumnBefore",(function(){return lo})),n.d(e,"addRow",(function(){return mo})),n.d(e,"addRowAfter",(function(){return yo})),n.d(e,"addRowBefore",(function(){return go})),n.d(e,"cellAround",(function(){return kr})),n.d(e,"colCount",(function(){return Dr})),n.d(e,"columnResizing",(function(){return Io})),n.d(e,"columnResizingPluginKey",(function(){return Fo})),n.d(e,"deleteColumn",(function(){return po})),n.d(e,"deleteRow",(function(){return wo})),n.d(e,"deleteTable",(function(){return Ro})),n.d(e,"findCell",(function(){return Tr})),n.d(e,"fixTables",(function(){return ao})),n.d(e,"fixTablesKey",(function(){return so})),n.d(e,"goToNextCell",(function(){return Do})),n.d(e,"handlePaste",(function(){return eo})),n.d(e,"inSameTable",(function(){return Er})),n.d(e,"isInTable",(function(){return Or})),n.d(e,"mergeCells",(function(){return Co})),n.d(e,"moveCellForward",(function(){return Ar})),n.d(e,"nextCell",(function(){return Rr})),n.d(e,"removeColumn",(function(){return fo})),n.d(e,"removeRow",(function(){return bo})),n.d(e,"rowIsHeader",(function(){return vo})),n.d(e,"selectedRect",(function(){return co})),n.d(e,"selectionCell",(function(){return Mr})),n.d(e,"setCellAttr",(function(){return Oo})),n.d(e,"splitCell",(function(){return So})),n.d(e,"splitCellWithType",(function(){return ko})),n.d(e,"tableEditing",(function(){return $o})),n.d(e,"tableEditingKey",(function(){return Sr})),n.d(e,"tableNodes",(function(){return Vr})),n.d(e,"toggleHeader",(function(){return No})),n.d(e,"toggleHeaderCell",(function(){return To})),n.d(e,"toggleHeaderColumn",(function(){return Eo})),n.d(e,"toggleHeaderRow",(function(){return Ao})),n.d(e,"updateColumnsOnResize",(function(){return Bo}));var r=n(182),o=n(185);var c=function(content,t){if(this.content=content,this.size=t||0,null==t)for(var i=0;i<content.length;i++)this.size+=content[i].nodeSize},l={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};c.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,c=0;c<e;i++){var l=this.content[i],h=c+l.nodeSize;if(h>t&&!1!==n(l,r+c,o,i)&&l.content.size){var f=c+1;l.nodesBetween(Math.max(0,t-f),Math.min(l.content.size,e-f),n,r+f)}c=h}},c.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},c.prototype.textBetween=function(t,e,n,r){var text="",o=!0;return this.nodesBetween(t,e,(function(c,l){c.isText?(text+=c.text.slice(Math.max(t,l)-l,e-l),o=!n):c.isLeaf&&r?(text+=r,o=!n):!o&&c.isBlock&&(text+=n,o=!0)}),0),text},c.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,content=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(content[content.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)content.push(t.content[i]);return new c(content,this.size+t.size)},c.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,o=0;o<e;i++){var l=this.content[i],h=o+l.nodeSize;h>t&&((o<t||h>e)&&(l=l.isText?l.cut(Math.max(0,t-o),Math.min(l.text.length,e-o)):l.cut(Math.max(0,t-o-1),Math.min(l.content.size,e-o-1))),n.push(l),r+=l.nodeSize),o=h}return new c(n,r)},c.prototype.cutByIndex=function(t,e){return t==e?c.empty:0==t&&e==this.content.length?this:new c(this.content.slice(t,e))},c.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new c(r,o)},c.prototype.addToStart=function(t){return new c([t].concat(this.content),this.size+t.nodeSize)},c.prototype.addToEnd=function(t){return new c(this.content.concat(t),this.size+t.nodeSize)},c.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0},l.firstChild.get=function(){return this.content.length?this.content[0]:null},l.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},l.childCount.get=function(){return this.content.length},c.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},c.prototype.maybeChild=function(t){return this.content[t]},c.prototype.forEach=function(t){for(var i=0,p=0;i<this.content.length;i++){var e=this.content[i];t(e,p,i),p+=e.nodeSize}},c.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(a,b,e){for(var i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:e;var n=a.child(i),r=b.child(i);if(n!=r){if(!n.sameMarkup(r))return e;if(n.isText&&n.text!=r.text){for(var o=0;n.text[o]==r.text[o];o++)e++;return e}if(n.content.size||r.content.size){var c=t(n.content,r.content,e+1);if(null!=c)return c}e+=n.nodeSize}else e+=n.nodeSize}}(this,t,e)},c.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(a,b,e,n){for(var r=a.childCount,o=b.childCount;;){if(0==r||0==o)return r==o?null:{a:e,b:n};var c=a.child(--r),l=b.child(--o),h=c.nodeSize;if(c!=l){if(!c.sameMarkup(l))return{a:e,b:n};if(c.isText&&c.text!=l.text){for(var f=0,d=Math.min(c.text.length,l.text.length);f<d&&c.text[c.text.length-f-1]==l.text[l.text.length-f-1];)f++,e--,n--;return{a:e,b:n}}if(c.content.size||l.content.size){var v=t(c.content,l.content,e-1,n-1);if(v)return v}e-=h,n-=h}else e-=h,n-=h}}(this,t,e,n)},c.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return f(0,t);if(t==this.size)return f(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var i=0,n=0;;i++){var r=n+this.child(i).nodeSize;if(r>=t)return r==t||e>0?f(i+1,r):f(i,n);n=r}},c.prototype.toString=function(){return"<"+this.toStringInner()+">"},c.prototype.toStringInner=function(){return this.content.join(", ")},c.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},c.fromJSON=function(t,e){if(!e)return c.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new c(e.map(t.nodeFromJSON))},c.fromArray=function(t){if(!t.length)return c.empty;for(var e,n=0,i=0;i<t.length;i++){var r=t[i];n+=r.nodeSize,i&&r.isText&&t[i-1].sameMarkup(r)?(e||(e=t.slice(0,i)),e[e.length-1]=r.withText(e[e.length-1].text+r.text)):e&&e.push(r)}return new c(e||t,n)},c.from=function(t){if(!t)return c.empty;if(t instanceof c)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new c([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(c.prototype,l);var h={index:0,offset:0};function f(t,e){return h.index=t,h.offset=e,h}function d(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var t=Array.isArray(a);if(Array.isArray(b)!=t)return!1;if(t){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!d(a[i],b[i]))return!1}else{for(var p in a)if(!(p in b&&d(a[p],b[p])))return!1;for(var e in b)if(!(e in a))return!1}return!0}c.empty=new c([],0);var v=function(t,e){this.type=t,this.attrs=e};function m(t){var e=Error.call(this,t);return e.__proto__=m.prototype,e}v.prototype.addToSet=function(t){for(var e,n=!1,i=0;i<t.length;i++){var r=t[i];if(this.eq(r))return t;if(this.type.excludes(r.type))e||(e=t.slice(0,i));else{if(r.type.excludes(this.type))return t;!n&&r.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),n=!0),e&&e.push(r)}}return e||(e=t.slice()),n||e.push(this),e},v.prototype.removeFromSet=function(t){for(var i=0;i<t.length;i++)if(this.eq(t[i]))return t.slice(0,i).concat(t.slice(i+1));return t},v.prototype.isInSet=function(t){for(var i=0;i<t.length;i++)if(this.eq(t[i]))return!0;return!1},v.prototype.eq=function(t){return this==t||this.type==t.type&&d(this.attrs,t.attrs)},v.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},v.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},v.sameSet=function(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0},v.setFrom=function(t){if(!t||0==t.length)return v.none;if(t instanceof v)return[t];var e=t.slice();return e.sort((function(a,b){return a.type.rank-b.type.rank})),e},v.none=[],m.prototype=Object.create(Error.prototype),m.prototype.constructor=m,m.prototype.name="ReplaceError";var y=function(content,t,e){this.content=content,this.openStart=t,this.openEnd=e},w={size:{configurable:!0}};function x(t,e,n){if(n.openStart>t.depth)throw new m("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new m("Inconsistent open depths");return function t(e,n,r,o){var l=e.index(o),h=e.node(o);if(l==n.index(o)&&o<e.depth-r.openStart){var f=t(e,n,r,o+1);return h.copy(h.content.replaceChild(l,f))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var d=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(c.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),v=d.start,m=d.end;return M(h,function t(e,n,r,o,l){var h=e.depth>l&&S(e,n,l+1),f=o.depth>l&&S(r,o,l+1),content=[];O(null,e,l,content),h&&f&&n.index(l)==r.index(l)?(C(h,f),k(M(h,t(e,n,r,o,l+1)),content)):(h&&k(M(h,N(e,n,l+1)),content),O(n,r,l,content),f&&k(M(f,N(r,o,l+1)),content));return O(o,null,l,content),new c(content)}(e,v,m,n,o))}var y=e.parent,content=y.content;return M(y,content.cut(0,e.parentOffset).append(r.content).append(content.cut(n.parentOffset)))}return M(h,N(e,n,o))}(t,e,n,0)}function C(main,sub){if(!sub.type.compatibleContent(main.type))throw new m("Cannot join "+sub.type.name+" onto "+main.type.name)}function S(t,e,n){var r=t.node(n);return C(r,e.node(n)),r}function k(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function O(t,e,n,r){var o=(e||t).node(n),c=0,l=e?e.index(n):o.childCount;t&&(c=t.index(n),t.depth>n?c++:t.textOffset&&(k(t.nodeAfter,r),c++));for(var i=c;i<l;i++)k(o.child(i),r);e&&e.depth==n&&e.textOffset&&k(e.nodeBefore,r)}function M(t,content){if(!t.type.validContent(content))throw new m("Invalid content for node "+t.type.name);return t.copy(content)}function N(t,e,n){var content=[];(O(null,t,n,content),t.depth>n)&&k(M(S(t,e,n+1),N(t,e,n+1)),content);return O(e,null,n,content),new c(content)}w.size.get=function(){return this.content.size-this.openStart-this.openEnd},y.prototype.insertAt=function(t,e){var content=function t(content,e,n,r){var o=content.findIndex(e),c=o.index,l=o.offset,h=content.maybeChild(c);if(l==e||h.isText)return r&&!r.canReplace(c,c,n)?null:content.cut(0,e).append(n).append(content.cut(e));var f=t(h.content,e-l-1,n);return f&&content.replaceChild(c,h.copy(f))}(this.content,t+this.openStart,e,null);return content&&new y(content,this.openStart,this.openEnd)},y.prototype.removeBetween=function(t,e){return new y(function t(content,e,n){var r=content.findIndex(e),o=r.index,c=r.offset,l=content.maybeChild(o),h=content.findIndex(n),f=h.index,d=h.offset;if(c==e||l.isText){if(d!=n&&!content.child(f).isText)throw new RangeError("Removing non-flat range");return content.cut(0,e).append(content.cut(n))}if(o!=f)throw new RangeError("Removing non-flat range");return content.replaceChild(o,l.copy(t(l.content,e-c-1,n-c-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},y.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},y.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},y.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},y.fromJSON=function(t,e){if(!e)return y.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new y(c.fromJSON(t,e.content),n,r)},y.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var c=t.lastChild;c&&!c.isLeaf&&(e||!c.type.spec.isolating);c=c.lastChild)r++;return new y(t,n,r)},Object.defineProperties(y.prototype,w),y.empty=new y(c.empty,0,0);var A=function(t,path,e){this.pos=t,this.path=path,this.depth=path.length/3-1,this.parentOffset=e},E={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};A.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},E.parent.get=function(){return this.node(this.depth)},E.doc.get=function(){return this.node(0)},A.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},A.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},A.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},A.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},A.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},A.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},A.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},E.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},E.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},E.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},A.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,i=0;i<t;i++)r+=n.child(i).nodeSize;return r},A.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return v.none;if(this.textOffset)return t.child(e).marks;var main=t.maybeChild(e-1),n=t.maybeChild(e);if(!main){var r=main;main=n,n=r}for(var o=main.marks,i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||n&&o[i].isInSet(n.marks)||(o=o[i--].removeFromSet(o));return o},A.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n},A.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},A.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new P(this,t,n)},A.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},A.prototype.max=function(t){return t.pos>this.pos?t:this},A.prototype.min=function(t){return t.pos<this.pos?t:this},A.prototype.toString=function(){for(var t="",i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset},A.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var path=[],n=0,r=e,o=t;;){var c=o.content.findIndex(r),l=c.index,h=c.offset,f=r-h;if(path.push(o,l,n+h),!f)break;if((o=o.child(l)).isText)break;r=f-1,n+=h+1}return new A(e,path,r)},A.resolveCached=function(t,e){for(var i=0;i<T.length;i++){var n=T[i];if(n.pos==e&&n.doc==t)return n}var r=T[D]=A.resolve(t,e);return D=(D+1)%R,r},Object.defineProperties(A.prototype,E);var T=[],D=0,R=12,P=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},B={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};B.start.get=function(){return this.$from.before(this.depth+1)},B.end.get=function(){return this.$to.after(this.depth+1)},B.parent.get=function(){return this.$from.node(this.depth)},B.startIndex.get=function(){return this.$from.index(this.depth)},B.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(P.prototype,B);var F=Object.create(null),I=function(t,e,content,n){this.type=t,this.attrs=e,this.content=content||c.empty,this.marks=n||v.none},_={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};_.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},_.childCount.get=function(){return this.content.childCount},I.prototype.child=function(t){return this.content.child(t)},I.prototype.maybeChild=function(t){return this.content.maybeChild(t)},I.prototype.forEach=function(t){this.content.forEach(t)},I.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},I.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},_.textContent.get=function(){return this.textBetween(0,this.content.size,"")},I.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},_.firstChild.get=function(){return this.content.firstChild},_.lastChild.get=function(){return this.content.lastChild},I.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},I.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},I.prototype.hasMarkup=function(t,e,n){return this.type==t&&d(this.attrs,e||t.defaultAttrs||F)&&v.sameSet(this.marks,n||v.none)},I.prototype.copy=function(content){return void 0===content&&(content=null),content==this.content?this:new this.constructor(this.type,this.attrs,content,this.marks)},I.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},I.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},I.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return y.empty;var r=this.resolve(t),o=this.resolve(e),c=n?0:r.sharedDepth(e),l=r.start(c),content=r.node(c).content.cut(r.pos-l,o.pos-l);return new y(content,r.depth-c,o.depth-c)},I.prototype.replace=function(t,e,n){return x(this.resolve(t),this.resolve(e),n)},I.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},I.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},I.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},I.prototype.resolve=function(t){return A.resolveCached(this,t)},I.prototype.resolveNoCache=function(t){return A.resolve(this,t)},I.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},_.isBlock.get=function(){return this.type.isBlock},_.isTextblock.get=function(){return this.type.isTextblock},_.inlineContent.get=function(){return this.type.inlineContent},_.isInline.get=function(){return this.type.isInline},_.isText.get=function(){return this.type.isText},_.isLeaf.get=function(){return this.type.isLeaf},_.isAtom.get=function(){return this.type.isAtom},I.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),L(this.marks,t)},I.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},I.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=c.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var l=this.contentMatchAt(t).matchFragment(n,r,o),h=l&&l.matchFragment(this.content,e);if(!h||!h.validEnd)return!1;for(var i=r;i<o;i++)if(!this.type.allowsMarks(n.child(i).marks))return!1;return!0},I.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),c=o&&o.matchFragment(this.content,e);return!!c&&c.validEnd},I.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},I.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},I.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},I.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var content=c.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,content,n)},Object.defineProperties(I.prototype,_);var z=function(t){function e(e,n,content,r){if(t.call(this,e,n,null,r),!content)throw new RangeError("Empty text nodes are not allowed");this.text=content}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):L(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(text){return text==this.text?this:new e(this.type,this.attrs,text,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var base=t.prototype.toJSON.call(this);return base.text=this.text,base},Object.defineProperties(e.prototype,n),e}(I);function L(t,e){for(var i=t.length-1;i>=0;i--)e=t[i].type.name+"("+e+")";return e}var j=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},V={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};j.parse=function(t,e){var n=new $(t,e);if(null==n.next)return j.empty;var r=W(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var c=o.indexOf(n),l=c>-1&&o[c+1];G(t,r).forEach((function(t){l||o.push(n,l=[]),-1==l.indexOf(t)&&l.push(t)}))}}))}));for(var c=e[r.join(",")]=new j(r.indexOf(t.length-1)>-1),i=0;i<o.length;i+=2){var l=o[i+1].sort(X);c.next.push(o[i],e[l.join(",")]||n(l))}return c}(G(t,0))}(function(t){var e=[[]];return o(function t(e,c){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,c))}),[]);if("seq"==e.type)for(var i=0;;i++){var l=t(e.exprs[i],c);if(i==e.exprs.length-1)return l;o(l,c=n())}else{if("star"==e.type){var h=n();return r(c,h),o(t(e.expr,h),h),[r(h)]}if("plus"==e.type){var f=n();return o(t(e.expr,c),f),o(t(e.expr,f),f),[r(f)]}if("opt"==e.type)return[r(c)].concat(t(e.expr,c));if("range"==e.type){for(var d=c,v=0;v<e.min;v++){var m=n();o(t(e.expr,d),m),d=m}if(-1==e.max)o(t(e.expr,d),d);else for(var y=e.min;y<e.max;y++){var w=n();r(d,w),o(t(e.expr,d),w),d=w}return[r(d)]}if("name"==e.type)return[r(c,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var i=0,n=[t];i<n.length;i++){for(var r=n[i],o=!r.validEnd,c=[],l=0;l<r.next.length;l+=2){var h=r.next[l],f=r.next[l+1];c.push(h.name),!o||h.isText||h.hasRequiredAttrs()||(o=!1),-1==n.indexOf(f)&&n.push(f)}o&&e.err("Only non-generatable nodes ("+c.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},j.prototype.matchType=function(t){for(var i=0;i<this.next.length;i+=2)if(this.next[i]==t)return this.next[i+1];return null},j.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,i=e;r&&i<n;i++)r=r.matchType(t.child(i).type);return r},V.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},V.defaultType.get=function(){for(var i=0;i<this.next.length;i+=2){var t=this.next[i];if(!t.isText&&!t.hasRequiredAttrs())return t}},j.prototype.compatible=function(t){for(var i=0;i<this.next.length;i+=2)for(var e=0;e<t.next.length;e+=2)if(this.next[i]==t.next[e])return!0;return!1},j.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(l,h){var f=l.matchFragment(t,n);if(f&&(!e||f.validEnd))return c.from(h.map((function(t){return t.createAndFill()})));for(var i=0;i<l.next.length;i+=2){var d=l.next[i],v=l.next[i+1];if(!d.isText&&!d.hasRequiredAttrs()&&-1==r.indexOf(v)){r.push(v);var m=o(v,h.concat(d));if(m)return m}}}(this,[])},j.prototype.findWrapping=function(t){for(var i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==t)return this.wrapCache[i+1];var e=this.computeWrapping(t);return this.wrapCache.push(t,e),e},j.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var c=[],l=r;l.type;l=l.via)c.push(l.type);return c.reverse()}for(var i=0;i<o.next.length;i+=2){var h=o.next[i];h.isLeaf||h.hasRequiredAttrs()||h.name in e||r.type&&!o.next[i+1].validEnd||(n.push({match:h.contentMatch,type:h,via:r}),e[h.name]=!0)}}},V.edgeCount.get=function(){return this.next.length>>1},j.prototype.edge=function(t){var i=t<<1;if(i>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[i],next:this.next[i+1]}},j.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var i=1;i<n.next.length;i+=2)-1==t.indexOf(n.next[i])&&e(n.next[i])}(this),t.map((function(e,i){for(var n=i+(e.validEnd?"*":" ")+" ",r=0;r<e.next.length;r+=2)n+=(r?", ":"")+e.next[r].name+"->"+t.indexOf(e.next[r+1]);return n})).join("\n")},Object.defineProperties(j.prototype,V),j.empty=new j(!0);var $=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},U={next:{configurable:!0}};function W(t){var e=[];do{e.push(J(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function J(t){var e=[];do{e.push(H(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function H(t){for(var e=function(t){if(t.eat("(")){var e=W(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var c in n){var l=n[c];l.groups.indexOf(e)>-1&&o.push(l)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Y(t,e)}return e}function K(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Y(t,e){var n=K(t),r=n;return t.eat(",")&&(r="}"!=t.next?K(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function X(a,b){return b-a}function G(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var c=o[i],l=c.term,h=c.to;l||-1!=n.indexOf(h)||e(h)}}(e),n.sort(X)}function Z(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Q(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var c=t[r];if(!c.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=c.default}n[r]=o}return n}function tt(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new ot(t[n]);return e}U.next.get=function(){return this.tokens[this.pos]},$.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},$.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties($.prototype,U);var et=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=tt(n.attrs),this.defaultAttrs=Z(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},nt={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};nt.isInline.get=function(){return!this.isBlock},nt.isTextblock.get=function(){return this.isBlock&&this.inlineContent},nt.isLeaf.get=function(){return this.contentMatch==j.empty},nt.isAtom.get=function(){return this.isLeaf||this.spec.atom},et.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},et.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},et.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Q(this.attrs,t)},et.prototype.create=function(t,content,e){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new I(this,this.computeAttrs(t),c.from(content),v.setFrom(e))},et.prototype.createChecked=function(t,content,e){if(content=c.from(content),!this.validContent(content))throw new RangeError("Invalid content for node "+this.name);return new I(this,this.computeAttrs(t),content,v.setFrom(e))},et.prototype.createAndFill=function(t,content,e){if(t=this.computeAttrs(t),(content=c.from(content)).size){var n=this.contentMatch.fillBefore(content);if(!n)return null;content=n.append(content)}var r=this.contentMatch.matchFragment(content).fillBefore(c.empty,!0);return r?new I(this,t,content.append(r),v.setFrom(e)):null},et.prototype.validContent=function(content){var t=this.contentMatch.matchFragment(content);if(!t||!t.validEnd)return!1;for(var i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0},et.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},et.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0},et.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,i=0;i<t.length;i++)this.allowsMarkType(t[i].type)?e&&e.push(t[i]):e||(e=t.slice(0,i));return e?e.length?e:v.empty:t},et.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new et(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(et.prototype,nt);var ot=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},it={isRequired:{configurable:!0}};it.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(ot.prototype,it);var st=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=tt(r.attrs),this.rank=e,this.excluded=null;var o=Z(this.attrs);this.instance=o&&new v(this,o)};st.prototype.create=function(t){return!t&&this.instance?this.instance:new v(this,Q(this.attrs,t))},st.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new st(t,r++,e,o)})),n},st.prototype.removeFromSet=function(t){for(var i=0;i<t.length;i++)if(t[i].type==this)return t.slice(0,i).concat(t.slice(i+1));return t},st.prototype.isInSet=function(t){for(var i=0;i<t.length;i++)if(t[i].type==this)return t[i]},st.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var at=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=o.a.from(t.nodes),this.spec.marks=o.a.from(t.marks),this.nodes=et.compile(this.spec.nodes,this),this.marks=st.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var c=this.nodes[r],l=c.spec.content||"",h=c.spec.marks;c.contentMatch=n[l]||(n[l]=j.parse(l,this.nodes)),c.inlineContent=c.contentMatch.inlineContent,c.markSet="_"==h?null:h?ct(this,h.split(" ")):""!=h&&c.inlineContent?null:[]}for(var f in this.marks){var d=this.marks[f],v=d.spec.excludes;d.excluded=null==v?[d]:""==v?[]:ct(this,v.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ct(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i],mark=t.marks[r],o=mark;if(mark)n.push(mark);else for(var c in t.marks){var l=t.marks[c];("_"==r||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}at.prototype.node=function(t,e,content,n){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof et))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,content,n)},at.prototype.text=function(t,e){var n=this.nodes.text;return new z(n,n.defaultAttrs,t,v.setFrom(e))},at.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},at.prototype.nodeFromJSON=function(t){return I.fromJSON(this,t)},at.prototype.markFromJSON=function(t){return v.fromJSON(this,t)},at.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var ut=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};ut.prototype.parse=function(t,e){void 0===e&&(e={});var n=new yt(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},ut.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new yt(this,e,!0);return n.addAll(t,null,e.from,e.to),y.maxOpen(n.finish())},ut.prototype.matchTag=function(t,e){for(var i=0;i<this.tags.length;i++){var n=this.tags[i];if(wt(t,n.tag)&&(void 0===n.namespace||t.namespaceURI==n.namespace)&&(!n.context||e.matchesContext(n.context))){if(n.getAttrs){var r=n.getAttrs(t);if(!1===r)continue;n.attrs=r}return n}}},ut.prototype.matchStyle=function(t,e,n){for(var i=0;i<this.styles.length;i++){var r=this.styles[i];if(!(0!=r.style.indexOf(t)||r.context&&!n.matchesContext(r.context)||r.style.length>t.length&&(61!=r.style.charCodeAt(t.length)||r.style.slice(t.length+1)!=e))){if(r.getAttrs){var o=r.getAttrs(e);if(!1===o)continue;r.attrs=o}return r}}},ut.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,i=0;i<e.length;i++){var r=e[i];if((null==r.priority?50:r.priority)<n)break}e.splice(i,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=xt(t)),t.mark=e}))};for(var o in t.marks)r(o);var c;for(var l in t.nodes)c=void 0,(c=t.nodes[l].spec.parseDOM)&&c.forEach((function(t){n(t=xt(t)),t.node=l}));return e},ut.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new ut(t,ut.schemaRules(t)))};var lt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ht={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ft={ol:!0,ul:!0},pt=1,vt=2;function mt(t){return(t?pt:0)|("full"===t?vt:0)}var gt=function(t,e,n,r,o,c,l){this.type=t,this.attrs=e,this.solid=o,this.match=c||(4&l?null:t.contentMatch),this.options=l,this.content=[],this.marks=n,this.activeMarks=v.none,this.pendingMarks=r};gt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(c.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},gt.prototype.finish=function(t){if(!(this.options&pt)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var content=c.from(this.content);return!t&&this.match&&(content=content.append(this.match.fillBefore(c.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content},gt.prototype.applyPending=function(t){for(var i=0,e=this.pendingMarks;i<e.length;i++){var mark=e[i];(this.type?this.type.allowsMarkType(mark.type):Ct(mark.type,t))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}};var yt=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,c=mt(e.preserveWhitespace)|(n?4:0);r=o?new gt(o.type,o.attrs,v.none,v.none,!0,e.topMatch||o.type.contentMatch,c):new gt(n?null:t.schema.topNodeType,null,v.none,v.none,!0,null,c),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},bt={top:{configurable:!0},currentPos:{configurable:!0}};function wt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function xt(t){var e={};for(var n in t)e[n]=t[n];return e}function Ct(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var c=[],l=function(t){c.push(t);for(var i=0;i<t.edgeCount;i++){var n=t.edge(i),r=n.type,o=n.next;if(r==e)return!0;if(c.indexOf(o)<0&&l(o))return!0}};return l(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var c=r(o);if(c)return c.v}}bt.top.get=function(){return this.nodes[this.open]},yt.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var style=t.getAttribute("style"),e=style?this.readStyles(function(style){var t,e=/\s*([\w-]+)\s*:\s*([^;]+)/g,n=[];for(;t=e.exec(style);)n.push(t[1],t[2].trim());return n}(style)):null,n=this.top;if(null!=e)for(var i=0;i<e.length;i++)this.addPendingMark(e[i]);if(this.addElement(t),null!=e)for(var r=0;r<e.length;r++)this.removePendingMark(e[r],n)}},yt.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(n.options&pt)n.options&vt||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},yt.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();ft.hasOwnProperty(e)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&ft.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:ht.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip||n.closeParent){n&&n.closeParent?this.open=Math.max(0,this.open-1):n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,c=this.needsBlock;if(lt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=c}else this.addElementByRule(t,n)},yt.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},yt.prototype.readStyles=function(t){for(var e=v.none,i=0;i<t.length;i+=2){var n=this.parser.matchStyle(t[i],t[i+1],this);if(n){if(n.ignore)return null;e=this.parser.schema.marks[n.mark].create(n.attrs).addToSet(e)}}return e},yt.prototype.addElementByRule=function(t,e){var n,r,mark,o=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(mark=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(mark));var c=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return o.insertNode(t)}));else{var l=e.contentElement;"string"==typeof l?l=t.querySelector(l):"function"==typeof l&&(l=l(t)),l||(l=t),this.findAround(t,l,!0),this.addAll(l,n)}n&&(this.sync(c),this.open--),mark&&this.removePendingMark(mark,c)},yt.prototype.addAll=function(t,e,n,r){for(var o=n||0,c=n?t.childNodes[n]:t.firstChild,l=null==r?null:t.childNodes[r];c!=l;c=c.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(c),e&&lt.hasOwnProperty(c.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},yt.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],c=o.findWrapping(t);if(c&&(!e||e.length>c.length)&&(e=c,n=o,!c.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0},yt.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,i=0;i<t.marks.length;i++)n.type&&!n.type.allowsMarkType(t.marks[i].type)||(r=t.marks[i].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},yt.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},yt.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var c=null==r?-5&o.options:mt(r);4&o.options&&0==o.content.length&&(c|=4),this.nodes.push(new gt(t,e,o.activeMarks,o.pendingMarks,n,null,c)),this.open++},yt.prototype.closeExtra=function(t){var i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}},yt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},yt.prototype.sync=function(t){for(var i=this.open;i>=0;i--)if(this.nodes[i]==t)return void(this.open=i)},bt.currentPos.get=function(){this.closeExtra();for(var t=0,i=this.open;i>=0;i--){for(var content=this.nodes[i].content,e=content.length-1;e>=0;e--)t+=content[e].nodeSize;i&&t++}return t},yt.prototype.findAtPoint=function(t,e){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&this.find[i].offset==e&&(this.find[i].pos=this.currentPos)},yt.prototype.findInside=function(t){if(this.find)for(var i=0;i<this.find.length;i++)null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)},yt.prototype.findAround=function(t,content,e){if(t!=content&&this.find)for(var i=0;i<this.find.length;i++){if(null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node))content.compareDocumentPosition(this.find[i].node)&(e?2:4)&&(this.find[i].pos=this.currentPos)}},yt.prototype.findInText=function(t){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))},yt.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),option=this.options.context,r=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),o=-(option?option.depth+1:0)+(r?0:1),c=function(i,t){for(;i>=0;i--){var l=n[i];if(""==l){if(i==n.length-1||0==i)continue;for(;t>=o;t--)if(c(i-1,t))return!0;return!1}var h=t>0||0==t&&r?e.nodes[t].type:option&&t>=o?option.node(t-o).type:null;if(!h||h.name!=l&&-1==h.groups.indexOf(l))return!1;t--}return!0};return c(n.length-1,this.open)},yt.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},yt.prototype.addPendingMark=function(mark){this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)},yt.prototype.removePendingMark=function(mark,t){for(var e=this.open;e>=0;e--){var n=this.nodes[e];if(n.pendingMarks.lastIndexOf(mark)>-1?n.pendingMarks=mark.removeFromSet(n.pendingMarks):n.activeMarks=mark.removeFromSet(n.activeMarks),n==t)break}},Object.defineProperties(yt.prototype,bt);var St=function(t,e){this.nodes=t||{},this.marks=e||{}};function kt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Ot(t){return t.document||window.document}St.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Ot(e).createDocumentFragment());var o=n,c=null;return t.forEach((function(t){if(c||t.marks.length){c||(c=[]);for(var n=0,l=0;n<c.length&&l<t.marks.length;){var h=t.marks[l];if(r.marks[h.type.name]){if(!h.eq(c[n])||!1===h.type.spec.spanning)break;n+=2,l++}else l++}for(;n<c.length;)o=c.pop(),c.pop();for(;l<t.marks.length;){var f=t.marks[l++],d=r.serializeMark(f,t.isInline,e);d&&(c.push(f,o),o.appendChild(d.dom),o=d.contentDOM||d.dom)}}o.appendChild(r.serializeNode(t,e))})),n},St.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=St.renderSpec(Ot(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},St.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),i=t.marks.length-1;i>=0;i--){var r=this.serializeMark(t.marks[i],t.isInline,e);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n},St.prototype.serializeMark=function(mark,t,e){void 0===e&&(e={});var n=this.marks[mark.type.name];return n&&St.renderSpec(Ot(e),n(mark,t))},St.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var c=null,l=n?t.createElementNS(n,r):t.createElement(r),h=e[1],f=1;if(h&&"object"==typeof h&&null==h.nodeType&&!Array.isArray(h))for(var d in f=2,h)if(null!=h[d]){var v=d.indexOf(" ");v>0?l.setAttributeNS(d.slice(0,v),d.slice(v+1),h[d]):l.setAttribute(d,h[d])}for(var i=f;i<e.length;i++){var m=e[i];if(0===m){if(i<e.length-1||i>f)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}var y=St.renderSpec(t,m,n),w=y.dom,x=y.contentDOM;if(l.appendChild(w),x){if(c)throw new RangeError("Multiple content holes");c=x}}return{dom:l,contentDOM:c}},St.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new St(this.nodesFromSchema(t),this.marksFromSchema(t)))},St.nodesFromSchema=function(t){var e=kt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},St.marksFromSchema=function(t){return kt(t.marks)};var Mt=n(193),Nt=n(183),At={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Et=/Edge\/(\d+)/.exec(navigator.userAgent),Tt=/MSIE \d/.test(navigator.userAgent),Dt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);At.mac=/Mac/.test(navigator.platform);var Rt=At.ie=!!(Tt||Dt||Et);At.ie_version=Tt?document.documentMode||6:Dt?+Dt[1]:Et?+Et[1]:null,At.gecko=!Rt&&/gecko\/(\d+)/i.test(navigator.userAgent),At.gecko_version=At.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Pt=!Rt&&/Chrome\/(\d+)/.exec(navigator.userAgent);At.chrome=!!Pt,At.chrome_version=Pt&&+Pt[1],At.ios=!Rt&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),At.android=/Android \d/.test(navigator.userAgent),At.webkit="webkitFontSmoothing"in document.documentElement.style,At.safari=/Apple Computer/.test(navigator.vendor),At.webkit_version=At.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Bt=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Ft=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},It=function(t,e,n){var r=document.createRange();return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},_t=function(t,e,n,r){return n&&(Lt(t,e,n,r,-1)||Lt(t,e,n,r,1))},zt=/^(img|br|input|textarea|hr)$/i;function Lt(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:jt(t))){var c=t.parentNode;if(1!=c.nodeType||Vt(t)||zt.test(t.nodeName)||"false"==t.contentEditable)return!1;e=Bt(t)+(o<0?0:1),t=c}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?jt(t):0}}}function jt(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Vt(t){for(var desc,e=t;e&&!(desc=e.pmViewDesc);e=e.parentNode);return desc&&desc.node&&desc.node.isBlock&&(desc.dom==t||desc.contentDOM==t)}var $t=function(t){var e=t.isCollapsed;return e&&At.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function qt(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function Ut(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Wt(t,e){return"number"==typeof t?t:t[e]}function Jt(t){var rect=t.getBoundingClientRect();return{left:rect.left,right:rect.left+t.clientWidth,top:rect.top,bottom:rect.top+t.clientHeight}}function Ht(view,rect,t){for(var e=view.someProp("scrollThreshold")||0,n=view.someProp("scrollMargin")||5,r=view.dom.ownerDocument,o=t||view.dom;o;o=Ft(o))if(1==o.nodeType){var c=o==r.body||1!=o.nodeType,l=c?Ut(r):Jt(o),h=0,f=0;if(rect.top<l.top+Wt(e,"top")?f=-(l.top-rect.top+Wt(n,"top")):rect.bottom>l.bottom-Wt(e,"bottom")&&(f=rect.bottom-l.bottom+Wt(n,"bottom")),rect.left<l.left+Wt(e,"left")?h=-(l.left-rect.left+Wt(n,"left")):rect.right>l.right-Wt(e,"right")&&(h=rect.right-l.right+Wt(n,"right")),h||f)if(c)r.defaultView.scrollBy(h,f);else{var d=o.scrollLeft,v=o.scrollTop;f&&(o.scrollTop+=f),h&&(o.scrollLeft+=h);var m=o.scrollLeft-d,y=o.scrollTop-v;rect={left:rect.left-m,top:rect.top-y,right:rect.right-m,bottom:rect.bottom-y}}if(c)break}}function Kt(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=Ft(t));return e}function Yt(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=n.dom,o=n.top,c=n.left;r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=c&&(r.scrollLeft=c)}}var Xt=null;function Gt(t,e){for(var n,r,o=2e8,c=0,l=e.top,h=e.top,f=t.firstChild,d=0;f;f=f.nextSibling,d++){var v=void 0;if(1==f.nodeType)v=f.getClientRects();else{if(3!=f.nodeType)continue;v=It(f).getClientRects()}for(var i=0;i<v.length;i++){var rect=v[i];if(rect.top<=l&&rect.bottom>=h){l=Math.max(rect.bottom,l),h=Math.min(rect.top,h);var m=rect.left>e.left?rect.left-e.left:rect.right<e.left?e.left-rect.right:0;if(m<o){n=f,o=m,r=m&&3==n.nodeType?{left:rect.right<e.left?rect.right:rect.left,top:e.top}:e,1==f.nodeType&&m&&(c=d+(e.left>=(rect.left+rect.right)/2?1:0));continue}}!n&&(e.left>=rect.right&&e.top>=rect.top||e.left>=rect.left&&e.top>=rect.bottom)&&(c=d+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);var rect=te(r,1);if(rect.top!=rect.bottom&&Zt(e,rect))return{node:t,offset:i+(e.left>=(rect.left+rect.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:c}:Gt(n,r)}function Zt(t,rect){return t.left>=rect.left-1&&t.left<=rect.right+1&&t.top>=rect.top-1&&t.top<=rect.bottom+1}function Qt(view,t){var e,n,r,o,c=view.root;if(c.caretPositionFromPoint)try{var l=c.caretPositionFromPoint(t.left,t.top);l&&(r=(e=l).offsetNode,o=e.offset)}catch(t){}if(!r&&c.caretRangeFromPoint){var h=c.caretRangeFromPoint(t.left,t.top);h&&(r=(n=h).startContainer,o=n.startOffset)}var f,d=c.elementFromPoint(t.left,t.top+1);if(!d||!view.dom.contains(1!=d.nodeType?d.parentNode:d)){var v=view.dom.getBoundingClientRect();if(!Zt(t,v))return null;if(!(d=function t(element,e,n){var r=element.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var c=element.childNodes[i];if(1==c.nodeType)for(var l=c.getClientRects(),h=0;h<l.length;h++){var rect=l[h];if(Zt(e,rect))return t(c,e,rect)}if((i=(i+1)%r)==o)break}return element}(view.dom,t,v)))return null}if(At.safari&&d.draggable&&(r=o=null),d=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(d,t),r){if(At.gecko&&1==r.nodeType&&(o=Math.min(o,r.childNodes.length))<r.childNodes.length){var m,y=r.childNodes[o];"IMG"==y.nodeName&&(m=y.getBoundingClientRect()).right<=t.left&&m.bottom>t.top&&o++}r==view.dom&&o==r.childNodes.length-1&&1==r.lastChild.nodeType&&t.top>r.lastChild.getBoundingClientRect().bottom?f=view.state.doc.content.size:0!=o&&1==r.nodeType&&"BR"==r.childNodes[o-1].nodeName||(f=function(view,t,e,n){for(var r=-1,o=t;o!=view.dom;){var desc=view.docView.nearestDesc(o,!0);if(!desc)return null;if(desc.node.isBlock&&desc.parent){var rect=desc.dom.getBoundingClientRect();if(rect.left>n.left||rect.top>n.top)r=desc.posBefore;else{if(!(rect.right<n.left||rect.bottom<n.top))break;r=desc.posAfter}}o=desc.dom.parentNode}return r>-1?r:view.docView.posFromDOM(t,e)}(view,r,o,t))}null==f&&(f=function(view,t,e){var n=Gt(t,e),r=n.node,o=n.offset,c=-1;if(1==r.nodeType&&!r.firstChild){var rect=r.getBoundingClientRect();c=rect.left!=rect.right&&e.left>(rect.left+rect.right)/2?1:-1}return view.docView.posFromDOM(r,o,c)}(view,d,t));var desc=view.docView.nearestDesc(d,!0);return{pos:f,inside:desc?desc.posAtStart-desc.border:-1}}function te(object,t){var e=object.getClientRects();return e.length?e[t<0?0:e.length-1]:object.getBoundingClientRect()}function ee(view,t){var e=view.docView.domFromPos(t),n=e.node,r=e.offset;if(3==n.nodeType&&(At.webkit||At.gecko)){var rect=te(It(n,r,r),0);if(At.gecko&&r&&/\s/.test(n.nodeValue[r-1])&&r<n.nodeValue.length){var o=te(It(n,r-1,r-1),-1);if(o.top==rect.top){var c=te(It(n,r,r+1),-1);if(c.top!=rect.top)return ne(c,c.left<o.left)}}return rect}if(1==n.nodeType&&!view.state.doc.resolve(t).parent.inlineContent){var l,h=!0;if(r<n.childNodes.length){var f=n.childNodes[r];1==f.nodeType&&(l=f.getBoundingClientRect())}if(!l&&r){var d=n.childNodes[r-1];1==d.nodeType&&(l=d.getBoundingClientRect(),h=!1)}return function(rect,t){if(0==rect.height)return rect;var e=t?rect.top:rect.bottom;return{top:e,bottom:e,left:rect.left,right:rect.right}}(l||n.getBoundingClientRect(),h)}for(var v=-1;v<2;v+=2)if(v<0&&r){var m=void 0,y=3==n.nodeType?It(n,r-1,r):3==(m=n.childNodes[r-1]).nodeType?It(m):1==m.nodeType&&"BR"!=m.nodeName?m:null;if(y){var w=te(y,1);if(w.top<w.bottom)return ne(w,!1)}}else if(v>0&&r<jt(n)){var x=void 0,C=3==n.nodeType?It(n,r,r+1):3==(x=n.childNodes[r]).nodeType?It(x):1==x.nodeType?x:null;if(C){var S=te(C,-1);if(S.top<S.bottom)return ne(S,!0)}}return ne(te(3==n.nodeType?It(n):n,0),!1)}function ne(rect,t){if(0==rect.width)return rect;var e=t?rect.left:rect.right;return{top:rect.top,bottom:rect.bottom,left:e,right:e}}function re(view,t,e){var n=view.state,r=view.root.activeElement;n!=t&&view.updateState(t),r!=view.dom&&view.focus();try{return e()}finally{n!=t&&view.updateState(n),r!=view.dom&&r&&r.focus()}}var oe=/[\u0590-\u08ac]/;var ie=null,se=null,ae=!1;function ce(view,t,e){return ie==t&&se==e?ae:(ie=t,se=e,ae="up"==e||"down"==e?function(view,t,e){var n=t.selection,r="up"==e?n.$anchor.min(n.$head):n.$anchor.max(n.$head);return re(view,t,(function(){for(var t=view.docView.domFromPos(r.pos).node;;){var n=view.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.dom;break}t=n.dom.parentNode}for(var o=ee(view,r.pos),c=t.firstChild;c;c=c.nextSibling){var l=void 0;if(1==c.nodeType)l=c.getClientRects();else{if(3!=c.nodeType)continue;l=It(c,0,c.nodeValue.length).getClientRects()}for(var i=0;i<l.length;i++){var h=l[i];if(h.bottom>h.top&&("up"==e?h.bottom<o.top+1:h.top>o.bottom-1))return!1}}return!0}))}(view,t,e):function(view,t,e){var n=t.selection.$head;if(!n.parent.isTextblock)return!1;var r=n.parentOffset,o=!r,c=r==n.parent.content.size,l=getSelection();return oe.test(n.parent.textContent)&&l.modify?re(view,t,(function(){var t=l.getRangeAt(0),r=l.focusNode,o=l.focusOffset,c=l.caretBidiLevel;l.modify("move",e,"character");var h=!(n.depth?view.docView.domAfterPos(n.before()):view.dom).contains(1==l.focusNode.nodeType?l.focusNode:l.focusNode.parentNode)||r==l.focusNode&&o==l.focusOffset;return l.removeAllRanges(),l.addRange(t),null!=c&&(l.caretBidiLevel=c),h})):"left"==e||"backward"==e?o:c}(view,t,e))}var ue=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},le={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0}};ue.prototype.matchesWidget=function(){return!1},ue.prototype.matchesMark=function(){return!1},ue.prototype.matchesNode=function(){return!1},ue.prototype.matchesHack=function(){return!1},le.beforePosition.get=function(){return!1},ue.prototype.parseRule=function(){return null},ue.prototype.stopEvent=function(){return!1},le.size.get=function(){for(var t=0,i=0;i<this.children.length;i++)t+=this.children[i].size;return t},le.border.get=function(){return 0},ue.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var i=0;i<this.children.length;i++)this.children[i].destroy()},ue.prototype.posBeforeChild=function(t){for(var i=0,e=this.posAtStart;i<this.children.length;i++){var n=this.children[i];if(n==t)return e;e+=n.size}},le.posBefore.get=function(){return this.parent.posBeforeChild(this)},le.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},le.posAfter.get=function(){return this.posBefore+this.size},le.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},ue.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,desc;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(desc=r.pmViewDesc)||desc.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(desc)+desc.size:this.posAtStart}var o,c;if(t==this.contentDOM)o=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&(!(c=o.pmViewDesc)||c.parent!=this);)o=o.nextSibling;return o?this.posBeforeChild(c):this.posAtEnd}var l;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))l=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var h=t;;h=h.parentNode){if(h==this.dom){l=!1;break}if(h.parentNode.firstChild!=h)break}if(null==l&&e==t.childNodes.length)for(var f=t;;f=f.parentNode){if(f==this.dom){l=!0;break}if(f.parentNode.lastChild!=f)break}}return(null==l?n>0:l)?this.posAtEnd:this.posAtStart},ue.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var desc=this.getDesc(r);if(desc&&(!e||desc.node)){if(!n||!desc.nodeDOM||(1==desc.nodeDOM.nodeType?desc.nodeDOM.contains(1==t.nodeType?t:t.parentNode):desc.nodeDOM==t))return desc;n=!1}}},ue.prototype.getDesc=function(t){for(var desc=t.pmViewDesc,e=desc;e;e=e.parent)if(e==this)return desc},ue.prototype.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var desc=this.getDesc(r);if(desc)return desc.localPosFromDOM(t,e,n)}return-1},ue.prototype.descAt=function(t){for(var i=0,e=0;i<this.children.length;i++){var n=this.children[i],r=e+n.size;if(e==t&&r!=e){for(;!n.border&&n.children.length;)n=n.children[0];return n}if(t<r)return n.descAt(t-e-n.border);e=r}},ue.prototype.domFromPos=function(t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var e=0,i=0;;i++){if(e==t){for(;i<this.children.length&&(this.children[i].beforePosition||this.children[i].dom.parentNode!=this.contentDOM);)i++;return{node:this.contentDOM,offset:i==this.children.length?this.contentDOM.childNodes.length:Bt(this.children[i].dom)}}if(i==this.children.length)throw new Error("Invalid position "+t);var n=this.children[i],r=e+n.size;if(t<r)return n.domFromPos(t-e-n.border);e=r}},ue.prototype.parseRange=function(t,e,base){if(void 0===base&&(base=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var n=-1,r=-1,o=base,i=0;;i++){var c=this.children[i],l=o+c.size;if(-1==n&&t<=l){var h=o+c.border;if(t>=h&&e<=l-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,e,h);t=o;for(var f=i;f>0;f--){var d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){n=Bt(d.dom)+1;break}t-=d.size}-1==n&&(n=0)}if(n>-1&&(l>e||i==this.children.length-1)){e=l;for(var v=i+1;v<this.children.length;v++){var m=this.children[v];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(-1)){r=Bt(m.dom);break}e+=m.size}-1==r&&(r=this.contentDOM.childNodes.length);break}o=l}return{node:this.contentDOM,from:t,to:e,fromOffset:n,toOffset:r}},ue.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},ue.prototype.domAfterPos=function(t){var e=this.domFromPos(t),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},ue.prototype.setSelection=function(t,head,e,n){for(var r=Math.min(t,head),o=Math.max(t,head),i=0,c=0;i<this.children.length;i++){var l=this.children[i],h=c+l.size;if(r>c&&o<h)return l.setSelection(t-c-l.border,head-c-l.border,e,n);c=h}var f=this.domFromPos(t),d=this.domFromPos(head),v=e.getSelection();if(n||!_t(f.node,f.offset,v.anchorNode,v.anchorOffset)||!_t(d.node,d.offset,v.focusNode,v.focusOffset)){var m=!1;if(v.extend||t==head){v.collapse(f.node,f.offset);try{t!=head&&v.extend(d.node,d.offset),m=!0}catch(t){if(!(t instanceof DOMException))throw t}}if(!m){if(t>head){var y=f;f=d,d=y}var w=document.createRange();w.setEnd(d.node,d.offset),w.setStart(f.node,f.offset),v.removeAllRanges(),v.addRange(w)}}},ue.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},le.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},ue.prototype.markDirty=function(t,e){for(var n=0,i=0;i<this.children.length;i++){var r=this.children[i],o=n+r.size;if(n==o?t<=o&&e>=n:t<o&&e>n){var c=n+r.border,l=o-r.border;if(t>=c&&e<=l)return this.dirty=t==n||e==o?2:1,void(t!=c||e!=l||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-c,e-c):r.dirty=3);r.dirty=3}n=o}this.dirty=2},ue.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},Object.defineProperties(ue.prototype,le);var he=[],fe=function(t){function e(e,n,view,r){var o,c=n.type.toDOM;if("function"==typeof c&&(c=c(view,(function(){return o?o.parent?o.parent.posBeforeChild(o):void 0:r}))),!n.type.spec.raw){if(1!=c.nodeType){var l=document.createElement("span");l.appendChild(c),c=l}c.contentEditable=!1,c.classList.add("ProseMirror-widget")}t.call(this,e,he,c,null),this.widget=n,o=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},Object.defineProperties(e.prototype,n),e}(ue),pe=function(t){function e(e,n,r,text){t.call(this,e,he,n,null),this.textDOM=r,this.text=text}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(ue),de=function(t){function e(e,mark,n,r){t.call(this,e,[],n,r),this.mark=mark}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,mark,n,view){var r=view.nodeViews[mark.type.name],o=r&&r(mark,view,n);return o&&o.dom||(o=St.renderSpec(document,mark.type.spec.toDOM(mark,n))),new e(t,mark,o.dom,o.contentDOM||o.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(mark){return 3!=this.dirty&&this.mark.eq(mark)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,view){var r=e.create(this.parent,this.mark,!0,view),o=this.children,c=this.size;n<c&&(o=Te(o,n,c,view)),t>0&&(o=Te(o,0,t,view));for(var i=0;i<o.length;i++)o[i].parent=r;return r.children=o,r},e}(ue),ve=function(t){function e(e,n,r,o,c,l,h,view,f){t.call(this,e,n.isLeaf?he:[],c,l),this.nodeDOM=h,this.node=n,this.outerDeco=r,this.innerDeco=o,l&&this.updateChildren(view,f)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0}};return e.create=function(t,n,r,o,view,c){var l,h,f=view.nodeViews[n.type.name],d=f&&f(n,view,(function(){return h?h.parent?h.parent.posBeforeChild(h):void 0:c}),r),v=d&&d.dom,m=d&&d.contentDOM;if(n.isText)if(v){if(3!=v.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else v=document.createTextNode(n.text);else v||(v=(l=St.renderSpec(document,n.type.spec.toDOM(n))).dom,m=l.contentDOM);m||n.isText||"BR"==v.nodeName||(v.hasAttribute("contenteditable")||(v.contentEditable=!1),n.type.spec.draggable&&(v.draggable=!0));var y=v;return v=Oe(v,r,n),d?h=new be(t,n,r,o,v,m,y,d,view,c+1):n.isText?new ge(t,n,r,o,v,y,view):new e(t,n,r,o,v,m,y,view,c+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?c.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Me(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(view,t){var e=this,n=this.node.inlineContent,r=t,o=n&&view.composing&&this.localCompositionNode(view,t),c=new Ae(this,o&&o.node);!function(t,e,n,r){var o=e.locals(t),c=0;if(0==o.length){for(var i=0;i<t.childCount;i++){var l=t.child(i);r(l,o,e.forChild(c,l),i),c+=l.nodeSize}return}for(var h=0,f=[],d=null,v=0;;){if(h<o.length&&o[h].to==c){for(var m=o[h++],y=void 0;h<o.length&&o[h].to==c;)(y||(y=[m])).push(o[h++]);if(y){y.sort(Ee);for(var w=0;w<y.length;w++)n(y[w],v,!!d)}else n(m,v,!!d)}var x=void 0,C=void 0;if(d)C=-1,x=d,d=null;else{if(!(v<t.childCount))break;C=v,x=t.child(v++)}for(var S=0;S<f.length;S++)f[S].to<=c&&f.splice(S--,1);for(;h<o.length&&o[h].from<=c&&o[h].to>c;)f.push(o[h++]);var k=c+x.nodeSize;if(x.isText){var O=k;h<o.length&&o[h].from<O&&(O=o[h].from);for(var M=0;M<f.length;M++)f[M].to<O&&(O=f[M].to);O<k&&(d=x.cut(O-c),x=x.cut(0,O-c),k=O,C=-1)}r(x,f.length?f.slice():he,e.forChild(c,x),C),c=k}}(this.node,this.innerDeco,(function(t,i,o){t.spec.marks?c.syncToMarks(t.spec.marks,n,view):t.type.side>=0&&!o&&c.syncToMarks(i==e.node.childCount?v.none:e.node.child(i).marks,n,view),c.placeWidget(t,view,r)}),(function(t,e,o,i){c.syncToMarks(t.marks,n,view),c.findNodeMatch(t,e,o,i)||c.updateNextNode(t,e,o,view,i)||c.addNode(t,e,o,view,r),r+=t.nodeSize})),c.syncToMarks(he,n,view),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||2==this.dirty)&&(o&&this.protectLocalComposition(view,o),this.renderChildren())},e.prototype.renderChildren=function(){!function t(e,n){for(var r=e.firstChild,i=0;i<n.length;i++){var desc=n[i],o=desc.dom;if(o.parentNode==e){for(;o!=r;)r=Ne(r);r=r.nextSibling}else e.insertBefore(o,r);if(desc instanceof de){var c=r?r.previousSibling:e.lastChild;t(desc.contentDOM,desc.children),r=c?c.nextSibling:e.firstChild}}for(;r;)r=Ne(r)}(this.contentDOM,this.children),At.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom)},e.prototype.localCompositionNode=function(view,t){var e=view.state.selection,n=e.from,o=e.to;if(!(!(view.state.selection instanceof r.TextSelection)||n<t||o>t+this.node.content.size)){var c=view.root.getSelection(),l=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=jt(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(c.focusNode,c.focusOffset);if(l&&this.dom.contains(l.parentNode)){var text=l.nodeValue,h=function(t,text,e,n){for(var i=0,r=0;i<t.childCount&&r<=n;){var o=t.child(i++),c=r;if(r+=o.nodeSize,o.isText){for(var l=o.text;i<t.childCount;){var h=t.child(i++);if(r+=h.nodeSize,!h.isText)break;l+=h.text}if(r>=e){var f=l.lastIndexOf(text,n-c);if(f>=0&&f+text.length+c>=e)return c+f}}}return-1}(this.node.content,text,n-t,o-t);return h<0?null:{node:l,pos:h,text:text}}}},e.prototype.protectLocalComposition=function(view,t){var e=t.node,n=t.pos,text=t.text;if(!this.getDesc(e)){for(var r=e;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=null)}var desc=new pe(this,r,e,text);view.compositionNodes.push(desc),this.children=Te(this.children,n,n+text.length,view,desc)}},e.prototype.update=function(t,e,n,view){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,view),!0)},e.prototype.updateInner=function(t,e,n,view){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(view,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!Me(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Se(this.dom,this.nodeDOM,Ce(this.outerDeco,this.node,e),Ce(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},Object.defineProperties(e.prototype,n),e}(ue);function me(t,e,n,r,view){return Oe(r,e,t),new ve(null,t,e,n,r,r,r,view,0)}var ge=function(t){function e(e,n,r,o,c,l,view){t.call(this,e,n,r,o,c,null,l,view)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){for(var t=this.nodeDOM.parentNode;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}},e.prototype.update=function(t,e){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,view){var r=this.node.cut(t,n),o=document.createTextNode(r.text);return new e(this.parent,r,this.outerDeco,this.innerDeco,o,o,view)},e}(ve),ye=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},e}(ue),be=function(t){function e(e,n,r,o,c,l,h,f,view,d){t.call(this,e,n,r,o,c,l,h,view,d),this.spec=f}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,view){if(3==this.dirty)return!1;if(this.spec.update){var o=this.spec.update(e,n);return o&&this.updateInner(e,n,r,view),o}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,view)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,head,n,r){this.spec.setSelection?this.spec.setSelection(e,head,n):t.prototype.setSelection.call(this,e,head,n,r)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(ve);function we(t){t&&(this.nodeName=t)}we.prototype=Object.create(null);var xe=[new we];function Ce(t,e,n){if(0==t.length)return xe;for(var r=n?xe[0]:new we,o=[r],i=0;i<t.length;i++){var c=t[i].type.attrs,l=r;if(c)for(var h in c.nodeName&&o.push(l=new we(c.nodeName)),c){var f=c[h];null!=f&&(n&&1==o.length&&o.push(l=r=new we(e.isInline?"span":"div")),"class"==h?l.class=(l.class?l.class+" ":"")+f:"style"==h?l.style=(l.style?l.style+";":"")+f:"nodeName"!=h&&(l[h]=f))}}return o}function Se(t,e,n,r){if(n==xe&&r==xe)return e;for(var o=e,i=0;i<r.length;i++){var c=r[i],l=n[i];if(i){var h=void 0;l&&l.nodeName==c.nodeName&&o!=t&&(h=o.parentNode)&&h.tagName.toLowerCase()==c.nodeName?o=h:((h=document.createElement(c.nodeName)).pmIsDeco=!0,h.appendChild(o),l=xe[0],o=h)}ke(o,l||xe[0],c)}return o}function ke(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var c=e.class?e.class.split(" "):he,l=n.class?n.class.split(" "):he,i=0;i<c.length;i++)-1==l.indexOf(c[i])&&t.classList.remove(c[i]);for(var h=0;h<l.length;h++)-1==c.indexOf(l[h])&&t.classList.add(l[h])}if(e.style!=n.style){if(e.style)for(var f,d=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;f=d.exec(e.style);)t.style.removeProperty(f[1]);n.style&&(t.style.cssText+=n.style)}}function Oe(t,e,n){return Se(t,t,xe,Ce(e,n,1!=t.nodeType))}function Me(a,b){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].type.eq(b[i].type))return!1;return!0}function Ne(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var Ae=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var pre=function(t,e){for(var n=[],r=t.childCount,i=e.length-1;r>0&&i>=0;i--){var desc=e[i],o=desc.node;if(o){if(o!=t.child(r-1))break;n.push(desc),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=pre.nodes,this.preMatchOffset=pre.offset};function Ee(a,b){return a.type.side-b.type.side}function Te(t,e,n,view,r){for(var o=[],i=0,c=0;i<t.length;i++){var l=t[i],h=c,f=c+=l.size;h>=n||f<=e?o.push(l):(h<e&&o.push(l.slice(0,e-h,view)),r&&(o.push(r),r=null),f>n&&o.push(l.slice(n-h,l.size,view)))}return o}function De(t,e){var n=t.selection,o=n.$anchor,c=n.$head,l=e>0?o.max(c):o.min(c),h=l.parent.inlineContent?l.depth?t.doc.resolve(e>0?l.after():l.before()):null:l;return h&&r.Selection.findFrom(h,e)}function Re(view,t){return view.dispatch(view.state.tr.setSelection(t).scrollIntoView()),!0}function Pe(view,t,e){var n=view.state.selection;if(!(n instanceof r.TextSelection)){if(n instanceof r.NodeSelection&&n.node.isInline)return Re(view,new r.TextSelection(t>0?n.$to:n.$from));var o=De(view.state,t);return!!o&&Re(view,o)}if(!n.empty||e.indexOf("s")>-1)return!1;if(view.endOfTextblock(t>0?"right":"left")){var c=De(view.state,t);return!!(c&&c instanceof r.NodeSelection)&&Re(view,c)}if(!(At.mac&&e.indexOf("m")>-1)){var desc,l=n.$head,h=l.textOffset?null:t<0?l.nodeBefore:l.nodeAfter;if(!h||h.isText)return!1;var f=t<0?l.pos-h.nodeSize:l.pos;return!!(h.isAtom||(desc=view.docView.descAt(f))&&!desc.contentDOM)&&(r.NodeSelection.isSelectable(h)?Re(view,new r.NodeSelection(t<0?view.state.doc.resolve(l.pos-h.nodeSize):l)):!!At.webkit&&Re(view,new r.TextSelection(view.state.doc.resolve(t<0?f:f+h.nodeSize))))}}function Be(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Fe(t){var desc=t.pmViewDesc;return desc&&0==desc.size&&(t.nextSibling||"BR"!=t.nodeName)}function Ie(view){var t=view.root.getSelection(),e=t.focusNode,n=t.focusOffset;if(e){var r,o,c=!1;for(At.gecko&&1==e.nodeType&&n<Be(e)&&Fe(e.childNodes[n])&&(c=!0);;)if(n>0){if(1!=e.nodeType)break;var l=e.childNodes[n-1];if(Fe(l))r=e,o=--n;else{if(3!=l.nodeType)break;n=(e=l).nodeValue.length}}else{if(ze(e))break;for(var h=e.previousSibling;h&&Fe(h);)r=e.parentNode,o=Bt(h),h=h.previousSibling;if(h)n=Be(e=h);else{if((e=e.parentNode)==view.dom)break;n=0}}c?Le(view,t,e,n):r&&Le(view,t,r,o)}}function _e(view){var t=view.root.getSelection(),e=t.focusNode,n=t.focusOffset;if(e){for(var r,o,c=Be(e);;)if(n<c){if(1!=e.nodeType)break;if(!Fe(e.childNodes[n]))break;r=e,o=++n}else{if(ze(e))break;for(var l=e.nextSibling;l&&Fe(l);)r=l.parentNode,o=Bt(l)+1,l=l.nextSibling;if(l)n=0,c=Be(e=l);else{if((e=e.parentNode)==view.dom)break;n=c=0}}r&&Le(view,t,r,o)}}function ze(t){var desc=t.pmViewDesc;return desc&&desc.node&&desc.node.isBlock}function Le(view,t,e,n){if($t(t)){var r=document.createRange();r.setEnd(e,n),r.setStart(e,n),t.removeAllRanges(),t.addRange(r)}else t.extend&&t.extend(e,n);view.domObserver.setCurSelection()}function je(view,t,e){var n=view.state.selection;if(n instanceof r.TextSelection&&!n.empty||e.indexOf("s")>-1)return!1;if(At.mac&&e.indexOf("m")>-1)return!1;var o=n.$from,c=n.$to;if(!o.parent.inlineContent||view.endOfTextblock(t<0?"up":"down")){var l=De(view.state,t);if(l&&l instanceof r.NodeSelection)return Re(view,l)}if(!o.parent.inlineContent){var h=r.Selection.findFrom(t<0?o:c,t);return!h||Re(view,h)}return!1}function Ve(view,t){if(!(view.state.selection instanceof r.TextSelection))return!0;var e=view.state.selection,n=e.$head,o=e.$anchor,c=e.empty;if(!n.sameParent(o))return!0;if(!c)return!1;if(view.endOfTextblock(t>0?"forward":"backward"))return!0;var l=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(l&&!l.isText){var tr=view.state.tr;return t<0?tr.delete(n.pos-l.nodeSize,n.pos):tr.delete(n.pos,n.pos+l.nodeSize),view.dispatch(tr),!0}return!1}function $e(view,t,e){view.domObserver.stop(),t.contentEditable=e,view.domObserver.start()}function qe(view,t){var code=t.keyCode,e=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(t);return 8==code||At.mac&&72==code&&"c"==e?Ve(view,-1)||Ie(view):46==code||At.mac&&68==code&&"c"==e?Ve(view,1)||_e(view):13==code||27==code||(37==code?Pe(view,-1,e)||Ie(view):39==code?Pe(view,1,e)||_e(view):38==code?je(view,-1,e)||Ie(view):40==code?function(view){if(At.chrome&&!(view.state.selection.$head.parentOffset>0)){var t=view.root.getSelection(),e=t.focusNode,n=t.focusOffset;if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){var r=e.firstChild;$e(view,r,!0),setTimeout((function(){return $e(view,r,!1)}),20)}}}(view)||je(view,1,e)||_e(view):e==(At.mac?"m":"c")&&(66==code||73==code||89==code||90==code))}function Ue(view,t){var e=view.root.getSelection(),n=view.state.doc;if(!e.focusNode)return null;var o=view.docView.nearestDesc(e.focusNode),c=o&&0==o.size,head=view.docView.posFromDOM(e.focusNode,e.focusOffset);if(head<0)return null;var l,h,f=n.resolve(head);if($t(e)){for(l=f;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&r.NodeSelection.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(t,e,n){for(var r=0==e,o=e==jt(t);r||o;){if(t==n)return!0;var c=Bt(t);if(!(t=t.parentNode))return!1;r=r&&0==c,o=o&&c==jt(t)}}(e.focusNode,e.focusOffset,o.dom))){var d=o.posBefore;h=new r.NodeSelection(head==d?f:n.resolve(d))}}else{var v=view.docView.posFromDOM(e.anchorNode,e.anchorOffset);if(v<0)return null;l=n.resolve(v)}h||(h=Ze(view,l,f,"pointer"==t||view.state.selection.head<f.pos&&!c?1:-1));return h}function We(view,t){var e=view.state.selection;if(Xe(view,e),view.editable?view.hasFocus():Qe(view)&&document.activeElement&&document.activeElement.contains(view.dom)){if(view.domObserver.disconnectSelection(),view.cursorWrapper)!function(view){var t=view.root.getSelection(),e=document.createRange(),n=view.cursorWrapper.dom,img="IMG"==n.nodeName;img?e.setEnd(n.parentNode,Bt(n)+1):e.setEnd(n,0);e.collapse(!1),t.removeAllRanges(),t.addRange(e),!img&&!view.state.selection.visible&&At.ie&&At.ie_version<=11&&(n.disabled=!0,n.disabled=!1)}(view);else{var n,o,c=e.anchor,head=e.head;!Je||e instanceof r.TextSelection||(e.$from.parent.inlineContent||(n=He(view,e.from)),e.empty||e.$from.parent.inlineContent||(o=He(view,e.to))),view.docView.setSelection(c,head,view.root,t),Je&&(n&&Ye(n),o&&Ye(o)),e.visible?view.dom.classList.remove("ProseMirror-hideselection"):(view.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(view){var t=view.dom.ownerDocument;t.removeEventListener("selectionchange",view.hideSelectionGuard);var e=view.root.getSelection(),n=e.anchorNode,r=e.anchorOffset;t.addEventListener("selectionchange",view.hideSelectionGuard=function(){e.anchorNode==n&&e.anchorOffset==r||(t.removeEventListener("selectionchange",view.hideSelectionGuard),view.dom.classList.remove("ProseMirror-hideselection"))})}(view))}view.domObserver.setCurSelection(),view.domObserver.connectSelection()}}Ae.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},Ae.prototype.destroyBetween=function(t,e){if(t!=e){for(var i=t;i<e;i++)this.top.children[i].destroy();this.top.children.splice(t,e-t),this.changed=!0}},Ae.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Ae.prototype.syncToMarks=function(t,e,view){for(var n=0,r=this.stack.length>>1,o=Math.min(r,t.length);n<o&&(n==r-1?this.top:this.stack[n+1<<1]).matchesMark(t[n])&&!1!==t[n].type.spec.spanning;)n++;for(;n<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);for(var c=-1,i=this.index;i<Math.min(this.index+3,this.top.children.length);i++)if(this.top.children[i].matchesMark(t[r])){c=i;break}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{var l=de.create(this.top,t[r],e,view);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,r++}},Ae.prototype.findNodeMatch=function(t,e,n,r){var o=-1,c=r<0?void 0:this.getPreMatch(r),l=this.top.children;if(c&&c.matchesNode(t,e,n))o=l.indexOf(c);else for(var i=this.index,h=Math.min(l.length,i+5);i<h;i++){var f=l[i];if(f.matchesNode(t,e,n)&&this.preMatched.indexOf(f)<0){o=i;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},Ae.prototype.updateNextNode=function(t,e,n,view,r){for(var i=this.index;i<this.top.children.length;i++){var o=this.top.children[i];if(o instanceof ve){var c=this.preMatched.indexOf(o);if(c>-1&&c+this.preMatchOffset!=r)return!1;var l=o.dom;if(!(this.lock&&(l==this.lock||1==l.nodeType&&l.contains(this.lock.parentNode))&&!(t.isText&&o.node&&o.node.isText&&o.nodeDOM.nodeValue==t.text&&3!=o.dirty&&Me(e,o.outerDeco)))&&o.update(t,e,n,view))return this.destroyBetween(this.index,i),o.dom!=l&&(this.changed=!0),this.index++,!0;break}}return!1},Ae.prototype.addNode=function(t,e,n,view,r){this.top.children.splice(this.index++,0,ve.create(this.top,t,e,n,view,r)),this.changed=!0},Ae.prototype.placeWidget=function(t,view,e){var n=this.index<this.top.children.length?this.top.children[this.index]:null;if(!n||!n.matchesWidget(t)||t!=n.widget&&n.widget.type.toDOM.parentNode){var desc=new fe(this.top,t,view,e);this.top.children.splice(this.index++,0,desc),this.changed=!0}else this.index++},Ae.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof de;)t=t.children[t.children.length-1];if(!t||!(t instanceof ge)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new ye(this.top,he,e,null)),this.changed=!0}};var Je=At.safari||At.chrome&&At.chrome_version<63;function He(view,t){var e=view.docView.domFromPos(t),n=e.node,r=e.offset,o=r<n.childNodes.length?n.childNodes[r]:null,c=r?n.childNodes[r-1]:null;if(At.safari&&o&&"false"==o.contentEditable)return Ke(o);if(!(o&&"false"!=o.contentEditable||c&&"false"!=c.contentEditable)){if(o)return Ke(o);if(c)return Ke(c)}}function Ke(element){return element.contentEditable="true",At.safari&&element.draggable&&(element.draggable=!1,element.wasDraggable=!0),element}function Ye(element){element.contentEditable="false",element.wasDraggable&&(element.draggable=!0,element.wasDraggable=null)}function Xe(view,t){if(t instanceof r.NodeSelection){var desc=view.docView.descAt(t.from);desc!=view.lastSelectedViewDesc&&(Ge(view),desc&&desc.selectNode(),view.lastSelectedViewDesc=desc)}else Ge(view)}function Ge(view){view.lastSelectedViewDesc&&(view.lastSelectedViewDesc.parent&&view.lastSelectedViewDesc.deselectNode(),view.lastSelectedViewDesc=null)}function Ze(view,t,e,n){return view.someProp("createSelectionBetween",(function(n){return n(view,t,e)}))||r.TextSelection.between(t,e,n)}function Qe(view){var t=view.root.getSelection();if(!t.anchorNode)return!1;try{return view.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(view.editable||view.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(t){return!1}}function tn(t){var desc=t.pmViewDesc;if(desc)return desc.parseRule();if("BR"==t.nodeName&&t.parentNode){if(At.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(t.parentNode.lastChild==t||At.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function en(view,t,e,n,o){if(t<0){var l=view.lastSelectionTime>Date.now()-50?view.lastSelectionOrigin:null,h=Ue(view,l);if(h&&!view.state.selection.eq(h)){var f=view.state.tr.setSelection(h);"pointer"==l?f.setMeta("pointer",!0):"key"==l&&f.scrollIntoView(),view.dispatch(f)}}else{var d=view.state.doc.resolve(t),v=d.sharedDepth(e);t=d.before(v+1),e=view.state.doc.resolve(e).after(v+1);var m,y,w=view.state.selection,x=function(view,t,e){var n=view.docView.parseRange(t,e),r=n.node,o=n.fromOffset,c=n.toOffset,l=n.from,h=n.to,f=view.root.getSelection(),d=null,v=f.anchorNode;if(v&&view.dom.contains(1==v.nodeType?v:v.parentNode)&&(d=[{node:v,offset:f.anchorOffset}],$t(f)||d.push({node:f.focusNode,offset:f.focusOffset})),At.chrome&&8===view.lastKeyCode)for(var m=c;m>o;m--){var y=r.childNodes[m-1],desc=y.pmViewDesc;if("BR"==y.nodeType&&!desc){c=m;break}if(!desc||desc.size)break}var w=view.state.doc,x=view.someProp("domParser")||ut.fromSchema(view.state.schema),C=w.resolve(l),S=null,k=x.parse(r,{topNode:C.parent,topMatch:C.parent.contentMatchAt(C.index()),topOpen:!0,from:o,to:c,preserveWhitespace:!C.parent.type.spec.code||"full",editableContent:!0,findPositions:d,ruleFromNode:tn,context:C});if(d&&null!=d[0].pos){var O=d[0].pos,head=d[1]&&d[1].pos;null==head&&(head=O),S={anchor:O+l,head:head+l}}return{doc:k,sel:S,from:l,to:h}}(view,t,e),C=view.state.doc,S=C.slice(x.from,x.to);8===view.lastKeyCode&&Date.now()-100<view.lastKeyCodeTime?(m=view.state.selection.to,y="end"):(m=view.state.selection.from,y="start"),view.lastKeyCode=null;var k=function(a,b,t,e,n){var r=a.findDiffStart(b,t);if(null==r)return null;var o=a.findDiffEnd(b,t+a.size,t+b.size),c=o.a,l=o.b;if("end"==n){var h=Math.max(0,r-Math.min(c,l));e-=c+h-r}if(c<r&&a.size<b.size){l=(r-=e<=r&&e>=c?r-e:0)+(l-c),c=r}else if(l<r){c=(r-=e<=r&&e>=l?r-e:0)+(c-l),l=r}return{start:r,endA:c,endB:l}}(S.content,x.doc.content,x.from,m,y);if(!k){if(!(n&&w instanceof r.TextSelection&&!w.empty&&w.$head.sameParent(w.$anchor))||view.composing||x.sel&&x.sel.anchor!=x.sel.head){if(x.sel){var O=nn(view,view.state.doc,x.sel);O&&!O.eq(view.state.selection)&&view.dispatch(view.state.tr.setSelection(O))}return}k={start:w.from,endA:w.to,endB:w.to}}view.domChangeCount++,view.state.selection.from<view.state.selection.to&&k.start==k.endB&&view.state.selection instanceof r.TextSelection&&(k.start>view.state.selection.from&&k.start<=view.state.selection.from+2?k.start=view.state.selection.from:k.endA<view.state.selection.to&&k.endA>=view.state.selection.to-2&&(k.endB+=view.state.selection.to-k.endA,k.endA=view.state.selection.to)),At.ie&&At.ie_version<=11&&k.endB==k.start+1&&k.endA==k.start&&k.start>x.from&&"  "==x.doc.textBetween(k.start-x.from-1,k.start-x.from+1)&&(k.start--,k.endA--,k.endB--);var M,N=x.doc.resolveNoCache(k.start-x.from),A=x.doc.resolveNoCache(k.endB-x.from),E=N.sameParent(A)&&N.parent.inlineContent;if((At.ios&&view.lastIOSEnter>Date.now()-225&&(!E||o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName})))||!E&&N.pos<x.doc.content.size&&(M=r.Selection.findFrom(x.doc.resolve(N.pos+1),1,!0))&&M.head==A.pos)&&view.someProp("handleKeyDown",(function(t){return t(view,qt(13,"Enter"))})))view.lastIOSEnter=0;else if(view.state.selection.anchor>k.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||rn(r,!0,!1)<o.pos)return!1;var c=t.resolve(e);if(c.parentOffset<c.parent.content.size||!c.parent.isTextblock)return!1;var l=t.resolve(rn(c,!0,!0));if(!l.parent.isTextblock||l.pos>n||rn(l,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(l.parent.content)}(C,k.start,k.endA,N,A)&&view.someProp("handleKeyDown",(function(t){return t(view,qt(8,"Backspace"))})))At.android&&At.chrome&&view.domObserver.suppressSelectionUpdates();else{At.android&&!E&&N.start()!=A.start()&&0==A.parentOffset&&N.depth==A.depth&&x.sel&&x.sel.anchor==x.sel.head&&x.sel.head==k.endA&&(k.endB-=2,A=x.doc.resolveNoCache(k.endB-x.from),setTimeout((function(){view.someProp("handleKeyDown",(function(t){return t(view,qt(13,"Enter"))}))}),20));var tr,T,D,R,P=k.start,B=k.endA;if(E)if(N.pos==A.pos)At.ie&&At.ie_version<=11&&0==N.parentOffset&&(view.domObserver.suppressSelectionUpdates(),setTimeout((function(){return We(view)}),20)),tr=view.state.tr.delete(P,B),T=C.resolve(k.start).marksAcross(C.resolve(k.endA));else if(k.endA==k.endB&&(R=C.resolve(k.start))&&(D=function(t,e){for(var n,mark,r,o=t.firstChild.marks,l=e.firstChild.marks,h=o,f=l,i=0;i<l.length;i++)h=l[i].removeFromSet(h);for(var d=0;d<o.length;d++)f=o[d].removeFromSet(f);if(1==h.length&&0==f.length)mark=h[0],n="add",r=function(t){return t.mark(mark.addToSet(t.marks))};else{if(0!=h.length||1!=f.length)return null;mark=f[0],n="remove",r=function(t){return t.mark(mark.removeFromSet(t.marks))}}for(var v=[],m=0;m<e.childCount;m++)v.push(r(e.child(m)));if(c.from(v).eq(t))return{mark:mark,type:n}}(N.parent.content.cut(N.parentOffset,A.parentOffset),R.parent.content.cut(R.parentOffset,k.endA-R.start()))))tr=view.state.tr,"add"==D.type?tr.addMark(P,B,D.mark):tr.removeMark(P,B,D.mark);else if(N.parent.child(N.index()).isText&&N.index()==A.index()-(A.textOffset?0:1)){var text=N.parent.textBetween(N.parentOffset,A.parentOffset);if(view.someProp("handleTextInput",(function(t){return t(view,P,B,text)})))return;tr=view.state.tr.insertText(text,P,B)}if(tr||(tr=view.state.tr.replace(P,B,x.doc.slice(k.start-x.from,k.endB-x.from))),x.sel){var F=nn(view,tr.doc,x.sel);F&&!(At.chrome&&At.android&&view.composing&&F.empty&&(F.head==P||F.head==tr.mapping.map(B)-1)||At.ie&&F.empty&&F.head==P)&&tr.setSelection(F)}T&&tr.ensureMarks(T),view.dispatch(tr.scrollIntoView())}}}function nn(view,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:Ze(view,t.resolve(e.anchor),t.resolve(e.head))}function rn(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var c=t.node(r).maybeChild(t.indexAfter(r));c&&!c.isLeaf;)c=c.firstChild,o++;return o}function on(view,t){for(var e=[],content=t.content,n=t.openStart,r=t.openEnd;n>1&&r>1&&1==content.childCount&&1==content.firstChild.childCount;){n--,r--;var o=content.firstChild;e.push(o.type.name,o.type.hasRequiredAttrs()?o.attrs:null),content=o.content}var c=view.someProp("clipboardSerializer")||St.fromSchema(view.state.schema),l=hn(),h=l.createElement("div");h.appendChild(c.serializeFragment(content,{document:l}));for(var f,d=h.firstChild;d&&1==d.nodeType&&(f=un[d.nodeName.toLowerCase()]);){for(var i=f.length-1;i>=0;i--){for(var v=l.createElement(f[i]);h.firstChild;)v.appendChild(h.firstChild);h.appendChild(v)}d=h.firstChild}return d&&1==d.nodeType&&d.setAttribute("data-pm-slice",n+" "+r+" "+JSON.stringify(e)),{dom:h,text:view.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function sn(view,text,html,t,e){var n,r,o=e.parent.type.spec.code;if(!html&&!text)return null;var l=text&&(t||o||!html);if(l){if(view.someProp("transformPastedText",(function(e){text=e(text,o||t)})),o)return new y(c.from(view.state.schema.text(text)),0,0);var h=view.someProp("clipboardTextParser",(function(n){return n(text,e,t)}));h?r=h:(n=document.createElement("div"),text.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){n.appendChild(document.createElement("p")).textContent=t})))}else view.someProp("transformPastedHTML",(function(t){html=t(html)})),n=function(html){var t=/(\s*<meta [^>]*>)*/.exec(html);t&&(html=html.slice(t[0].length));var e,n=hn().createElement("div"),r=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(html),o=0;(e=r&&un[r[1].toLowerCase()])&&(html=e.map((function(t){return"<"+t+">"})).join("")+html+e.map((function(t){return"</"+t+">"})).reverse().join(""),o=e.length);n.innerHTML=html;for(var i=0;i<o;i++)n=n.firstChild;return n}(html);var f=n&&n.querySelector("[data-pm-slice]"),d=f&&/^(\d+) (\d+) (.*)/.exec(f.getAttribute("data-pm-slice"));if(!r){var v=view.someProp("clipboardParser")||view.someProp("domParser")||ut.fromSchema(view.state.schema);r=v.parseSlice(n,{preserveWhitespace:!(!l&&!d),context:e})}return r=d?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var content=t.content,o=t.openStart,l=t.openEnd,i=n.length-2;i>=0;i-=2){var h=r.nodes[n[i]];if(!h||h.hasRequiredAttrs())break;content=c.from(h.create(n[i+1],content)),o++,l++}return new y(content,o,l)}(function(t,e,n){e<t.openStart&&(t=new y(cn(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new y(cn(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(r,+d[1],+d[2]),d[3]):y.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,l=[];if(t.forEach((function(t){if(l){var e,n=r.findWrapping(t.type);if(!n)return l=null;if(e=l.length&&o.length&&function t(e,n,r,o,l){if(l<e.length&&l<n.length&&e[l]==n[l]){var h=t(e,n,r,o.lastChild,l+1);if(h)return o.copy(o.content.replaceChild(o.childCount-1,h));if(o.contentMatchAt(o.childCount).matchType(l==e.length-1?r.type:e[l+1]))return o.copy(o.content.append(c.from(an(r,e,l+1))))}}(n,o,t,l[l.length-1],0))l[l.length-1]=e;else{l.length&&(l[l.length-1]=function t(e,n){if(0==n)return e;var r=e.content.replaceChild(e.childCount-1,t(e.lastChild,n-1)),o=e.contentMatchAt(e.childCount).fillBefore(c.empty,!0);return e.copy(r.append(o))}(l[l.length-1],o.length));var h=an(t,n);l.push(h),r=r.matchType(h.type,h.attrs),o=n}}})),l)return{v:c.from(l)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(r.content,e),!1),view.someProp("transformPasted",(function(t){r=t(r)})),r}function an(t,e,n){void 0===n&&(n=0);for(var i=e.length-1;i>=n;i--)t=e[i].create(null,c.from(t));return t}function cn(t,e,n,r,o,l){var h=e<0?t.firstChild:t.lastChild,f=h.content;return o<r-1&&(f=cn(f,e,n,r,o+1,l)),o>=n&&(f=e<0?h.contentMatchAt(0).fillBefore(f,t.childCount>1||l<=o).append(f):f.append(h.contentMatchAt(h.childCount).fillBefore(c.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,h.copy(f))}var un={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},ln=null;function hn(){return ln||(ln=document.implementation.createHTMLDocument("title"))}var fn={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},pn=At.ie&&At.ie_version<=11,dn=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};dn.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},dn.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var vn=function(view,t){var e=this;this.view=view,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var i=0;i<t.length;i++)e.queue.push(t[i]);At.ie&&At.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?e.flushSoon():e.flush()})),this.currentSelection=new dn,pn&&(this.onCharData=function(t){e.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),e.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};vn.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},vn.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},vn.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,fn),pn&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},vn.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var i=0;i<e.length;i++)this.queue.push(e[i]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}pn&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},vn.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},vn.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},vn.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},vn.prototype.onSelectionChange=function(){if((!(view=this.view).editable||view.root.activeElement==view.dom)&&Qe(view)){var view;if(this.suppressingSelectionUpdates)return We(this.view);if(At.ie&&At.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&_t(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},vn.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},vn.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,desc=this.view.docView.nearestDesc(e);return desc&&desc.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},vn.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&Qe(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,c=!1,l=[];if(this.view.editable)for(var i=0;i<t.length;i++){var h=this.registerMutation(t[i],l);h&&(r=r<0?h.from:Math.min(h.from,r),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(c=!0))}if(At.gecko&&l.length>1){var f=l.filter((function(t){return"BR"==t.nodeName}));if(2==f.length){var a=f[0],b=f[1];a.parentNode&&a.parentNode.parentNode==b.parentNode?b.remove():a.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(view){if(mn)return;mn=!0,"normal"==getComputedStyle(view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,c,l),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||We(this.view))}},vn.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var desc=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(desc==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!desc||desc.ignoreMutation(t))return null;if("childList"==t.type){var n=t.previousSibling,r=t.nextSibling;if(At.ie&&At.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var o=t.addedNodes[i],c=o.previousSibling,l=o.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(n=c),(!l||Array.prototype.indexOf.call(t.addedNodes,l)<0)&&(r=l)}for(var h=n&&n.parentNode==t.target?Bt(n)+1:0,f=desc.localPosFromDOM(t.target,h,-1),d=r&&r.parentNode==t.target?Bt(r):t.target.childNodes.length,v=0;v<t.addedNodes.length;v++)e.push(t.addedNodes[v]);return{from:f,to:desc.localPosFromDOM(t.target,d,1)}}return"attributes"==t.type?{from:desc.posAtStart-desc.border,to:desc.posAtEnd+desc.border}:{from:desc.posAtStart,to:desc.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var mn=!1;var gn={},yn={};function bn(view,t){view.lastSelectionOrigin=t,view.lastSelectionTime=Date.now()}function wn(view){view.someProp("handleDOMEvents",(function(t){for(var e in t)view.eventHandlers[e]||view.dom.addEventListener(e,view.eventHandlers[e]=function(t){return xn(view,t)})}))}function xn(view,t){return view.someProp("handleDOMEvents",(function(e){var n=e[t.type];return!!n&&(n(view,t)||t.defaultPrevented)}))}function Cn(t){return{left:t.clientX,top:t.clientY}}function Sn(view,t,e,n,r){if(-1==n)return!1;for(var o=view.state.doc.resolve(n),c=function(i){if(view.someProp(t,(function(t){return i>o.depth?t(view,e,o.nodeAfter,o.before(i),r,!0):t(view,e,o.node(i),o.before(i),r,!1)})))return{v:!0}},i=o.depth+1;i>0;i--){var l=c(i);if(l)return l.v}return!1}function kn(view,t,e){view.focused||view.focus();var tr=view.state.tr.setSelection(t);"pointer"==e&&tr.setMeta("pointer",!0),view.dispatch(tr)}function On(view,t,e,n,o){return Sn(view,"handleClickOn",t,e,n)||view.someProp("handleClick",(function(e){return e(view,t,n)}))||(o?function(view,t){if(-1==t)return!1;var e,n,o=view.state.selection;o instanceof r.NodeSelection&&(e=o.node);for(var c=view.state.doc.resolve(t),i=c.depth+1;i>0;i--){var l=i>c.depth?c.nodeAfter:c.node(i);if(r.NodeSelection.isSelectable(l)){n=e&&o.$from.depth>0&&i>=o.$from.depth&&c.before(o.$from.depth+1)==o.$from.pos?c.before(o.$from.depth):c.before(i);break}}return null!=n&&(kn(view,r.NodeSelection.create(view.state.doc,n),"pointer"),!0)}(view,e):function(view,t){if(-1==t)return!1;var e=view.state.doc.resolve(t),n=e.nodeAfter;return!!(n&&n.isAtom&&r.NodeSelection.isSelectable(n))&&(kn(view,new r.NodeSelection(e),"pointer"),!0)}(view,e))}function Mn(view,t,e,n){return Sn(view,"handleDoubleClickOn",t,e,n)||view.someProp("handleDoubleClick",(function(e){return e(view,t,n)}))}function Nn(view,t,e,n){return Sn(view,"handleTripleClickOn",t,e,n)||view.someProp("handleTripleClick",(function(e){return e(view,t,n)}))||function(view,t){var e=view.state.doc;if(-1==t)return!!e.inlineContent&&(kn(view,r.TextSelection.create(e,0,e.content.size),"pointer"),!0);for(var n=e.resolve(t),i=n.depth+1;i>0;i--){var o=i>n.depth?n.nodeAfter:n.node(i),c=n.before(i);if(o.inlineContent)kn(view,r.TextSelection.create(e,c+1,c+1+o.content.size),"pointer");else{if(!r.NodeSelection.isSelectable(o))continue;kn(view,r.NodeSelection.create(e,c),"pointer")}return!0}}(view,e)}function An(view){return Bn(view)}yn.keydown=function(view,t){if(view.shiftKey=16==t.keyCode||t.shiftKey,!Dn(view,t))if(view.domObserver.forceFlush(),view.lastKeyCode=t.keyCode,view.lastKeyCodeTime=Date.now(),!At.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)view.someProp("handleKeyDown",(function(e){return e(view,t)}))||qe(view,t)?t.preventDefault():bn(view,"key");else{var e=Date.now();view.lastIOSEnter=e,view.lastIOSEnterFallbackTimeout=setTimeout((function(){view.lastIOSEnter==e&&(view.someProp("handleKeyDown",(function(t){return t(view,qt(13,"Enter"))})),view.lastIOSEnter=0)}),200)}},yn.keyup=function(view,t){16==t.keyCode&&(view.shiftKey=!1)},yn.keypress=function(view,t){if(!(Dn(view,t)||!t.charCode||t.ctrlKey&&!t.altKey||At.mac&&t.metaKey))if(view.someProp("handleKeyPress",(function(e){return e(view,t)})))t.preventDefault();else{var e=view.state.selection;if(!(e instanceof r.TextSelection&&e.$from.sameParent(e.$to))){var text=String.fromCharCode(t.charCode);view.someProp("handleTextInput",(function(t){return t(view,e.$from.pos,e.$to.pos,text)}))||view.dispatch(view.state.tr.insertText(text).scrollIntoView()),t.preventDefault()}}};var En=At.mac?"metaKey":"ctrlKey";gn.mousedown=function(view,t){view.shiftKey=t.shiftKey;var e=An(view),n=Date.now(),r="singleClick";n-view.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(t,view.lastClick)&&!t[En]&&("singleClick"==view.lastClick.type?r="doubleClick":"doubleClick"==view.lastClick.type&&(r="tripleClick")),view.lastClick={time:n,x:t.clientX,y:t.clientY,type:r};var o=view.posAtCoords(Cn(t));o&&("singleClick"==r?view.mouseDown=new Tn(view,o,t,e):("doubleClick"==r?Mn:Nn)(view,o.pos,o.inside,t)?t.preventDefault():bn(view,"pointer"))};var Tn=function(view,t,e,n){var o,c,l=this;if(this.view=view,this.startDoc=view.state.doc,this.pos=t,this.event=e,this.flushed=n,this.selectNode=e[En],this.allowDefault=e.shiftKey,t.inside>-1)o=view.state.doc.nodeAt(t.inside),c=t.inside;else{var h=view.state.doc.resolve(t.pos);o=h.parent,c=h.depth?h.before():0}this.mightDrag=null;var f=n?null:e.target,d=f?view.docView.nearestDesc(f,!0):null;this.target=d?d.dom:null,(o.type.spec.draggable&&!1!==o.type.spec.selectable||view.state.selection instanceof r.NodeSelection&&c==view.state.selection.from)&&(this.mightDrag={node:o,pos:c,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&At.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return l.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),view.root.addEventListener("mouseup",this.up=this.up.bind(this)),view.root.addEventListener("mousemove",this.move=this.move.bind(this)),bn(view,"pointer")};function Dn(view,t){return!!view.composing||!!(At.safari&&Math.abs(t.timeStamp-view.compositionEndedAt)<500)&&(view.compositionEndedAt=-2e8,!0)}Tn.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},Tn.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Cn(t))),this.allowDefault||!e?bn(this.view,"pointer"):On(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():this.flushed||At.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||At.chrome&&!(this.view.state.selection instanceof r.TextSelection)&&(e.pos==this.view.state.selection.from||e.pos==this.view.state.selection.to)?(kn(this.view,r.Selection.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):bn(this.view,"pointer")}},Tn.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),bn(this.view,"pointer")},gn.touchdown=function(view){An(view),bn(view,"pointer")},gn.contextmenu=function(view){return An(view)};var Rn=At.android?5e3:-1;function Pn(view,t){clearTimeout(view.composingTimeout),t>-1&&(view.composingTimeout=setTimeout((function(){return Bn(view)}),t))}function Bn(view,t){for(view.domObserver.forceFlush(),view.composing=!1;view.compositionNodes.length>0;)view.compositionNodes.pop().markParentsDirty();if(t||view.docView.dirty){var e=Ue(view);return e&&!e.eq(view.state.selection)?view.dispatch(view.state.tr.setSelection(e)):view.updateState(view.state),!0}return!1}yn.compositionstart=yn.compositionupdate=function(view){if(!view.composing){view.domObserver.flush();var t=view.state,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))view.markCursor=view.state.storedMarks||e.marks(),Bn(view,!0),view.markCursor=null;else if(Bn(view),At.gecko&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length)for(var n=view.root.getSelection(),r=n.focusNode,o=n.focusOffset;r&&1==r.nodeType&&0!=o;){var c=o<0?r.lastChild:r.childNodes[o-1];if(!c)break;if(3==c.nodeType){n.collapse(c,c.nodeValue.length);break}r=c,o=-1}view.composing=!0}Pn(view,Rn)},yn.compositionend=function(view,t){view.composing&&(view.composing=!1,view.compositionEndedAt=t.timeStamp,Pn(view,20))};var Fn=At.ie&&At.ie_version<15||At.ios&&At.webkit_version<604;function In(view,text,html,t){var e=sn(view,text,html,view.shiftKey,view.state.selection.$from);if(!view.someProp("handlePaste",(function(n){return n(view,t,e||y.empty)}))&&e){var n=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(e),tr=n?view.state.tr.replaceSelectionWith(n,view.shiftKey):view.state.tr.replaceSelection(e);view.dispatch(tr.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste"))}}gn.copy=yn.cut=function(view,t){var e=view.state.selection,n="cut"==t.type;if(!e.empty){var data=Fn?null:t.clipboardData,r=on(view,e.content()),o=r.dom,text=r.text;data?(t.preventDefault(),data.clearData(),data.setData("text/html",o.innerHTML),data.setData("text/plain",text)):function(view,t){if(view.dom.parentNode){var e=view.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";var n=getSelection(),r=document.createRange();r.selectNodeContents(t),view.dom.blur(),n.removeAllRanges(),n.addRange(r),setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e),view.focus()}),50)}}(view,o),n&&view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},yn.paste=function(view,t){var data=Fn?null:t.clipboardData,html=data&&data.getData("text/html"),text=data&&data.getData("text/plain");data&&(html||text||data.files.length)?(In(view,text,html,t),t.preventDefault()):function(view,t){if(view.dom.parentNode){var e=view.shiftKey||view.state.selection.$from.parent.type.spec.code,n=view.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((function(){view.focus(),n.parentNode&&n.parentNode.removeChild(n),e?In(view,n.value,null,t):In(view,n.textContent,n.innerHTML,t)}),50)}}(view,t)};var _n=function(t,e){this.slice=t,this.move=e},zn=At.mac?"altKey":"ctrlKey";for(var Ln in gn.dragstart=function(view,t){var e=view.mouseDown;if(e&&e.done(),t.dataTransfer){var n=view.state.selection,o=n.empty?null:view.posAtCoords(Cn(t));if(o&&o.pos>=n.from&&o.pos<=(n instanceof r.NodeSelection?n.to-1:n.to));else if(e&&e.mightDrag)view.dispatch(view.state.tr.setSelection(r.NodeSelection.create(view.state.doc,e.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var desc=view.docView.nearestDesc(t.target,!0);if(!desc||!desc.node.type.spec.draggable||desc==view.docView)return;view.dispatch(view.state.tr.setSelection(r.NodeSelection.create(view.state.doc,desc.posBefore)))}var c=view.state.selection.content(),l=on(view,c),h=l.dom,text=l.text;t.dataTransfer.clearData(),t.dataTransfer.setData(Fn?"Text":"text/html",h.innerHTML),Fn||t.dataTransfer.setData("text/plain",text),view.dragging=new _n(c,!t[zn])}},gn.dragend=function(view){window.setTimeout((function(){return view.dragging=null}),50)},yn.dragover=yn.dragenter=function(t,e){return e.preventDefault()},yn.drop=function(view,t){var e=view.dragging;if(view.dragging=null,t.dataTransfer){var n=view.posAtCoords(Cn(t));if(n){var o=view.state.doc.resolve(n.pos);if(o){var c=e&&e.slice||sn(view,t.dataTransfer.getData(Fn?"Text":"text/plain"),Fn?null:t.dataTransfer.getData("text/html"),!1,o);if(view.someProp("handleDrop",(function(n){return n(view,t,c||y.empty,e&&e.move)})))t.preventDefault();else if(c){t.preventDefault();var l=c?Object(Nt.h)(view.state.doc,o.pos,c):o.pos;null==l&&(l=o.pos);var tr=view.state.tr;e&&e.move&&tr.deleteSelection();var h=tr.mapping.map(l),f=0==c.openStart&&0==c.openEnd&&1==c.content.childCount,d=tr.doc;if(f?tr.replaceRangeWith(h,h,c.content.firstChild):tr.replaceRange(h,h,c),!tr.doc.eq(d)){var v=tr.doc.resolve(h);f&&r.NodeSelection.isSelectable(c.content.firstChild)&&v.nodeAfter&&v.nodeAfter.sameMarkup(c.content.firstChild)?tr.setSelection(new r.NodeSelection(v)):tr.setSelection(Ze(view,v,tr.doc.resolve(tr.mapping.map(l)))),view.focus(),view.dispatch(tr.setMeta("uiEvent","drop"))}}}}}},gn.focus=function(view){view.focused||(view.domObserver.stop(),view.dom.classList.add("ProseMirror-focused"),view.domObserver.start(),view.focused=!0,setTimeout((function(){view.docView&&view.hasFocus()&&!view.domObserver.currentSelection.eq(view.root.getSelection())&&We(view)}),20))},gn.blur=function(view){view.focused&&(view.domObserver.stop(),view.dom.classList.remove("ProseMirror-focused"),view.domObserver.start(),view.domObserver.currentSelection.set({}),view.focused=!1)},gn.beforeinput=function(view,t){if(At.chrome&&At.android&&"deleteContentBackward"==t.inputType){var e=view.domChangeCount;setTimeout((function(){if(view.domChangeCount==e&&(view.dom.blur(),view.focus(),!view.someProp("handleKeyDown",(function(t){return t(view,qt(8,"Backspace"))})))){var t=view.state.selection.$cursor;t&&t.pos>0&&view.dispatch(view.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},yn)gn[Ln]=yn[Ln];function jn(a,b){if(a==b)return!0;for(var p in a)if(a[p]!==b[p])return!1;for(var t in b)if(!(t in a))return!1;return!0}var Vn=function(t,e){this.spec=e||Hn,this.side=this.spec.side||0,this.toDOM=t};Vn.prototype.map=function(t,span,e,n){var r=t.mapResult(span.from+n,this.side<0?-1:1),o=r.pos;return r.deleted?null:new Un(o-e,o-e,this)},Vn.prototype.valid=function(){return!0},Vn.prototype.eq=function(t){return this==t||t instanceof Vn&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&jn(this.spec,t.spec))};var $n=function(t,e){this.spec=e||Hn,this.attrs=t};$n.prototype.map=function(t,span,e,n){var r=t.map(span.from+n,this.spec.inclusiveStart?-1:1)-e,o=t.map(span.to+n,this.spec.inclusiveEnd?1:-1)-e;return r>=o?null:new Un(r,o,this)},$n.prototype.valid=function(t,span){return span.from<span.to},$n.prototype.eq=function(t){return this==t||t instanceof $n&&jn(this.attrs,t.attrs)&&jn(this.spec,t.spec)},$n.is=function(span){return span.type instanceof $n};var qn=function(t,e){this.spec=e||Hn,this.attrs=t};qn.prototype.map=function(t,span,e,n){var r=t.mapResult(span.from+n,1);if(r.deleted)return null;var o=t.mapResult(span.to+n,-1);return o.deleted||o.pos<=r.pos?null:new Un(r.pos-e,o.pos-e,this)},qn.prototype.valid=function(t,span){var e=t.content.findIndex(span.from),n=e.index,r=e.offset;return r==span.from&&r+t.child(n).nodeSize==span.to},qn.prototype.eq=function(t){return this==t||t instanceof qn&&jn(this.attrs,t.attrs)&&jn(this.spec,t.spec)};var Un=function(t,e,n){this.from=t,this.to=e,this.type=n},Wn={spec:{configurable:!0}};Un.prototype.copy=function(t,e){return new Un(t,e,this.type)},Un.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},Un.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},Un.widget=function(t,e,n){return new Un(t,t,new Vn(e,n))},Un.inline=function(t,e,n,r){return new Un(t,e,new $n(n,r))},Un.node=function(t,e,n,r){return new Un(t,e,new qn(n,r))},Wn.spec.get=function(){return this.type.spec},Object.defineProperties(Un.prototype,Wn);var Jn=[],Hn={},Kn=function(t,e){this.local=t&&t.length?t:Jn,this.children=e&&e.length?e:Jn};Kn.create=function(t,e){return e.length?er(e,t,0,Hn):Yn},Kn.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},Kn.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var span=this.local[i];span.from<=e&&span.to>=t&&(!o||o(span.spec))&&n.push(span.copy(span.from+r,span.to+r))}for(var c=0;c<this.children.length;c+=3)if(this.children[c]<e&&this.children[c+1]>t){var l=this.children[c]+1;this.children[c+2].findInner(t-l,e-l,n,r+l,o)}},Kn.prototype.map=function(t,e,n){return this==Yn||0==t.maps.length?this:this.mapInner(t,e,0,0,n||Hn)},Kn.prototype.mapInner=function(t,e,n,r,o){for(var c,i=0;i<this.local.length;i++){var l=this.local[i].map(t,n,r);l&&l.type.valid(e,l)?(c||(c=[])).push(l):o.onRemove&&o.onRemove(this.local[i].spec)}return this.children.length?function(t,e,n,r,o,c,l){for(var h=t.slice(),f=function(t,e,n,r){for(var i=0;i<h.length;i+=3){var l=h[i+1],f=void 0;-1==l||t>l+c||(e>=h[i]+c?h[i+1]=-1:n>=o&&(f=r-n-(e-t))&&(h[i]+=f,h[i+1]+=f))}},i=0;i<n.maps.length;i++)n.maps[i].forEach(f);for(var d=!1,v=0;v<h.length;v+=3)if(-1==h[v+1]){var m=n.map(h[v]+c),y=m-o;if(y<0||y>=r.content.size){d=!0;continue}var w=n.map(t[v+1]+c,-1)-o,x=r.content.findIndex(y),C=x.index,S=x.offset,k=r.maybeChild(C);if(k&&S==y&&S+k.nodeSize==w){var O=h[v+2].mapInner(n,k,m+1,h[v]+c+1,l);O!=Yn?(h[v]=y,h[v+1]=w,h[v+2]=O):(h[v+1]=-2,d=!0)}else d=!0}if(d){var M=er(function(t,e,n,r,o,c,l){function h(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):l.onRemove&&l.onRemove(t.local[i].spec)}for(var f=0;f<t.children.length;f+=3)h(t.children[f+2],t.children[f]+e+1)}for(var i=0;i<t.length;i+=3)-1==t[i+1]&&h(t[i+2],e[i]+c+1);return n}(h,t,e||[],n,o,c,l),r,0,l);e=M.local;for(var N=0;N<h.length;N+=3)h[N+1]<0&&(h.splice(N,3),N-=3);for(var A=0,E=0;A<M.children.length;A+=3){for(var T=M.children[A];E<h.length&&h[E]<T;)E+=3;h.splice(E,0,M.children[A],M.children[A+1],M.children[A+2])}}return new Kn(e&&e.sort(nr),h)}(this.children,c,t,e,n,r,o):c?new Kn(c.sort(nr)):Yn},Kn.prototype.add=function(t,e){return e.length?this==Yn?Kn.create(t,e):this.addInner(t,e,0):this},Kn.prototype.addInner=function(t,e,n){var r,o=this,c=0;t.forEach((function(t,l){var h,f=l+n;if(h=Zn(e,t,f)){for(r||(r=o.children.slice());c<r.length&&r[c]<l;)c+=3;r[c]==l?r[c+2]=r[c+2].addInner(t,h,f+1):r.splice(c,0,l,l+t.nodeSize,er(h,t,f+1,Hn)),c+=3}}));var l=Gn(c?Qn(e):e,-n);return new Kn(l.length?this.local.concat(l).sort(nr):this.local,r||this.children)},Kn.prototype.remove=function(t){return 0==t.length||this==Yn?this:this.removeInner(t,0)},Kn.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,i=0;i<n.length;i+=3){for(var o=void 0,c=n[i]+e,l=n[i+1]+e,h=0,span=void 0;h<t.length;h++)(span=t[h])&&span.from>c&&span.to<l&&(t[h]=null,(o||(o=[])).push(span));if(o){n==this.children&&(n=this.children.slice());var f=n[i+2].removeInner(o,c+1);f!=Yn?n[i+2]=f:(n.splice(i,3),i-=3)}}if(r.length)for(var d=0,v=void 0;d<t.length;d++)if(v=t[d])for(var m=0;m<r.length;m++)r[m].eq(v,e)&&(r==this.local&&(r=this.local.slice()),r.splice(m--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Kn(r,n):Yn},Kn.prototype.forChild=function(t,e){if(this==Yn)return this;if(e.isLeaf)return Kn.empty;for(var n,r,i=0;i<this.children.length;i+=3)if(this.children[i]>=t){this.children[i]==t&&(n=this.children[i+2]);break}for(var o=t+1,c=o+e.content.size,l=0;l<this.local.length;l++){var h=this.local[l];if(h.from<c&&h.to>o&&h.type instanceof $n){var f=Math.max(o,h.from)-o,d=Math.min(c,h.to)-o;f<d&&(r||(r=[])).push(h.copy(f,d))}}if(r){var v=new Kn(r.sort(nr));return n?new Xn([v,n]):v}return n||Yn},Kn.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof Kn)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var i=0;i<this.local.length;i++)if(!this.local[i].eq(t.local[i]))return!1;for(var e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0},Kn.prototype.locals=function(t){return rr(this.localsInner(t))},Kn.prototype.localsInner=function(t){if(this==Yn)return Jn;if(t.inlineContent||!this.local.some($n.is))return this.local;for(var e=[],i=0;i<this.local.length;i++)this.local[i].type instanceof $n||e.push(this.local[i]);return e};var Yn=new Kn;Kn.empty=Yn,Kn.removeOverlap=rr;var Xn=function(t){this.members=t};function Gn(t,e){if(!e||!t.length)return t;for(var n=[],i=0;i<t.length;i++){var span=t[i];n.push(new Un(span.from+e,span.to+e,span.type))}return n}function Zn(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,span=void 0;i<t.length;i++)(span=t[i])&&span.from>n&&span.to<r&&((o||(o=[])).push(span),t[i]=null);return o}function Qn(t){for(var e=[],i=0;i<t.length;i++)null!=t[i]&&e.push(t[i]);return e}function er(t,e,n,r){var o=[],c=!1;e.forEach((function(e,l){var h=Zn(t,e,l+n);if(h){c=!0;var f=er(h,e,n+l+1,r);f!=Yn&&o.push(l,l+e.nodeSize,f)}}));for(var l=Gn(c?Qn(t):t,-n).sort(nr),i=0;i<l.length;i++)l[i].type.valid(e,l[i])||(r.onRemove&&r.onRemove(l[i].spec),l.splice(i--,1));return l.length||o.length?new Kn(l,o):Yn}function nr(a,b){return a.from-b.from||a.to-b.to}function rr(t){for(var e=t,i=0;i<e.length-1;i++){var span=e[i];if(span.from!=span.to)for(var n=i+1;n<e.length;n++){var r=e[n];if(r.from!=span.from){r.from<span.to&&(e==t&&(e=t.slice()),e[i]=span.copy(span.from,r.from),or(e,n,span.copy(r.from,span.to)));break}r.to!=span.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,span.to),or(e,n+1,r.copy(span.to,r.to)))}}return e}function or(t,i,e){for(;i<t.length&&nr(e,t[i])>0;)i++;t.splice(i,0,e)}function ir(view){var t=[];return view.someProp("decorations",(function(e){var n=e(view.state);n&&n!=Yn&&t.push(n)})),view.cursorWrapper&&t.push(Kn.create(view.state.doc,[view.cursorWrapper.deco])),Xn.from(t)}Xn.prototype.forChild=function(t,e){if(e.isLeaf)return Kn.empty;for(var n=[],i=0;i<this.members.length;i++){var r=this.members[i].forChild(t,e);r!=Yn&&(r instanceof Xn?n=n.concat(r.members):n.push(r))}return Xn.from(n)},Xn.prototype.eq=function(t){if(!(t instanceof Xn)||t.members.length!=this.members.length)return!1;for(var i=0;i<this.members.length;i++)if(!this.members[i].eq(t.members[i]))return!1;return!0},Xn.prototype.locals=function(t){for(var e,n=!0,i=0;i<this.members.length;i++){var r=this.members[i].localsInner(t);if(r.length)if(e){n&&(e=e.slice(),n=!1);for(var o=0;o<r.length;o++)e.push(r[o])}else e=r}return e?rr(n?e:e.sort(nr)):Jn},Xn.from=function(t){switch(t.length){case 0:return Yn;case 1:return t[0];default:return new Xn(t)}};var sr,ar,cr=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=pr(this),this.markCursor=null,this.cursorWrapper=null,fr(this),this.nodeViews=dr(this),this.docView=me(this.state.doc,lr(this),ir(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(view){view.shiftKey=!1,view.mouseDown=null,view.lastKeyCode=null,view.lastKeyCodeTime=0,view.lastClick={time:0,x:0,y:0,type:""},view.lastSelectionOrigin=null,view.lastSelectionTime=0,view.lastIOSEnter=0,view.lastIOSEnterFallbackTimeout=null,view.composing=!1,view.composingTimeout=null,view.compositionNodes=[],view.compositionEndedAt=-2e8,view.domObserver=new vn(view,(function(t,e,n,r){return en(view,t,e,n,r)})),view.domObserver.start(),view.domChangeCount=0,view.eventHandlers=Object.create(null);var t=function(t){var e=gn[t];view.dom.addEventListener(t,view.eventHandlers[t]=function(t){!function(view,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var e=t.target;e!=view.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}(view,t)||xn(view,t)||!view.editable&&t.type in yn||e(view,t)})};for(var e in gn)t(e);At.safari&&view.dom.addEventListener("input",(function(){return null})),wn(view)}(this),this.pluginViews=[],this.updatePluginViews()},ur={props:{configurable:!0},root:{configurable:!0}};function lr(view){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(view.editable),view.someProp("attributes",(function(e){if("function"==typeof e&&(e=e(view.state)),e)for(var n in e)"class"==n?t.class+=" "+e[n]:t[n]||"contenteditable"==n||"nodeName"==n||(t[n]=String(e[n]))})),[Un.node(0,view.state.doc.content.size,t)]}function fr(view){if(view.markCursor){var t=document.createElement("img");t.setAttribute("mark-placeholder","true"),view.cursorWrapper={dom:t,deco:Un.widget(view.state.selection.head,t,{raw:!0,marks:view.markCursor})}}else view.cursorWrapper=null}function pr(view){return!view.someProp("editable",(function(t){return!1===t(view.state)}))}function dr(view){var t={};return view.someProp("nodeViews",(function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])})),t}function vr(t){var e=t.getSelection(),n=e.focusOffset,r=e.focusNode;return r&&1==r.nodeType?[r,n,r.childNodes[n-1],r.childNodes[n]]:null}if(ur.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},cr.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&wn(this),this._props=t,this.updateStateInner(t.state,!0)},cr.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},cr.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},cr.prototype.updateStateInner=function(t,e){var n=this,o=this.state,c=!1;if(this.state=t,e){var l=dr(this);(function(a,b){var t=0,e=0;for(var n in a){if(a[n]!=b[n])return!0;t++}for(var r in b)e++;return t!=e})(l,this.nodeViews)&&(this.nodeViews=l,c=!0),wn(this)}this.editable=pr(this),fr(this);var view,h,f,d,v,m,y,w,x,C,S,k=ir(this),O=lr(this),M=e?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",N=c||!this.docView.matchesNode(t.doc,O,k),A=N||!t.selection.eq(o.selection),E="preserve"==M&&A&&null==this.dom.style.overflowAnchor&&function(view){for(var t,e,rect=view.dom.getBoundingClientRect(),n=Math.max(0,rect.top),r=(rect.left+rect.right)/2,o=n+1;o<Math.min(innerHeight,rect.bottom);o+=5){var c=view.root.elementFromPoint(r,o);if(c!=view.dom&&view.dom.contains(c)){var l=c.getBoundingClientRect();if(l.top>=n-20){t=c,e=l.top;break}}}return{refDOM:t,refTop:e,stack:Kt(view.dom)}}(this);if(A){this.domObserver.stop();var T=N&&(At.ie||At.chrome)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&(d=o.selection,v=t.selection,m=Math.min(d.$anchor.sharedDepth(d.head),v.$anchor.sharedDepth(v.head)),d.$anchor.start(m)!=v.$anchor.start(m));if(N){var D=At.chrome&&vr(this.root);!c&&this.docView.update(t.doc,O,k,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=me(t.doc,O,k,this.dom,this)),D&&function(t,e){var n=vr(e);if(!n||3==n[0].nodeType)return!1;for(var i=0;i<t.length;i++)if(n[i]!=t[i])return!0;return!1}(D,this.root)&&(T=!0)}T||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(view=this,h=view.docView.domFromPos(view.state.selection.anchor),f=view.root.getSelection(),_t(h.node,h.offset,f.anchorNode,f.anchorOffset)))?We(this,T):(Xe(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==M)this.dom.scrollTop=0;else if("to selection"==M){var R=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof r.NodeSelection?Ht(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),R):Ht(this,this.coordsAtPos(t.selection.head),R))}else E&&(w=(y=E).refDOM,x=y.refTop,C=y.stack,S=w?w.getBoundingClientRect().top:0,Yt(C,0==S?0:S-x))},cr.prototype.destroyPluginViews=function(){for(var view;view=this.pluginViews.pop();)view.destroy&&view.destroy()},cr.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var i=0;i<this.state.plugins.length;i++){var r=this.state.plugins[i];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}},cr.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var c=o[i].props[t];if(null!=c&&(n=e?e(c):c))return n}},cr.prototype.hasFocus=function(){return this.root.activeElement==this.dom},cr.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Xt)return t.focus(Xt);var e=Kt(t);t.focus(null==Xt?{get preventScroll(){return Xt={preventScroll:!0},!0}}:void 0),Xt||(Xt=!1,Yt(e,0))}(this.dom),We(this),this.domObserver.start()},ur.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},cr.prototype.posAtCoords=function(t){return Qt(this,t)},cr.prototype.coordsAtPos=function(t){return ee(this,t)},cr.prototype.domAtPos=function(t){return this.docView.domFromPos(t)},cr.prototype.nodeDOM=function(t){var desc=this.docView.descAt(t);return desc?desc.nodeDOM:null},cr.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},cr.prototype.endOfTextblock=function(t,e){return ce(this,e||this.state,t)},cr.prototype.destroy=function(){this.docView&&(!function(view){for(var t in view.domObserver.stop(),view.eventHandlers)view.dom.removeEventListener(t,view.eventHandlers[t]);clearTimeout(view.composingTimeout),clearTimeout(view.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ir(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},cr.prototype.dispatchEvent=function(t){return function(view,t){xn(view,t)||!gn[t.type]||!view.editable&&t.type in yn||gn[t.type](view,t)}(this,t)},cr.prototype.dispatch=function(tr){var t=this._props.dispatchTransaction;t?t.call(this,tr):this.updateState(this.state.apply(tr))},Object.defineProperties(cr.prototype,ur),"undefined"!=typeof WeakMap){var mr=new WeakMap;sr=function(t){return mr.get(t)},ar=function(t,e){return mr.set(t,e),e}}else{var gr=[],yr=0;sr=function(t){for(var i=0;i<gr.length;i+=2)if(gr[i]==t)return gr[i+1]},ar=function(t,e){return 10==yr&&(yr=0),gr[yr++]=t,gr[yr++]=e}}var wr=function(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r},xr=function(t,e,map,n){this.width=t,this.height=e,this.map=map,this.problems=n};function Cr(t){if(t.colwidth)return t.colwidth.slice();for(var e=[],i=0;i<t.colspan;i++)e.push(0);return e}xr.prototype.findCell=function(t){for(var i=0;i<this.map.length;i++){var e=this.map[i];if(e==t){for(var n=i%this.width,r=i/this.width|0,o=n+1,c=r+1,l=1;o<this.width&&this.map[i+l]==e;l++)o++;for(var h=1;c<this.height&&this.map[i+this.width*h]==e;h++)c++;return new wr(n,r,o,c)}}throw new RangeError("No cell with offset "+t+" found")},xr.prototype.colCount=function(t){for(var i=0;i<this.map.length;i++)if(this.map[i]==t)return i%this.width;throw new RangeError("No cell with offset "+t+" found")},xr.prototype.nextCell=function(t,e,n){var r=this.findCell(t),o=r.left,c=r.right,l=r.top,h=r.bottom;return"horiz"==e?(n<0?0==o:c==this.width)?null:this.map[l*this.width+(n<0?o-1:c)]:(n<0?0==l:h==this.height)?null:this.map[o+this.width*(n<0?l-1:h)]},xr.prototype.rectBetween=function(a,b){var t=this.findCell(a),e=t.left,n=t.right,r=t.top,o=t.bottom,c=this.findCell(b),l=c.left,h=c.right,f=c.top,d=c.bottom;return new wr(Math.min(e,l),Math.min(r,f),Math.max(n,h),Math.max(o,d))},xr.prototype.cellsInRect=function(rect){for(var t=[],e={},n=rect.top;n<rect.bottom;n++)for(var col=rect.left;col<rect.right;col++){var r=n*this.width+col,o=this.map[r];e[o]||(e[o]=!0,col==rect.left&&col&&this.map[r-1]==o||n==rect.top&&n&&this.map[r-this.width]==o||t.push(o))}return t},xr.prototype.positionAt=function(t,col,table){for(var i=0,e=0;;i++){var n=e+table.child(i).nodeSize;if(i==t){for(var r=col+t*this.width,o=(t+1)*this.width;r<o&&this.map[r]<e;)r++;return r==o?n-1:this.map[r]}e=n}},xr.get=function(table){return sr(table)||ar(table,function(table){if("table"!=table.type.spec.tableRole)throw new RangeError("Not a table node: "+table.type.name);for(var t=function(table){for(var t=-1,e=!1,n=0;n<table.childCount;n++){var r=table.child(n),o=0;if(e)for(var c=0;c<n;c++)for(var l=table.child(c),i=0;i<l.childCount;i++){var h=l.child(i);c+h.attrs.rowspan>n&&(o+=h.attrs.colspan)}for(var f=0;f<r.childCount;f++){var d=r.child(f);o+=d.attrs.colspan,d.attrs.rowspan>1&&(e=!0)}-1==t?t=o:t!=o&&(t=Math.max(t,o))}return t}(table),e=table.childCount,map=[],n=0,r=null,o=[],i=0,c=t*e;i<c;i++)map[i]=0;for(var l=0,h=0;l<e;l++){var f=table.child(l);h++;for(var d=0;;d++){for(;n<map.length&&0!=map[n];)n++;if(d==f.childCount)break;for(var v=f.child(d),m=v.attrs,y=m.colspan,w=m.rowspan,x=m.colwidth,C=0;C<w;C++){if(C+l>=e){(r||(r=[])).push({type:"overlong_rowspan",pos:h,n:w-C});break}for(var S=n+C*t,k=0;k<y;k++){0==map[S+k]?map[S+k]=h:(r||(r=[])).push({type:"collision",row:l,pos:h,n:y-k});var O=x&&x[k];if(O){var M=(S+k)%t*2,N=o[M];null==N||N!=O&&1==o[M+1]?(o[M]=O,o[M+1]=1):N==O&&o[M+1]++}}}n+=y,h+=v.nodeSize}for(var A=(l+1)*t,E=0;n<A;)0==map[n++]&&E++;E&&(r||(r=[])).push({type:"missing",row:l,n:E}),h++}for(var T=new xr(t,e,map,r),D=!1,R=0;!D&&R<o.length;R+=2)null!=o[R]&&o[R+1]<e&&(D=!0);D&&function(map,t,table){map.problems||(map.problems=[]);for(var i=0,e={};i<map.map.length;i++){var n=map.map[i];if(!e[n]){e[n]=!0;for(var r=table.nodeAt(n),o=null,c=0;c<r.attrs.colspan;c++){var col=(i+c)%map.width,l=t[2*col];null==l||r.attrs.colwidth&&r.attrs.colwidth[c]==l||((o||(o=Cr(r.attrs)))[c]=l)}o&&map.problems.unshift({type:"colwidth mismatch",pos:n,colwidth:o})}}}(T,o,table);return T}(table))};var Sr=new r.PluginKey("selectingCells");function kr(t){for(var e=t.depth-1;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return t.node(0).resolve(t.before(e+1));return null}function Or(t){for(var e=t.selection.$head,n=e.depth;n>0;n--)if("row"==e.node(n).type.spec.tableRole)return!0;return!1}function Mr(t){var e=t.selection;return e.$anchorCell?e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell:e.node&&"cell"==e.node.type.spec.tableRole?e.$anchor:kr(e.$head)||function(t){for(var e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){var r=e.type.spec.tableRole;if("cell"==r||"header_cell"==r)return t.doc.resolve(n)}for(var o=t.nodeBefore,c=t.pos;o;o=o.lastChild,c--){var l=o.type.spec.tableRole;if("cell"==l||"header_cell"==l)return t.doc.resolve(c-o.nodeSize)}}(e.$head)}function Nr(t){return"row"==t.parent.type.spec.tableRole&&t.nodeAfter}function Ar(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function Er(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function Tr(t){return xr.get(t.node(-1)).findCell(t.pos-t.start(-1))}function Dr(t){return xr.get(t.node(-1)).colCount(t.pos-t.start(-1))}function Rr(t,e,n){var r=t.start(-1),o=xr.get(t.node(-1)).nextCell(t.pos-r,e,n);return null==o?null:t.node(0).resolve(r+o)}function Pr(t,e,n){var r={};for(var o in t)r[o]=t[o];return r[e]=n,r}function Br(t,e,n){void 0===n&&(n=1);var r=Pr(t,"colspan",t.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some((function(t){return t>0}))||(r.colwidth=null)),r}function Fr(t,e,n){void 0===n&&(n=1);var r=Pr(t,"colspan",t.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(var i=0;i<n;i++)r.colwidth.splice(e,0,0)}return r}var Ir=function(t){function e(e,n){void 0===n&&(n=e);var table=e.node(-1),map=xr.get(table),o=e.start(-1),rect=map.rectBetween(e.pos-o,n.pos-o),c=e.node(0),l=map.cellsInRect(rect).filter((function(p){return p!=n.pos-o}));l.unshift(n.pos-o);var h=l.map((function(t){var e=table.nodeAt(t),n=t+o+1;return new r.SelectionRange(c.resolve(n),c.resolve(n+e.content.size))}));t.call(this,h[0].$from,h[0].$to,h),this.$anchorCell=e,this.$headCell=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,n){var o=t.resolve(n.map(this.$anchorCell.pos)),c=t.resolve(n.map(this.$headCell.pos));if(Nr(o)&&Nr(c)&&Er(o,c)){var l=this.$anchorCell.node(-1)!=o.node(-1);return l&&this.isRowSelection()?e.rowSelection(o,c):l&&this.isColSelection()?e.colSelection(o,c):new e(o,c)}return r.TextSelection.between(o,c)},e.prototype.content=function(){for(var table=this.$anchorCell.node(-1),map=xr.get(table),t=this.$anchorCell.start(-1),rect=map.rectBetween(this.$anchorCell.pos-t,this.$headCell.pos-t),e={},n=[],r=rect.top;r<rect.bottom;r++){for(var o=[],l=r*map.width+rect.left,col=rect.left;col<rect.right;col++,l++){var h=map.map[l];if(!e[h]){e[h]=!0;var f=map.findCell(h),d=table.nodeAt(h),v=rect.left-f.left,m=f.right-rect.right;if(v>0||m>0){var w=d.attrs;v>0&&(w=Br(w,0,v)),m>0&&(w=Br(w,w.colspan-m,m)),d=f.left<rect.left?d.type.createAndFill(w):d.type.create(w,d.content)}if(f.top<rect.top||f.bottom>rect.bottom){var x=Pr(d.attrs,"rowspan",Math.min(f.bottom,rect.bottom)-Math.max(f.top,rect.top));d=f.top<rect.top?d.type.createAndFill(x):d.type.create(x,d.content)}o.push(d)}}n.push(table.child(r).copy(c.from(o)))}var C=this.isColSelection()&&this.isRowSelection()?table:n;return new y(c.from(C),1,1)},e.prototype.replace=function(tr,content){void 0===content&&(content=y.empty);for(var e=tr.steps.length,n=this.ranges,i=0;i<n.length;i++){var r=n[i],o=r.$from,c=r.$to,l=tr.mapping.slice(e);tr.replace(l.map(o.pos),l.map(c.pos),i?y.empty:content)}var h=t.findFrom(tr.doc.resolve(tr.mapping.slice(e).map(this.to)),-1);h&&tr.setSelection(h)},e.prototype.replaceWith=function(tr,t){this.replace(tr,new y(c.from(t),0,0))},e.prototype.forEachCell=function(t){for(var table=this.$anchorCell.node(-1),map=xr.get(table),e=this.$anchorCell.start(-1),n=map.cellsInRect(map.rectBetween(this.$anchorCell.pos-e,this.$headCell.pos-e)),i=0;i<n.length;i++)t(table.nodeAt(n[i]),e+n[i])},e.prototype.isColSelection=function(){var t=this.$anchorCell.index(-1),e=this.$headCell.index(-1);if(Math.min(t,e)>0)return!1;var n=t+this.$anchorCell.nodeAfter.attrs.rowspan,r=e+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount},e.colSelection=function(t,n){void 0===n&&(n=t);var map=xr.get(t.node(-1)),r=t.start(-1),o=map.findCell(t.pos-r),c=map.findCell(n.pos-r),l=t.node(0);return o.top<=c.top?(o.top>0&&(t=l.resolve(r+map.map[o.left])),c.bottom<map.height&&(n=l.resolve(r+map.map[map.width*(map.height-1)+c.right-1]))):(c.top>0&&(n=l.resolve(r+map.map[c.left])),o.bottom<map.height&&(t=l.resolve(r+map.map[map.width*(map.height-1)+o.right-1]))),new e(t,n)},e.prototype.isRowSelection=function(){var map=xr.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),e=map.colCount(this.$anchorCell.pos-t),n=map.colCount(this.$headCell.pos-t);if(Math.min(e,n)>0)return!1;var r=e+this.$anchorCell.nodeAfter.attrs.colspan,o=n+this.$headCell.nodeAfter.attrs.colspan;return Math.max(r,o)==map.width},e.prototype.eq=function(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos},e.rowSelection=function(t,n){void 0===n&&(n=t);var map=xr.get(t.node(-1)),r=t.start(-1),o=map.findCell(t.pos-r),c=map.findCell(n.pos-r),l=t.node(0);return o.left<=c.left?(o.left>0&&(t=l.resolve(r+map.map[o.top*map.width])),c.right<map.width&&(n=l.resolve(r+map.map[map.width*(c.top+1)-1]))):(c.left>0&&(n=l.resolve(r+map.map[c.top*map.width])),o.right<map.width&&(t=l.resolve(r+map.map[map.width*(o.top+1)-1]))),new e(t,n)},e.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},e.fromJSON=function(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,n,r){return void 0===r&&(r=n),new e(t.resolve(n),t.resolve(r))},e.prototype.getBookmark=function(){return new _r(this.$anchorCell.pos,this.$headCell.pos)},e}(r.Selection);Ir.prototype.visible=!1,r.Selection.jsonID("cell",Ir);var _r=function(t,head){this.anchor=t,this.head=head};function zr(t){if(!(t.selection instanceof Ir))return null;var e=[];return t.selection.forEachCell((function(t,n){e.push(Un.node(n,n+t.nodeSize,{class:"selectedCell"}))})),Kn.create(t.doc,e)}function Lr(t,e){var n=t.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((function(s){return Number(s)})):null,o=Number(t.getAttribute("colspan")||1),c={colspan:o,rowspan:Number(t.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(var l in e){var h=e[l].getFromDOM,f=h&&h(t);null!=f&&(c[l]=f)}return c}function jr(t,e){var n={};for(var r in 1!=t.attrs.colspan&&(n.colspan=t.attrs.colspan),1!=t.attrs.rowspan&&(n.rowspan=t.attrs.rowspan),t.attrs.colwidth&&(n["data-colwidth"]=t.attrs.colwidth.join(",")),e){var o=e[r].setDOMAttr;o&&o(t.attrs[r],n)}return n}function Vr(t){var e=t.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(var r in e)n[r]={default:e[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:t.tableGroup,parseDOM:[{tag:"table"}],toDOM:function(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:function(){return["tr",0]}},table_cell:{content:t.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:function(t){return Lr(t,e)}}],toDOM:function(t){return["td",jr(t,e),0]}},table_header:{content:t.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:function(t){return Lr(t,e)}}],toDOM:function(t){return["th",jr(t,e),0]}}}}function $r(t){var e=t.cached.tableNodeTypes;if(!e)for(var n in e=t.cached.tableNodeTypes={},t.nodes){var r=t.nodes[n],o=r.spec.tableRole;o&&(e[o]=r)}return e}function qr(t){if(!t.size)return null;for(var content=t.content,e=t.openStart,n=t.openEnd;1==content.childCount&&(e>0&&n>0||"table"==content.firstChild.type.spec.tableRole);)e--,n--,content=content.firstChild.content;var r=content.firstChild,o=r.type.spec.tableRole,l=r.type.schema,h=[];if("row"==o)for(var i=0;i<content.childCount;i++){var f=content.child(i).content,d=i?0:Math.max(0,e-1),v=i<content.childCount-1?0:Math.max(0,n-1);(d||v)&&(f=Ur($r(l).row,new y(f,d,v)).content),h.push(f)}else{if("cell"!=o&&"header_cell"!=o)return null;h.push(e||n?Ur($r(l).row,new y(content,e,n)).content:content)}return function(t,e){for(var n=[],i=0;i<e.length;i++)for(var r=e[i],o=r.childCount-1;o>=0;o--)for(var l=r.child(o).attrs,h=l.rowspan,f=l.colspan,d=i;d<i+h;d++)n[d]=(n[d]||0)+f;for(var v=0,m=0;m<n.length;m++)v=Math.max(v,n[m]);for(var y=0;y<n.length;y++)if(y>=e.length&&e.push(c.empty),n[y]<v){for(var w=$r(t).cell.createAndFill(),x=[],C=n[y];C<v;C++)x.push(w);e[y]=e[y].append(c.from(x))}return{height:e.length,width:v,rows:e}}(l,h)}function Ur(t,e){var n=t.createAndFill();return new Nt.e(n).replace(0,n.content.size,e).doc}function Wr(t,e,n){var r=t.width,o=t.height,l=t.rows;if(r!=e){for(var h=[],f=[],d=0;d<l.length;d++){for(var v=l[d],m=[],col=h[d]||0,i=0;col<e;i++){var y=v.child(i%v.childCount);col+y.attrs.colspan>e&&(y=y.type.create(Br(y.attrs,y.attrs.colspan,col+y.attrs.colspan-e),y.content)),m.push(y),col+=y.attrs.colspan;for(var w=1;w<y.attrs.rowspan;w++)h[d+w]=(h[d+w]||0)+y.attrs.colspan}f.push(c.from(m))}l=f,r=e}if(o!=n){for(var x=[],C=0,S=0;C<n;C++,S++){for(var k=[],source=l[S%o],O=0;O<source.childCount;O++){var M=source.child(O);C+M.attrs.rowspan>n&&(M=M.type.create(Pr(M.attrs,"rowspan",n-M.attrs.rowspan),M.content)),k.push(M)}x.push(c.from(k))}l=x,o=n}return{width:r,height:o,rows:l}}function Jr(tr,map,table,t,e,n,r,o){if(0==r||r==map.height)return!1;for(var c=!1,col=e;col<n;col++){var l=r*map.width+col,h=map.map[l];if(map.map[l-map.width]==h){c=!0;var f=table.nodeAt(h),d=map.findCell(h),v=d.top,m=d.left;tr.setNodeMarkup(tr.mapping.slice(o).map(h+t),null,Pr(f.attrs,"rowspan",r-v)),tr.insert(tr.mapping.slice(o).map(map.positionAt(r,m,table)),f.type.createAndFill(Pr(f.attrs,"rowspan",v+f.attrs.rowspan-r))),col+=f.attrs.colspan-1}}return c}function Hr(tr,map,table,t,e,n,r,o){if(0==r||r==map.width)return!1;for(var c=!1,l=e;l<n;l++){var h=l*map.width+r,f=map.map[h];if(map.map[h-1]==f){c=!0;var d=table.nodeAt(f),v=map.colCount(f),m=tr.mapping.slice(o).map(f+t);tr.setNodeMarkup(m,null,Br(d.attrs,r-v,d.attrs.colspan-(r-v))),tr.insert(m+d.nodeSize,d.type.createAndFill(Br(d.attrs,0,r-v))),l+=d.attrs.rowspan-1}}return c}function Kr(t,e,n,rect,r){var table=n?t.doc.nodeAt(n-1):t.doc,map=xr.get(table),o=rect.top,l=rect.left,h=l+r.width,f=o+r.height,tr=t.tr,d=0;function v(){table=n?tr.doc.nodeAt(n-1):tr.doc,map=xr.get(table),d=tr.mapping.maps.length}(function(tr,map,table,t,e,n,r){var o,l,h=$r(tr.doc.type.schema);if(e>map.width)for(var f=0,d=0;f<map.height;f++){var v=table.child(f);d+=v.nodeSize;var m=[],y=void 0;y=null==v.lastChild||v.lastChild.type==h.cell?o||(o=h.cell.createAndFill()):l||(l=h.header_cell.createAndFill());for(var i=map.width;i<e;i++)m.push(y);tr.insert(tr.mapping.slice(r).map(d-1+t),m)}if(n>map.height){for(var w=[],x=0,C=(map.height-1)*map.width;x<Math.max(map.width,e);x++){var header=!(x>=map.width)&&table.nodeAt(map.map[C+x]).type==h.header_cell;w.push(header?l||(l=h.header_cell.createAndFill()):o||(o=h.cell.createAndFill()))}for(var S=h.row.create(null,c.from(w)),k=[],O=map.height;O<n;O++)k.push(S);tr.insert(tr.mapping.slice(r).map(t+table.nodeSize-2),k)}return!(!o&&!l)})(tr,map,table,n,h,f,d)&&v(),Jr(tr,map,table,n,l,h,o,d)&&v(),Jr(tr,map,table,n,l,h,f,d)&&v(),Hr(tr,map,table,n,o,f,l,d)&&v(),Hr(tr,map,table,n,o,f,h,d)&&v();for(var m=o;m<f;m++){var w=map.positionAt(m,l,table),x=map.positionAt(m,h,table);tr.replace(tr.mapping.slice(d).map(w+n),tr.mapping.slice(d).map(x+n),new y(r.rows[m-o],0,0))}v(),tr.setSelection(new Ir(tr.doc.resolve(n+map.positionAt(o,l,table)),tr.doc.resolve(n+map.positionAt(f-1,h-1,table)))),e(tr)}_r.prototype.map=function(t){return new _r(t.map(this.anchor),t.map(this.head))},_r.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=t.resolve(this.head);return"row"==e.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&e.index()<e.parent.childCount&&n.index()<n.parent.childCount&&Er(e,n)?new Ir(e,n):r.Selection.near(n,1)};var Yr=Object(Mt.a)({ArrowLeft:Gr("horiz",-1),ArrowRight:Gr("horiz",1),ArrowUp:Gr("vert",-1),ArrowDown:Gr("vert",1),"Shift-ArrowLeft":Zr("horiz",-1),"Shift-ArrowRight":Zr("horiz",1),"Shift-ArrowUp":Zr("vert",-1),"Shift-ArrowDown":Zr("vert",1),Backspace:Qr,"Mod-Backspace":Qr,Delete:Qr,"Mod-Delete":Qr});function Xr(t,e,n){return!n.eq(t.selection)&&(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function Gr(t,e){return function(n,o,view){var c=n.selection;if(c instanceof Ir)return Xr(n,o,r.Selection.near(c.$headCell,e));if("horiz"!=t&&!c.empty)return!1;var l=ro(view,t,e);if(null==l)return!1;if("horiz"==t)return Xr(n,o,r.Selection.near(n.doc.resolve(c.head+e),e));var h,f=n.doc.resolve(l),d=Rr(f,t,e);return h=d?r.Selection.near(d,1):e<0?r.Selection.near(n.doc.resolve(f.before(-1)),-1):r.Selection.near(n.doc.resolve(f.after(-1)),1),Xr(n,o,h)}}function Zr(t,e){return function(n,r,view){var o=n.selection;if(!(o instanceof Ir)){var c=ro(view,t,e);if(null==c)return!1;o=new Ir(n.doc.resolve(c))}var l=Rr(o.$headCell,t,e);return!!l&&Xr(n,r,new Ir(o.$anchorCell,l))}}function Qr(t,e){var n=t.selection;if(!(n instanceof Ir))return!1;if(e){var tr=t.tr,r=$r(t.schema).cell.createAndFill().content;n.forEachCell((function(t,e){t.content.eq(r)||tr.replace(tr.mapping.map(e+1),tr.mapping.map(e+t.nodeSize-1),new y(r,0,0))})),tr.docChanged&&e(tr)}return!0}function to(view,t){var e=kr(view.state.doc.resolve(t));return!!e&&(view.dispatch(view.state.tr.setSelection(new Ir(e))),!0)}function eo(view,t,e){if(!Or(view.state))return!1;var n=qr(e),r=view.state.selection;if(r instanceof Ir){n||(n={width:1,height:1,rows:[c.from(Ur($r(view.state.schema).cell,e))]});var table=r.$anchorCell.node(-1),o=r.$anchorCell.start(-1),rect=xr.get(table).rectBetween(r.$anchorCell.pos-o,r.$headCell.pos-o);return n=Wr(n,rect.right-rect.left,rect.bottom-rect.top),Kr(view.state,view.dispatch,o,rect,n),!0}if(n){var l=Mr(view.state),h=l.start(-1);return Kr(view.state,view.dispatch,h,xr.get(l.node(-1)).findCell(l.pos-h),n),!0}return!1}function no(view,t){if(!t.ctrlKey&&!t.metaKey){var e,n=oo(view,t.target);if(t.shiftKey&&view.state.selection instanceof Ir)r(view.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&n&&null!=(e=kr(view.state.selection.$anchor))&&io(view,t).pos!=e.pos)r(e,t),t.preventDefault();else if(!n)return;view.root.addEventListener("mouseup",o),view.root.addEventListener("dragstart",o),view.root.addEventListener("mousemove",c)}function r(t,e){var n=io(view,e),r=null==Sr.getState(view.state);if(!n||!Er(t,n)){if(!r)return;n=t}var o=new Ir(t,n);if(r||!view.state.selection.eq(o)){var tr=view.state.tr.setSelection(o);r&&tr.setMeta(Sr,t.pos),view.dispatch(tr)}}function o(){view.root.removeEventListener("mouseup",o),view.root.removeEventListener("dragstart",o),view.root.removeEventListener("mousemove",c),null!=Sr.getState(view.state)&&view.dispatch(view.state.tr.setMeta(Sr,-1))}function c(e){var c,l=Sr.getState(view.state);if(null!=l)c=view.state.doc.resolve(l);else if(oo(view,e.target)!=n&&!(c=io(view,t)))return o();c&&r(c,e)}}function ro(view,t,e){if(!(view.state.selection instanceof r.TextSelection))return null;for(var n=view.state.selection.$head,o=n.depth-1;o>=0;o--){var c=n.node(o);if((e<0?n.index(o):n.indexAfter(o))!=(e<0?0:c.childCount))return null;if("cell"==c.type.spec.tableRole||"header_cell"==c.type.spec.tableRole){var l=n.before(o),h="vert"==t?e>0?"down":"up":e>0?"right":"left";return view.endOfTextblock(h)?l:null}}return null}function oo(view,t){for(;t&&t!=view.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function io(view,t){var e=view.posAtCoords({left:t.clientX,top:t.clientY});return e&&e?kr(view.state.doc.resolve(e.pos)):null}var so=new r.PluginKey("fix-tables");function ao(t,e){var tr,n=function(e,n){"table"==e.type.spec.tableRole&&(tr=function(t,table,e,tr){var map=xr.get(table);if(!map.problems)return tr;tr||(tr=t.tr);for(var n,r,o=[],i=0;i<map.height;i++)o.push(0);for(var c=0;c<map.problems.length;c++){var l=map.problems[c];if("collision"==l.type){for(var h=table.nodeAt(l.pos),f=0;f<h.attrs.rowspan;f++)o[l.row+f]+=l.n;tr.setNodeMarkup(tr.mapping.map(e+1+l.pos),null,Br(h.attrs,h.attrs.colspan-l.n,l.n))}else if("missing"==l.type)o[l.row]+=l.n;else if("overlong_rowspan"==l.type){var d=table.nodeAt(l.pos);tr.setNodeMarkup(tr.mapping.map(e+1+l.pos),null,Pr(d.attrs,"rowspan",d.attrs.rowspan-l.n))}else if("colwidth mismatch"==l.type){var v=table.nodeAt(l.pos);tr.setNodeMarkup(tr.mapping.map(e+1+l.pos),null,Pr(v.attrs,"colwidth",l.colwidth))}}for(var m=0;m<o.length;m++)o[m]&&(null==n&&(n=m),r=m);for(var y=0,w=e+1;y<map.height;y++){var x=table.child(y),C=w+x.nodeSize,S=o[y];if(S>0){var k="cell";x.firstChild&&(k=x.firstChild.type.spec.tableRole);for(var O=[],M=0;M<S;M++)O.push($r(t.schema)[k].createAndFill());var N=0!=y&&n!=y-1||r!=y?C-1:w+1;tr.insert(tr.mapping.map(N),O)}w=C}return tr.setMeta(so,{fixTables:!0})}(t,e,n,tr))};return e?e.doc!=t.doc&&function t(e,n,r,o){var c=e.childCount,l=n.childCount;t:for(var i=0,h=0;i<l;i++){for(var f=n.child(i),d=h,v=Math.min(c,i+3);d<v;d++)if(e.child(d)==f){h=d+1,r+=f.nodeSize;continue t}o(f,r),h<c&&e.child(h).sameMarkup(f)?t(e.child(h),f,r+1,o):f.nodesBetween(0,f.content.size,o,r+1),r+=f.nodeSize}}(e.doc,t.doc,0,n):t.doc.descendants(n),tr}function co(t){var rect,e=t.selection,n=Mr(t),table=n.node(-1),r=n.start(-1),map=xr.get(table);return(rect=e instanceof Ir?map.rectBetween(e.$anchorCell.pos-r,e.$headCell.pos-r):map.findCell(n.pos-r)).tableStart=r,rect.map=map,rect.table=table,rect}function uo(tr,t,col){var map=t.map,e=t.tableStart,table=t.table,n=col>0?-1:0;(function(map,table,col){for(var t=$r(table.type.schema).header_cell,e=0;e<map.height;e++)if(table.nodeAt(map.map[col+e*map.width]).type!=t)return!1;return!0})(map,table,col+n)&&(n=0==col||col==map.width?null:0);for(var r=0;r<map.height;r++){var o=r*map.width+col;if(col>0&&col<map.width&&map.map[o-1]==map.map[o]){var c=map.map[o],l=table.nodeAt(c);tr.setNodeMarkup(tr.mapping.map(e+c),null,Fr(l.attrs,col-map.colCount(c))),r+=l.attrs.rowspan-1}else{var h=null==n?$r(table.type.schema).cell:table.nodeAt(map.map[o+n]).type,f=map.positionAt(r,col,table);tr.insert(tr.mapping.map(e+f),h.createAndFill())}}return tr}function lo(t,e){if(!Or(t))return!1;if(e){var rect=co(t);e(uo(t.tr,rect,rect.left))}return!0}function ho(t,e){if(!Or(t))return!1;if(e){var rect=co(t);e(uo(t.tr,rect,rect.right))}return!0}function fo(tr,t,col){for(var map=t.map,table=t.table,e=t.tableStart,n=tr.mapping.maps.length,r=0;r<map.height;){var o=r*map.width+col,c=map.map[o],l=table.nodeAt(c);if(col>0&&map.map[o-1]==c||col<map.width-1&&map.map[o+1]==c)tr.setNodeMarkup(tr.mapping.slice(n).map(e+c),null,Br(l.attrs,col-map.colCount(c)));else{var h=tr.mapping.slice(n).map(e+c);tr.delete(h,h+l.nodeSize)}r+=l.attrs.rowspan}}function po(t,e){if(!Or(t))return!1;if(e){var rect=co(t),tr=t.tr;if(0==rect.left&&rect.right==rect.map.width)return!1;for(var i=rect.right-1;fo(tr,rect,i),i!=rect.left;i--)rect.table=rect.tableStart?tr.doc.nodeAt(rect.tableStart-1):tr.doc,rect.map=xr.get(rect.table);e(tr)}return!0}function vo(map,table,t){for(var e=$r(table.type.schema).header_cell,col=0;col<map.width;col++)if(table.nodeAt(map.map[col+t*map.width]).type!=e)return!1;return!0}function mo(tr,t,e){for(var map=t.map,n=t.tableStart,table=t.table,r=n,i=0;i<e;i++)r+=table.child(i).nodeSize;var o=[],c=e>0?-1:0;vo(map,table,e+c)&&(c=0==e||e==map.height?null:0);for(var col=0,l=map.width*e;col<map.width;col++,l++)if(e>0&&e<map.height&&map.map[l]==map.map[l-map.width]){var h=map.map[l],f=table.nodeAt(h).attrs;tr.setNodeMarkup(n+h,null,Pr(f,"rowspan",f.rowspan+1)),col+=f.colspan-1}else{var d=null==c?$r(table.type.schema).cell:table.nodeAt(map.map[l+c*map.width]).type;o.push(d.createAndFill())}return tr.insert(r,$r(table.type.schema).row.create(null,o)),tr}function go(t,e){if(!Or(t))return!1;if(e){var rect=co(t);e(mo(t.tr,rect,rect.top))}return!0}function yo(t,e){if(!Or(t))return!1;if(e){var rect=co(t);e(mo(t.tr,rect,rect.bottom))}return!0}function bo(tr,t,e){for(var map=t.map,table=t.table,n=t.tableStart,r=0,i=0;i<e;i++)r+=table.child(i).nodeSize;var o=r+table.child(e).nodeSize,c=tr.mapping.maps.length;tr.delete(r+n,o+n);for(var col=0,l=e*map.width;col<map.width;col++,l++){var h=map.map[l];if(e>0&&h==map.map[l-map.width]){var f=table.nodeAt(h).attrs;tr.setNodeMarkup(tr.mapping.slice(c).map(h+n),null,Pr(f,"rowspan",f.rowspan-1)),col+=f.colspan-1}else if(e<map.width&&h==map.map[l+map.width]){var d=table.nodeAt(h),v=d.type.create(Pr(d.attrs,"rowspan",d.attrs.rowspan-1),d.content),m=map.positionAt(e+1,col,table);tr.insert(tr.mapping.slice(c).map(n+m),v),col+=d.attrs.colspan-1}}}function wo(t,e){if(!Or(t))return!1;if(e){var rect=co(t),tr=t.tr;if(0==rect.top&&rect.bottom==rect.map.height)return!1;for(var i=rect.bottom-1;bo(tr,rect,i),i!=rect.top;i--)rect.table=rect.tableStart?tr.doc.nodeAt(rect.tableStart-1):tr.doc,rect.map=xr.get(rect.table);e(tr)}return!0}function xo(t){var e=t.content;return 1==e.childCount&&e.firstChild.isTextblock&&0==e.firstChild.childCount}function Co(t,e){var n=t.selection;if(!(n instanceof Ir)||n.$anchorCell.pos==n.$headCell.pos)return!1;var rect=co(t),map=rect.map;if(function(t,rect){for(var e=t.width,n=t.height,map=t.map,r=rect.top*e+rect.left,o=r,c=(rect.bottom-1)*e+rect.left,l=r+(rect.right-rect.left-1),i=rect.top;i<rect.bottom;i++){if(rect.left>0&&map[o]==map[o-1]||rect.right<e&&map[l]==map[l+1])return!0;o+=e,l+=e}for(var h=rect.left;h<rect.right;h++){if(rect.top>0&&map[r]==map[r-e]||rect.bottom<n&&map[c]==map[c+e])return!0;r++,c++}return!1}(map,rect))return!1;if(e){for(var r,o,tr=t.tr,l={},content=c.empty,h=rect.top;h<rect.bottom;h++)for(var col=rect.left;col<rect.right;col++){var f=map.map[h*map.width+col],d=rect.table.nodeAt(f);if(!l[f])if(l[f]=!0,null==r)r=f,o=d;else{xo(d)||(content=content.append(d.content));var v=tr.mapping.map(f+rect.tableStart);tr.delete(v,v+d.nodeSize)}}if(tr.setNodeMarkup(r+rect.tableStart,null,Pr(Fr(o.attrs,o.attrs.colspan,rect.right-rect.left-o.attrs.colspan),"rowspan",rect.bottom-rect.top)),content.size){var m=r+1+o.content.size,y=xo(o)?r+1:m;tr.replaceWith(y+rect.tableStart,m+rect.tableStart,content)}tr.setSelection(new Ir(tr.doc.resolve(r+rect.tableStart))),e(tr)}return!0}function So(t,e){var n=$r(t.schema);return ko((function(t){var e=t.node;return n[e.type.spec.tableRole]}))(t,e)}function ko(t){return function(e,n){var r,o,c=e.selection;if(c instanceof Ir){if(c.$anchorCell.pos!=c.$headCell.pos)return!1;r=c.$anchorCell.nodeAfter,o=c.$anchorCell.pos}else{if(!(r=function(t){for(var e=t.depth;e>0;e--){var n=t.node(e).type.spec.tableRole;if("cell"===n||"header_cell"===n)return t.node(e)}return null}(c.$from)))return!1;o=kr(c.$from).pos}if(1==r.attrs.colspan&&1==r.attrs.rowspan)return!1;if(n){var l=r.attrs,h=[],f=l.colwidth;l.rowspan>1&&(l=Pr(l,"rowspan",1)),l.colspan>1&&(l=Pr(l,"colspan",1));for(var d,rect=co(e),tr=e.tr,i=0;i<rect.right-rect.left;i++)h.push(f?Pr(l,"colwidth",f&&f[i]?[f[i]]:null):l);for(var v=rect.top;v<rect.bottom;v++){var m=rect.map.positionAt(v,rect.left,rect.table);v==rect.top&&(m+=r.nodeSize);for(var col=rect.left,y=0;col<rect.right;col++,y++)col==rect.left&&v==rect.top||tr.insert(d=tr.mapping.map(m+rect.tableStart,1),t({node:r,row:v,col:col}).createAndFill(h[y]))}tr.setNodeMarkup(o,t({node:r,row:rect.top,col:rect.left}),h[0]),c instanceof Ir&&tr.setSelection(new Ir(tr.doc.resolve(c.$anchorCell.pos),d&&tr.doc.resolve(d))),n(tr)}return!0}}function Oo(t,e){return function(n,r){if(!Or(n))return!1;var o=Mr(n);if(o.nodeAfter.attrs[t]===e)return!1;if(r){var tr=n.tr;n.selection instanceof Ir?n.selection.forEachCell((function(n,r){n.attrs[t]!==e&&tr.setNodeMarkup(r,null,Pr(n.attrs,t,e))})):tr.setNodeMarkup(o.pos,null,Pr(o.nodeAfter.attrs,t,e)),r(tr)}return!0}}function Mo(t,rect,e){for(var n=rect.map.cellsInRect({left:0,top:0,right:"row"==t?rect.map.width:1,bottom:"column"==t?rect.map.height:1}),i=0;i<n.length;i++){var r=rect.table.nodeAt(n[i]);if(r&&r.type!==e.header_cell)return!1}return!0}function No(t,e){return(e=e||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t){return function(e,n){if(!Or(e))return!1;if(n){for(var r=$r(e.schema),rect=co(e),tr=e.tr,o=rect.map.cellsInRect("column"==t?new wr(rect.left,0,rect.right,rect.map.height):"row"==t?new wr(0,rect.top,rect.map.width,rect.bottom):rect),c=o.map((function(t){return rect.table.nodeAt(t)})),i=0;i<o.length;i++)c[i].type==r.header_cell&&tr.setNodeMarkup(rect.tableStart+o[i],r.cell,c[i].attrs);if(0==tr.steps.length)for(var l=0;l<o.length;l++)tr.setNodeMarkup(rect.tableStart+o[l],r.header_cell,c[l].attrs);n(tr)}return!0}}(t):function(e,n){if(!Or(e))return!1;if(n){var r=$r(e.schema),rect=co(e),tr=e.tr,o=Mo("row",rect,r),c=Mo("column",rect,r),l=("column"===t?o:"row"===t&&c)?1:0,h="column"==t?new wr(0,l,1,rect.map.height):"row"==t?new wr(l,0,rect.map.width,1):rect,f="column"==t?c?r.cell:r.header_cell:"row"==t?o?r.cell:r.header_cell:r.cell;rect.map.cellsInRect(h).forEach((function(t){var e=t+rect.tableStart,n=tr.doc.nodeAt(e);n&&tr.setNodeMarkup(e,f,n.attrs)})),n(tr)}return!0}}var Ao=No("row",{useDeprecatedLogic:!0}),Eo=No("column",{useDeprecatedLogic:!0}),To=No("cell",{useDeprecatedLogic:!0});function Do(t){return function(e,n){if(!Or(e))return!1;var o=function(t,e){if(e<0){var n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(var r=t.index(-1)-1,o=t.before();r>=0;r--){var c=t.node(-1).child(r);if(c.childCount)return o-1-c.lastChild.nodeSize;o-=c.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;for(var table=t.node(-1),l=t.indexAfter(-1),h=t.after();l<table.childCount;l++){var f=table.child(l);if(f.childCount)return h+1;h+=f.nodeSize}}}(Mr(e),t);if(null!=o){if(n){var c=e.doc.resolve(o);n(e.tr.setSelection(r.TextSelection.between(c,Ar(c))).scrollIntoView())}return!0}}}function Ro(t,e){for(var n=t.selection.$anchor,r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}var Po=function(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Bo(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function Bo(t,colgroup,table,e,n,r){for(var o=0,c=!0,l=colgroup.firstChild,h=t.firstChild,i=0,col=0;i<h.childCount;i++)for(var f=h.child(i).attrs,d=f.colspan,v=f.colwidth,m=0;m<d;m++,col++){var y=n==col?r:v&&v[m],w=y?y+"px":"";o+=y||e,y||(c=!1),l?(l.style.width!=w&&(l.style.width=w),l=l.nextSibling):colgroup.appendChild(document.createElement("col")).style.width=w}for(;l;){var x=l.nextSibling;l.parentNode.removeChild(l),l=x}c?(table.style.width=o+"px",table.style.minWidth=""):(table.style.width="",table.style.minWidth=o+"px")}Po.prototype.update=function(t){return t.type==this.node.type&&(this.node=t,Bo(t,this.colgroup,this.table,this.cellMinWidth),!0)},Po.prototype.ignoreMutation=function(t){return"attributes"==t.type&&(t.target==this.table||this.colgroup.contains(t.target))};var Fo=new r.PluginKey("tableColumnResizing");function Io(t){void 0===t&&(t={});var e=t.handleWidth;void 0===e&&(e=5);var n=t.cellMinWidth;void 0===n&&(n=25);var o=t.View;void 0===o&&(o=Po);var c=t.lastColumnResizable;return void 0===c&&(c=!0),new r.Plugin({key:Fo,state:{init:function(t,e){return this.spec.props.nodeViews[$r(e.schema).table.name]=function(t,view){return new o(t,n,view)},new _o(-1,!1)},apply:function(tr,t){return t.apply(tr)}},props:{attributes:function(t){return Fo.getState(t).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(view,t){!function(view,t,e,n,r){var o=Fo.getState(view.state);if(!o.dragging){var c=function(t){for(;t&&"TD"!=t.nodeName&&"TH"!=t.nodeName;)t=t.classList.contains("ProseMirror")?null:t.parentNode;return t}(t.target),l=-1;if(c){var h=c.getBoundingClientRect(),f=h.left,d=h.right;t.clientX-f<=e?l=zo(view,t,"left"):d-t.clientX<=e&&(l=zo(view,t,"right"))}if(l!=o.activeHandle){if(!r&&-1!==l){var v=view.state.doc.resolve(l),table=v.node(-1),map=xr.get(table),m=v.start(-1);if(map.colCount(v.pos-m)+v.nodeAfter.attrs.colspan-1==map.width-1)return}jo(view,l)}}}(view,t,e,0,c)},mouseleave:function(view){!function(view){var t=Fo.getState(view.state);t.activeHandle>-1&&!t.dragging&&jo(view,-1)}(view)},mousedown:function(view,t){!function(view,t,e){var n=Fo.getState(view.state);if(-1==n.activeHandle||n.dragging)return!1;var r=view.state.doc.nodeAt(n.activeHandle),o=function(view,t,e){var n=e.colspan,r=e.colwidth,o=r&&r[r.length-1];if(o)return o;var c=view.domAtPos(t),l=c.node.childNodes[c.offset].offsetWidth,h=n;if(r)for(var i=0;i<n;i++)r[i]&&(l-=r[i],h--);return l/h}(view,n.activeHandle,r.attrs);function c(t){window.removeEventListener("mouseup",c),window.removeEventListener("mousemove",l);var n=Fo.getState(view.state);n.dragging&&(!function(view,t,e){for(var n=view.state.doc.resolve(t),table=n.node(-1),map=xr.get(table),r=n.start(-1),col=map.colCount(n.pos-r)+n.nodeAfter.attrs.colspan-1,tr=view.state.tr,o=0;o<map.height;o++){var c=o*map.width+col;if(!o||map.map[c]!=map.map[c-map.width]){var l=map.map[c],h=table.nodeAt(l).attrs,f=1==h.colspan?0:col-map.colCount(l);if(!h.colwidth||h.colwidth[f]!=e){var d=h.colwidth?h.colwidth.slice():Vo(h.colspan);d[f]=e,tr.setNodeMarkup(r+l,null,Pr(h,"colwidth",d))}}}tr.docChanged&&view.dispatch(tr)}(view,n.activeHandle,Lo(n.dragging,t,e)),view.dispatch(view.state.tr.setMeta(Fo,{setDragging:null})))}function l(t){if(!t.which)return c(t);var n=Fo.getState(view.state),r=Lo(n.dragging,t,e);!function(view,t,e,n){var r=view.state.doc.resolve(t),table=r.node(-1),o=r.start(-1),col=xr.get(table).colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,c=view.domAtPos(r.start(-1)).node;for(;"TABLE"!=c.nodeName;)c=c.parentNode;Bo(table,c.firstChild,c,n,col,e)}(view,n.activeHandle,r,e)}view.dispatch(view.state.tr.setMeta(Fo,{setDragging:{startX:t.clientX,startWidth:o}})),window.addEventListener("mouseup",c),window.addEventListener("mousemove",l),t.preventDefault()}(view,t,n)}},decorations:function(t){var e=Fo.getState(t);if(e.activeHandle>-1)return function(t,e){for(var n=[],r=t.doc.resolve(e),table=r.node(-1),map=xr.get(table),o=r.start(-1),col=map.colCount(r.pos-o)+r.nodeAfter.attrs.colspan,c=0;c<map.height;c++){var l=col+c*map.width-1;if(!(col!=map.width&&map.map[l]==map.map[l+1]||0!=c&&map.map[l-1]==map.map[l-1-map.width])){var h=map.map[l],f=o+h+table.nodeAt(h).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",n.push(Un.widget(f,d))}}return Kn.create(t.doc,n)}(t,e.activeHandle)},nodeViews:{}}})}var _o=function(t,e){this.activeHandle=t,this.dragging=e};function zo(view,t,e){var n=view.posAtCoords({left:t.clientX,top:t.clientY}).pos,r=kr(view.state.doc.resolve(n));if(!r)return-1;if("right"==e)return r.pos;var map=xr.get(r.node(-1)),o=r.start(-1),c=map.map.indexOf(r.pos-o);return c%map.width==0?-1:o+map.map[c-1]}function Lo(t,e,n){var r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function jo(view,t){view.dispatch(view.state.tr.setMeta(Fo,{setHandle:t}))}function Vo(t){for(var e=[],i=0;i<t;i++)e.push(0);return e}function $o(t){void 0===t&&(t={});var e=t.allowTableNodeSelection;return void 0===e&&(e=!1),new r.Plugin({key:Sr,state:{init:function(){return null},apply:function(tr,t){var e=tr.getMeta(Sr);if(null!=e)return-1==e?null:e;if(null==t||!tr.docChanged)return t;var n=tr.mapping.mapResult(t),r=n.deleted,o=n.pos;return r?null:o}},props:{decorations:zr,handleDOMEvents:{mousedown:no},createSelectionBetween:function(view){if(null!=Sr.getState(view.state))return view.state.selection},handleTripleClick:to,handleKeyDown:Yr,handlePaste:eo},appendTransaction:function(t,n,o){return function(t,tr,e){var n,o,c=(tr||t).selection,l=(tr||t).doc;if(c instanceof r.NodeSelection&&(o=c.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)n=Ir.create(l,c.from);else if("row"==o){var h=l.resolve(c.from+1);n=Ir.rowSelection(h,h)}else if(!e){var map=xr.get(c.node),f=c.from+1,d=f+map.map[map.width*map.height-1];n=Ir.create(l,f+1,d)}}else c instanceof r.TextSelection&&function(t){var e=t.$from,n=t.$to;if(e.pos==n.pos||e.pos<e.pos-6)return!1;for(var r=e.pos,o=n.pos,c=e.depth;c>=0&&!(e.after(c+1)<e.end(c));c--,r++);for(var l=n.depth;l>=0&&!(n.before(l+1)>n.start(l));l--,o--);return r==o&&/row|table/.test(e.node(c).type.spec.tableRole)}(c)?n=r.TextSelection.create(l,c.from):c instanceof r.TextSelection&&function(t){for(var e,n,r=t.$from,o=t.$to,i=r.depth;i>0;i--){var c=r.node(i);if("cell"===c.type.spec.tableRole||"header_cell"===c.type.spec.tableRole){e=c;break}}for(var l=o.depth;l>0;l--){var h=o.node(l);if("cell"===h.type.spec.tableRole||"header_cell"===h.type.spec.tableRole){n=h;break}}return e!==n&&0===o.parentOffset}(c)&&(n=r.TextSelection.create(l,c.$from.start(),c.$from.end()));return n&&(tr||(tr=t.tr)).setSelection(n),tr}(o,ao(o,n),e)}})}_o.prototype.apply=function(tr){var t=this,e=tr.getMeta(Fo);if(e&&null!=e.setHandle)return new _o(e.setHandle,null);if(e&&void 0!==e.setDragging)return new _o(t.activeHandle,e.setDragging);if(t.activeHandle>-1&&tr.docChanged){var n=tr.mapping.map(t.activeHandle,-1);Nr(tr.doc.resolve(n))||(n=null),t=new _o(n,t.dragging)}return t}},235:function(t,e,n){var r=n(236),o=n(198),c=n(210),l=n(189)("socket.io-client");t.exports=e=f;var h=e.managers={};function f(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,o=r(t),source=o.source,f=o.id,path=o.path,d=h[f]&&path in h[f].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||d?(l("ignoring socket cache for %s",source),n=c(source,e)):(h[f]||(l("new io instance for %s",source),h[f]=c(source,e)),n=h[f]),o.query&&!e.query&&(e.query=o.query),n.socket(o.path,e)}e.protocol=o.protocol,e.connect=f,e.Manager=n(210),e.Socket=n(216)},236:function(t,e,n){var r=n(207),o=n(189)("socket.io-client:url");t.exports=function(t,e){var n=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(o("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),o("parse %s",t),n=r(t));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var c=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+c+":"+n.port,n.href=n.protocol+"://"+c+(e&&e.port===n.port?"":":"+n.port),n}},237:function(t,e,n){t.exports=function(t){function e(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){let n;function l(...t){if(!l.enabled)return;const e=l,o=Number(new Date),c=o-(n||o);e.diff=c,e.prev=n,e.curr=o,n=o,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let h=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;h++;const c=r.formatters[o];if("function"==typeof c){const r=t[h];n=c.call(e,r),t.splice(h,1),h--}return n}),r.formatArgs.call(e,t),(e.log||r.log).apply(e,t)}return l.namespace=t,l.enabled=r.enabled(t),l.useColors=r.useColors(),l.color=e(t),l.destroy=o,l.extend=c,"function"==typeof r.init&&r.init(l),r.instances.push(l),l}function o(){const t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function c(t,e){const n=r(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function l(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},r.disable=function(){const t=[...r.names.map(l),...r.skips.map(l).map(t=>"-"+t)].join(",");return r.enable(""),t},r.enable=function(t){let i;r.save(t),r.names=[],r.skips=[];const e=("string"==typeof t?t:"").split(/[\s,]+/),n=e.length;for(i=0;i<n;i++)e[i]&&("-"===(t=e[i].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(i=0;i<r.instances.length;i++){const t=r.instances[i];t.enabled=r.enabled(t.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;let i,e;for(i=0,e=r.skips.length;i<e;i++)if(r.skips[i].test(t))return!1;for(i=0,e=r.names.length;i<e;i++)if(r.names[i].test(t))return!0;return!1},r.humanize=n(238),Object.keys(t).forEach(e=>{r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},238:function(t,e){var s=1e3,n=60*s,r=60*n,o=24*r,c=7*o,l=365.25*o;function h(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,e){e=e||{};var f=typeof t;if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var h=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return h*l;case"weeks":case"week":case"w":return h*c;case"days":case"day":case"d":return h*o;case"hours":case"hour":case"hrs":case"hr":case"h":return h*r;case"minutes":case"minute":case"mins":case"min":case"m":return h*n;case"seconds":case"second":case"secs":case"sec":case"s":return h*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}(t);if("number"===f&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=o)return h(t,e,o,"day");if(e>=r)return h(t,e,r,"hour");if(e>=n)return h(t,e,n,"minute");if(e>=s)return h(t,e,s,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=o)return Math.round(t/o)+"d";if(e>=r)return Math.round(t/r)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=s)return Math.round(t/s)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},239:function(t,e,n){(function(r){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(240)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var o=0,c=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(o++,"%c"===t&&(c=o))})),t.splice(c,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(82))},240:function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,o=+new Date,c=o-(n||o);t.diff=c,t.prev=n,t.curr=o,n=o;for(var l=new Array(arguments.length),i=0;i<l.length;i++)l[i]=arguments[i];l[0]=e.coerce(l[0]),"string"!=typeof l[0]&&l.unshift("%O");var h=0;l[0]=l[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;h++;var o=e.formatters[r];if("function"==typeof o){var c=l[h];n=o.call(t,c),l.splice(h,1),h--}return n})),e.formatArgs.call(t,l),(r.log||e.log||console.log.bind(console)).apply(t,l)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),r.destroy=o,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function o(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var i;e.save(t),e.names=[],e.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length;for(i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var o=e.instances[i];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=n(241),e.instances=[],e.names=[],e.skips=[],e.formatters={}},241:function(t,e){var s=1e3,n=60*s,r=60*n,o=24*r,c=365.25*o;function l(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var h,f=typeof t;if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var l=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*c;case"days":case"day":case"d":return l*o;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*n;case"seconds":case"second":case"secs":case"sec":case"s":return l*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(t);if("number"===f&&!1===isNaN(t))return e.long?l(h=t,o,"day")||l(h,r,"hour")||l(h,n,"minute")||l(h,s,"second")||h+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=r)return Math.round(t/r)+"h";if(t>=n)return Math.round(t/n)+"m";if(t>=s)return Math.round(t/s)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},242:function(t,e,n){var r=n(208),o=n(209),c=Object.prototype.toString,l="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===c.call(Blob),h="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===c.call(File);e.deconstructPacket=function(t){var e=[],n=t.data,c=t;return c.data=function t(data,e){if(!data)return data;if(o(data)){var n={_placeholder:!0,num:e.length};return e.push(data),n}if(r(data)){for(var c=new Array(data.length),i=0;i<data.length;i++)c[i]=t(data[i],e);return c}if("object"==typeof data&&!(data instanceof Date)){c={};for(var l in data)c[l]=t(data[l],e);return c}return data}(n,e),c.attachments=e.length,{packet:c,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(data,e){if(!data)return data;if(data&&data._placeholder)return e[data.num];if(r(data))for(var i=0;i<data.length;i++)data[i]=t(data[i],e);else if("object"==typeof data)for(var n in data)data[n]=t(data[n],e);return data}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(data,t){var e=0,n=data;!function c(f,d,v){if(!f)return f;if(l&&f instanceof Blob||h&&f instanceof File){e++;var m=new FileReader;m.onload=function(){v?v[d]=this.result:n=this.result,--e||t(n)},m.readAsArrayBuffer(f)}else if(r(f))for(var i=0;i<f.length;i++)c(f[i],i,f);else if("object"==typeof f&&!o(f))for(var y in f)c(f[y],y,f)}(n),e||t(n)}},243:function(t,e,n){"use strict";e.byteLength=function(t){var e=h(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,i,n=h(t),r=n[0],l=n[1],f=new c(function(t,e,n){return 3*(e+n)/4-n}(0,r,l)),d=0,v=l>0?r-4:r;for(i=0;i<v;i+=4)e=o[t.charCodeAt(i)]<<18|o[t.charCodeAt(i+1)]<<12|o[t.charCodeAt(i+2)]<<6|o[t.charCodeAt(i+3)],f[d++]=e>>16&255,f[d++]=e>>8&255,f[d++]=255&e;2===l&&(e=o[t.charCodeAt(i)]<<2|o[t.charCodeAt(i+1)]>>4,f[d++]=255&e);1===l&&(e=o[t.charCodeAt(i)]<<10|o[t.charCodeAt(i+1)]<<4|o[t.charCodeAt(i+2)]>>2,f[d++]=e>>8&255,f[d++]=255&e);return f},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,c=[],i=0,l=n-o;i<l;i+=16383)c.push(f(t,i,i+16383>l?l:i+16383));1===o?(e=t[n-1],c.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],c.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return c.join("")};for(var r=[],o=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,l=code.length;i<l;++i)r[i]=code[i],o[code.charCodeAt(i)]=i;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t,e,n){for(var o,c,output=[],i=e;i<n;i+=3)o=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),output.push(r[(c=o)>>18&63]+r[c>>12&63]+r[c>>6&63]+r[63&c]);return output.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},244:function(t,e){e.read=function(t,e,n,r,o){var c,l,h=8*o-r-1,f=(1<<h)-1,d=f>>1,v=-7,i=n?o-1:0,m=n?-1:1,s=t[e+i];for(i+=m,c=s&(1<<-v)-1,s>>=-v,v+=h;v>0;c=256*c+t[e+i],i+=m,v-=8);for(l=c&(1<<-v)-1,c>>=-v,v+=r;v>0;l=256*l+t[e+i],i+=m,v-=8);if(0===c)c=1-d;else{if(c===f)return l?NaN:1/0*(s?-1:1);l+=Math.pow(2,r),c-=d}return(s?-1:1)*l*Math.pow(2,c-r)},e.write=function(t,e,n,r,o,c){var l,h,f,d=8*c-o-1,v=(1<<d)-1,m=v>>1,rt=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,i=r?0:c-1,y=r?1:-1,s=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,l=v):(l=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-l))<1&&(l--,f*=2),(e+=l+m>=1?rt/f:rt*Math.pow(2,1-m))*f>=2&&(l++,f/=2),l+m>=v?(h=0,l=v):l+m>=1?(h=(e*f-1)*Math.pow(2,o),l+=m):(h=e*Math.pow(2,m-1)*Math.pow(2,o),l=0));o>=8;t[n+i]=255&h,i+=y,h/=256,o-=8);for(l=l<<o|h,d+=o;d>0;t[n+i]=255&l,i+=y,l/=256,d-=8);t[n+i-y]|=128*s}},245:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},246:function(t,e,n){t.exports=n(247),t.exports.parser=n(187)},247:function(t,e,n){var r=n(211),o=n(186),c=n(192)("engine.io-client:socket"),l=n(215),h=n(187),f=n(207),d=n(190);function v(t,e){if(!(this instanceof v))return new v(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=f(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=f(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=v,v.priorWebsocketSuccess=!1,o(v.prototype),v.protocol=h.protocol,v.Socket=v,v.Transport=n(202),v.transports=n(211),v.parser=n(187),v.prototype.createTransport=function(t){c('creating transport "%s"',t);var e=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.query);e.EIO=h.protocol,e.transport=t;var n=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},v.prototype.open=function(){var t;if(this.rememberUpgrade&&v.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},v.prototype.setTransport=function(t){c("setting transport %s",t.name);var e=this;this.transport&&(c("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},v.prototype.probe=function(t){c('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(c('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(c('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;v.priorWebsocketSuccess="websocket"===e.name,c('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(c("changing transport and sending upgrade packet"),y(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())}))}else{c('probe transport "%s" failed',t);var l=new Error("probe error");l.transport=e.name,r.emit("upgradeError",l)}})))}function l(){n||(n=!0,y(),e.close(),e=null)}function h(n){var o=new Error("probe error: "+n);o.transport=e.name,l(),c('probe transport "%s" failed because of error: %s',t,n),r.emit("upgradeError",o)}function f(){h("transport closed")}function d(){h("socket closed")}function m(t){e&&t.name!==e.name&&(c('"%s" works - aborting "%s"',t.name,e.name),l())}function y(){e.removeListener("open",o),e.removeListener("error",h),e.removeListener("close",f),r.removeListener("close",d),r.removeListener("upgrading",m)}v.priorWebsocketSuccess=!1,e.once("open",o),e.once("error",h),e.once("close",f),this.once("close",d),this.once("upgrading",m),e.open()},v.prototype.onOpen=function(){if(c("socket open"),this.readyState="open",v.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){c("starting upgrade probes");for(var i=0,t=this.upgrades.length;i<t;i++)this.probe(this.upgrades[i])}},v.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(c('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else c('packet received with socket readyState "%s"',this.readyState)},v.prototype.onHandshake=function(data){this.emit("handshake",data),this.id=data.sid,this.transport.query.sid=data.sid,this.upgrades=this.filterUpgrades(data.upgrades),this.pingInterval=data.pingInterval,this.pingTimeout=data.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},v.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},v.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){c("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},v.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},v.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},v.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(c("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},v.prototype.write=v.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},v.prototype.sendPacket=function(t,data,e,n){if("function"==typeof data&&(n=data,data=void 0),"function"==typeof e&&(n=e,e=null),"closing"!==this.readyState&&"closed"!==this.readyState){(e=e||{}).compress=!1!==e.compress;var r={type:t,data:data,options:e};this.emit("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}},v.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}function e(){t.onClose("forced close"),c("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function r(){t.once("upgrade",n),t.once("upgradeError",n)}return this},v.prototype.onError=function(t){c("socket error %j",t),v.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},v.prototype.onClose=function(t,desc){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){c('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,desc),this.writeBuffer=[],this.prevBufferLen=0}},v.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~l(this.transports,t[i])&&e.push(t[i]);return e}},248:function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},249:function(t,e,n){var r=n(200),o=n(212),c=n(186),l=n(191),h=n(192)("engine.io-client:polling-xhr"),f=n(201);function d(){}function v(t){if(o.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}}function m(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(t.exports=v,t.exports.Request=m,l(v,o),v.prototype.supportsBinary=!0,v.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new m(t)},v.prototype.doWrite=function(data,t){var e="string"!=typeof data&&void 0!==data,n=this.request({method:"POST",data:data,isBinary:e}),r=this;n.on("success",t),n.on("error",(function(t){r.onError("xhr post error",t)})),this.sendXhr=n},v.prototype.doPoll=function(){h("xhr poll");var t=this.request(),e=this;t.on("data",(function(data){e.onData(data)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},c(m.prototype),m.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new r(t),n=this;try{h("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.withCredentials),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof e.status?e.status:0)}),0))},h("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){n.onError(t)}),0)}"undefined"!=typeof document&&(this.index=m.requestsCount++,m.requests[this.index]=this)},m.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},m.prototype.onData=function(data){this.emit("data",data),this.onSuccess()},m.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},m.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete m.requests[this.index],this.xhr=null}},m.prototype.onLoad=function(){var data;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(t){}data=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=data&&this.onData(data)},m.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},m.prototype.abort=function(){this.cleanup()},m.requestsCount=0,m.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",y);else if("function"==typeof addEventListener){addEventListener("onpagehide"in f?"pagehide":"unload",y,!1)}function y(){for(var i in m.requests)m.requests.hasOwnProperty(i)&&m.requests[i].abort()}},250:function(t,e){t.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var i in t)n.call(t,i)&&e.push(i);return e}},251:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},252:function(t,e){t.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(t),c=new Uint8Array(n-e),i=e,l=0;i<n;i++,l++)c[l]=o[i];return c.buffer}},253:function(t,e){function n(){}t.exports=function(t,e,r){var o=!1;return r=r||n,c.count=t,0===t?e():c;function c(t,n){if(c.count<=0)throw new Error("after called too many times");--c.count,t?(o=!0,e(t),e=r):0!==c.count||o||e(null,n)}}},254:function(t,e){var n,r,o,c=String.fromCharCode;function l(t){for(var e,n,output=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(n=t.charCodeAt(r++)))?output.push(((1023&e)<<10)+(1023&n)+65536):(output.push(e),r--):output.push(e);return output}function h(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function f(t,e){return c(t>>e&63|128)}function d(t,e){if(0==(4294967168&t))return c(t);var symbol="";return 0==(4294965248&t)?symbol=c(t>>6&31|192):0==(4294901760&t)?(h(t,e)||(t=65533),symbol=c(t>>12&15|224),symbol+=f(t,6)):0==(4292870144&t)&&(symbol=c(t>>18&7|240),symbol+=f(t,12),symbol+=f(t,6)),symbol+=c(63&t|128)}function v(){if(o>=r)throw Error("Invalid byte index");var t=255&n[o];if(o++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function m(t){var e,c;if(o>r)throw Error("Invalid byte index");if(o==r)return!1;if(e=255&n[o],o++,0==(128&e))return e;if(192==(224&e)){if((c=(31&e)<<6|v())>=128)return c;throw Error("Invalid continuation byte")}if(224==(240&e)){if((c=(15&e)<<12|v()<<6|v())>=2048)return h(c,t)?c:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(c=(7&e)<<18|v()<<12|v()<<6|v())>=65536&&c<=1114111)return c;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,e){for(var n=!1!==(e=e||{}).strict,r=l(t),o=r.length,c=-1,h="";++c<o;)h+=d(r[c],n);return h},decode:function(t,e){var h=!1!==(e=e||{}).strict;n=l(t),r=n.length,o=0;for(var f,d=[];!1!==(f=m(h));)d.push(f);return function(t){for(var e,n=t.length,r=-1,output="";++r<n;)(e=t[r])>65535&&(output+=c((e-=65536)>>>10&1023|55296),e=56320|1023&e),output+=c(e);return output}(d)}}},255:function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<t.length;i++)n[t.charCodeAt(i)]=i;e.encode=function(e){var i,n=new Uint8Array(e),r=n.length,o="";for(i=0;i<r;i+=3)o+=t[n[i]>>2],o+=t[(3&n[i])<<4|n[i+1]>>4],o+=t[(15&n[i+1])<<2|n[i+2]>>6],o+=t[63&n[i+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var i,e,r,o,c,l=.75*t.length,h=t.length,p=0;"="===t[t.length-1]&&(l--,"="===t[t.length-2]&&l--);var f=new ArrayBuffer(l),d=new Uint8Array(f);for(i=0;i<h;i+=4)e=n[t.charCodeAt(i)],r=n[t.charCodeAt(i+1)],o=n[t.charCodeAt(i+2)],c=n[t.charCodeAt(i+3)],d[p++]=e<<2|r>>4,d[p++]=(15&r)<<4|o>>2,d[p++]=(3&o)<<6|63&c;return f}}()},256:function(t,e){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),o=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),c=n&&n.prototype.append&&n.prototype.getBlob;function l(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=n.buffer}return e}return t}))}function h(t,e){e=e||{};var r=new n;return l(t).forEach((function(t){r.append(t)})),e.type?r.getBlob(e.type):r.getBlob()}function f(t,e){return new Blob(l(t),e||{})}"undefined"!=typeof Blob&&(h.prototype=Blob.prototype,f.prototype=Blob.prototype),t.exports=r?o?Blob:f:c?h:void 0},257:function(t,e,n){t.exports=function(t){function e(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){let n;function l(...t){if(!l.enabled)return;const e=l,o=Number(new Date),c=o-(n||o);e.diff=c,e.prev=n,e.curr=o,n=o,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let h=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;h++;const c=r.formatters[o];if("function"==typeof c){const r=t[h];n=c.call(e,r),t.splice(h,1),h--}return n}),r.formatArgs.call(e,t),(e.log||r.log).apply(e,t)}return l.namespace=t,l.enabled=r.enabled(t),l.useColors=r.useColors(),l.color=e(t),l.destroy=o,l.extend=c,"function"==typeof r.init&&r.init(l),r.instances.push(l),l}function o(){const t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function c(t,e){const n=r(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function l(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},r.disable=function(){const t=[...r.names.map(l),...r.skips.map(l).map(t=>"-"+t)].join(",");return r.enable(""),t},r.enable=function(t){let i;r.save(t),r.names=[],r.skips=[];const e=("string"==typeof t?t:"").split(/[\s,]+/),n=e.length;for(i=0;i<n;i++)e[i]&&("-"===(t=e[i].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(i=0;i<r.instances.length;i++){const t=r.instances[i];t.enabled=r.enabled(t.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;let i,e;for(i=0,e=r.skips.length;i<e;i++)if(r.skips[i].test(t))return!1;for(i=0,e=r.names.length;i<e;i++)if(r.names[i].test(t))return!0;return!1},r.humanize=n(258),Object.keys(t).forEach(e=>{r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},258:function(t,e){var s=1e3,n=60*s,r=60*n,o=24*r,c=7*o,l=365.25*o;function h(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,e){e=e||{};var f=typeof t;if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var h=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return h*l;case"weeks":case"week":case"w":return h*c;case"days":case"day":case"d":return h*o;case"hours":case"hour":case"hrs":case"hr":case"h":return h*r;case"minutes":case"minute":case"mins":case"min":case"m":return h*n;case"seconds":case"second":case"secs":case"sec":case"s":return h*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}(t);if("number"===f&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=o)return h(t,e,o,"day");if(e>=r)return h(t,e,r,"hour");if(e>=n)return h(t,e,n,"minute");if(e>=s)return h(t,e,s,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=o)return Math.round(t/o)+"d";if(e>=r)return Math.round(t/r)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=s)return Math.round(t/s)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},259:function(t,e,n){var r=n(212),o=n(191),c=n(201);t.exports=v;var l,h=/\n/g,f=/\\n/g;function d(){}function v(t){r.call(this,t),this.query=this.query||{},l||(l=c.___eio=c.___eio||[]),this.index=l.length;var e=this;l.push((function(t){e.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){e.script&&(e.script.onerror=d)}),!1)}o(v,r),v.prototype.supportsBinary=!1,v.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},v.prototype.doPoll=function(){var t=this,script=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.uri(),script.onerror=function(e){t.onError("jsonp poll error",e)};var e=document.getElementsByTagName("script")[0];e?e.parentNode.insertBefore(script,e):(document.head||document.body).appendChild(script),this.script=script,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)}),100)},v.prototype.doWrite=function(data,t){var e=this;if(!this.form){var iframe,form=document.createElement("form"),area=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index;form.className="socketio",form.style.position="absolute",form.style.top="-1000px",form.style.left="-1000px",form.target=n,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}function r(){o(),t()}function o(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(t){e.onError("jsonp polling iframe removal error",t)}try{var html='<iframe src="javascript:0" name="'+e.iframeId+'">';iframe=document.createElement(html)}catch(t){(iframe=document.createElement("iframe")).name=e.iframeId,iframe.src="javascript:0"}iframe.id=e.iframeId,e.form.appendChild(iframe),e.iframe=iframe}this.form.action=this.uri(),o(),data=data.replace(f,"\\\n"),this.area.value=data.replace(h,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===e.iframe.readyState&&r()}:this.iframe.onload=r}},260:function(t,e,n){(function(e){var r,o,c=n(202),l=n(187),h=n(190),f=n(191),d=n(214),v=n(192)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=n(261)}catch(t){}var m=r||o;function y(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=r&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(m=o),c.call(this,t)}t.exports=y,f(y,c),y.prototype.name="websocket",y.prototype.supportsBinary=!0,y.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new m(t,e):new m(t):new m(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},y.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},y.prototype.write=function(t){var n=this;this.writable=!1;for(var r=t.length,i=0,o=r;i<o;i++)!function(t){l.encodePacket(t,n.supportsBinary,(function(data){if(!n.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),n.perMessageDeflate)("string"==typeof data?e.byteLength(data):data.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(data):n.ws.send(data,o)}catch(t){v("websocket closed before onclose event")}--r||c()}))}(t[i]);function c(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},y.prototype.onClose=function(){c.prototype.onClose.call(this)},y.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},y.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=d()),this.supportsBinary||(t.b64=1),(t=h.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},y.prototype.check=function(){return!(!m||"__initialize"in m&&this.name===y.prototype.name)}}).call(this,n(199).Buffer)},262:function(t,e){t.exports=function(t,e){for(var n=[],i=(e=e||0)||0;i<t.length;i++)n[i-e]=t[i];return n}},263:function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},264:function(t,e,n){"use strict";var r=n(265),o=n(266);function c(){}c.prototype=r;var l=new c;t.exports=l,l.highlight=function(t,e,n){var r=(n||{}).prefix;null==r&&(r=d);return B(D(t,e,!0,r))},l.highlightAuto=E,l.registerLanguage=function(t,e){var n=e(l);n.rawDefinition=e.bind(null,l),N[t]=n,M.push(t),n.aliases&&T(t,n.aliases)},l.listLanguages=function(){return M.concat()},l.registerAlias=T,l.getLanguage=F;var h=r.inherit,f={}.hasOwnProperty,d="hljs-",v="case_insensitive",m="cached_variants",y="terminator_end",w=" ",x="|",C="(",S=")",k="\\",O=["of","and","for","in","not","or","if","then"],M=[],N={},A={};function E(t,e){var n,r,c,l,h=e||{},f=h.subset||M,v=h.prefix,m=f.length,y=-1;if(null==v&&(v=d),"string"!=typeof t)throw o("Expected `string` for value, got `%s`",t);for(r=B({}),n=B({});++y<m;)F(l=f[y])&&((c=B(D(l,t,!1,v))).language=l,c.relevance>r.relevance&&(r=c),c.relevance>n.relevance&&(r=n,n=c));return r.language&&(n.secondBest=r),n}function T(t,e){var n,r,o,c,map=t;for(n in e&&((map={})[t]=e),map)for(o=(r="string"==typeof(r=map[n])?[r]:r).length,c=-1;++c<o;)A[r[c]]=n}function D(t,e,n,r,c){var l,h,d,m,O,M,A,T,B={},I={},_=[],z="",L=0;if("string"!=typeof t)throw o("Expected `string` for name, got `%s`",t);if("string"!=typeof e)throw o("Expected `string` for value, got `%s`",e);if(l=F(t),d=h=c||l,m=T=[],!l)throw o("Unknown language: `%s` is not registered",t);!function(t){function e(r,o){r.compiled||(r.compiled=!0,r.keywords=r.keywords||r.beginKeywords,r.keywords&&(r.keywords=function(t,e){var n,r={};if("string"==typeof t)o("keyword",t);else for(n in t)o(n,t[n]);return r;function o(t,n){!function(t,e){var n,o=e.length,c=-1;for(;++c<o;)n=e[c].split(x),r[n[0]]=[t,Number(n[1])||R(n[0])?0:1]}(t,(e?n.toLowerCase():n).split(w))}}(r.keywords,t[v])),r.lexemesRe=n(r.lexemes||/\w+/,!0),o&&(r.beginKeywords&&(r.begin="\\b("+r.beginKeywords.split(w).join(x)+")\\b"),r.begin||(r.begin=/\B|\b/),r.beginRe=n(r.begin),r.endSameAsBegin&&(r.end=r.begin),r.end||r.endsWithParent||(r.end=/\B|\b/),r.end&&(r.endRe=n(r.end)),r[y]=source(r.end)||"",r.endsWithParent&&o[y]&&(r[y]+=(r.end?x:"")+o[y])),r.illegal&&(r.illegalRe=n(r.illegal)),void 0===r.relevance&&(r.relevance=1),r.contains=function(t,n){var r,o=[],c=t.length,l=-1;for(;++l<c;)r=t[l],o=o.concat(P("self"===r?n:r));c=o.length,l=-1;for(;++l<c;)e(o[l],n);return o}(r.contains||[],r),r.starts&&e(r.starts,o),r.terminators=function(t){var e,r,o={},c=[],l={},h=1,f=t.contains,d=f.length,v=-1,m=[];for(;++v<d;)w(r=f[v],r.beginKeywords?"\\.?(?:"+r.begin+")\\.?":r.begin);t[y]&&w("end",t[y]);t.illegal&&w("illegal",t.illegal);d=c.length,v=-1;for(;++v<d;)m[v]=c[v][1];return e=n(function(t,e){var n,r,o,c,l=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9]\d*)|\\./,h=0,f="",d=t.length,v=-1;for(;++v<d;){for(n=t[v],o=source(n),r=h+=1,0!==v&&(f+=e),f+=C;o.length>0;){if(null===(c=l.exec(o))){f+=o;break}f+=o.slice(0,c.index),o=o.slice(c.index+c[0].length),c[0][0]===k&&c[1]?f+=k+String(Number(c[1])+r):(f+=c[0],c[0]===C&&h++)}f+=S}return f}(m,x),!0),l={lastIndex:0,exec:function(n){var r,h,f,d;if(0===c.length)return null;if(e.lastIndex=l.lastIndex,!(d=e.exec(n)))return null;r=d.length,h=-1;for(;++h<r;)if(void 0!==d[h]&&void 0!==o[h]){f=o[h];break}"string"==typeof f?(d.type=f,d.extra=[t.illegal,t.terminator_end]):(d.type="begin",d.rule=f);return d}};function w(t,e){o[h]=t,c.push([t,e]),h+=new RegExp(e.toString()+x).exec("").length}}(r))}function n(e,n){return new RegExp(source(e),"m"+(t[v]?"i":"")+(n?"g":""))}function source(t){return t&&t.source||t}e(t)}(l);try{for(h.terminators.lastIndex=0,O=0,A=h.terminators.exec(e);A;)M=$(e.slice(O,A.index),A),O=A.index+M,h.terminators.lastIndex=O,A=h.terminators.exec(e);for($(e.slice(O)),d=h;d.parent;)d.className&&G(),d=d.parent;return{relevance:L,value:m,illegal:!1,language:t,top:h}}catch(t){if(-1===t.message.indexOf("Illegal"))throw t;return{relevance:0,illegal:!0,value:H(e,[])}}function j(t){var e=t[0],n=t.rule;return n&&n.endSameAsBegin&&(n.endRe=function(t){return new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(e)),n.skip?z+=e:(n.excludeBegin&&(z+=e),J(W(),m),n.returnBegin||n.excludeBegin||(z=e)),U(n),n.returnBegin?0:e.length}function V(t){var n=t[0],r=e.slice(t.index),o=function t(e,n){if(function(t,e){var n=t&&t.exec(e);return n&&0===n.index}(e.endRe,n)){for(;e.endsParent&&e.parent;)e=e.parent;return e}if(e.endsWithParent)return t(e.parent,n)}(h,r);if(o){var c=h;c.skip?z+=n:(c.returnEnd||c.excludeEnd||(z+=n),J(W(),m),c.excludeEnd&&(z=n));do{h.className&&G(),h.skip||h.subLanguage||(L+=h.relevance),h=h.parent}while(h!==o.parent);return o.starts&&(o.endSameAsBegin&&(o.starts.endRe=o.endRe),U(o.starts)),c.returnEnd?0:n.length}}function $(t,r){var c,l=r&&r[0];if(z+=t,void 0===l)return J(W(),m),0;if("begin"===B.type&&"end"===r.type&&B.index===r.index&&""===l)return z+=e.slice(r.index,r.index+1),1;if(B=r,"begin"===r.type)return j(r);if("end"===r.type&&void 0!==(c=V(r)))return c;if("illegal"===r.type&&!n)throw o('Illegal lexeme "%s" for mode "%s"',l,h.className||"<unnamed>");return z+=l,l.length}function U(t){var e;t.className&&(e=Y(t.className,[])),e&&(m.push(e),_.push(m),m=e.children),h=Object.create(t,{parent:{value:h}})}function W(){var t=h.subLanguage?function(){var t,e="string"==typeof h.subLanguage;if(e&&!N[h.subLanguage])return H(z,[]);t=e?D(h.subLanguage,z,!0,r,I[h.subLanguage]):E(z,{subset:0===h.subLanguage.length?void 0:h.subLanguage,prefix:r});if(!t.language)return[K(z)];h.relevance>0&&(L+=t.relevance);e&&(I[h.subLanguage]=t.top);return[Y(t.language,t.value,!0)]}():function(){var t,e,n,r,o=[];if(!h.keywords)return H(z,o);t=0,h.lexemesRe.lastIndex=0,e=h.lexemesRe.exec(z);for(;e;)H(z.slice(t,e.index),o),(r=X(h,e))?(L+=r[1],n=Y(r[0],[]),o.push(n),H(e[0],n.children)):H(e[0],o),t=h.lexemesRe.lastIndex,e=h.lexemesRe.exec(z);return H(z.slice(t),o),o}();return z="",t}function J(t,e){for(var n,r=t.length,o=-1;++o<r;)"text"===(n=t[o]).type?H(n.value,e):e.push(n)}function H(t,e){var n;return t&&((n=e[e.length-1])&&"text"===n.type?n.value+=t:e.push(K(t))),e}function K(t){return{type:"text",value:t}}function Y(t,e,n){return{type:"element",tagName:"span",properties:{className:[(n?"":r)+t]},children:e}}function X(t,e){var n=e[0];return l[v]&&(n=n.toLowerCase()),f.call(t.keywords,n)&&t.keywords[n]}function G(){m=_.pop()||T}}function R(t){return-1!==O.indexOf(t.toLowerCase())}function P(t){var e,n,r,o;if(t.variants&&!t[m]){for(e=(r=t.variants).length,n=-1,o=[];++n<e;)o[n]=h(t,{variants:null},r[n]);t[m]=o}return t.cached_variants?t.cached_variants:function t(e){return!!e&&(e.endsWithParent||t(e.starts))}(t)?[h(t,{starts:t.starts?h(t.starts):null})]:[t]}function B(t){return{relevance:t.relevance||0,language:t.language||null,value:t.value||[]}}function F(t){return t=t.toLowerCase(),N[t]||N[A[t]]}},265:function(t,e,n){var r,o,c;o=function(t){var e,n=[],r=Object.keys,o={},c={},l=/^(no-?highlight|plain|text)$/i,h=/\blang(?:uage)?-([\w-]+)\b/i,f=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,d="</span>",v={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},m="of and for in not or if then".split(" ");function y(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w(t){return t.nodeName.toLowerCase()}function x(t){return l.test(t)}function C(t){var e,n={},r=Array.prototype.slice.call(arguments,1);for(e in t)n[e]=t[e];return r.forEach((function(t){for(e in t)n[e]=t[e]})),n}function S(t){var e=[];return function t(n,r){for(var o=n.firstChild;o;o=o.nextSibling)3===o.nodeType?r+=o.nodeValue.length:1===o.nodeType&&(e.push({event:"start",offset:r,node:o}),r=t(o,r),w(o).match(/br|hr|img|input/)||e.push({event:"stop",offset:r,node:o}));return r}(t,0),e}function k(t){return t.variants&&!t.cached_variants&&(t.cached_variants=t.variants.map((function(e){return C(t,{variants:null},e)}))),t.cached_variants?t.cached_variants:function t(e){return!!e&&(e.endsWithParent||t(e.starts))}(t)?[C(t,{starts:t.starts?C(t.starts):null})]:[t]}function O(t){if(e&&!t.langApiRestored){for(var n in t.langApiRestored=!0,e)t[n]&&(t[e[n]]=t[n]);(t.contains||[]).concat(t.variants||[]).forEach(O)}}function M(t,e){return e?Number(e):(n=t,-1!=m.indexOf(n.toLowerCase())?0:1);var n}function N(t){function e(t){return t&&t.source||t}function n(n,r){return new RegExp(e(n),"m"+(t.case_insensitive?"i":"")+(r?"g":""))}function o(t){var r,o,c={},l=[],h={},f=1;function d(t,e){c[f]=t,l.push([t,e]),f+=function(t){return new RegExp(t.toString()+"|").exec("").length-1}(e)+1}for(var i=0;i<t.contains.length;i++)d(o=t.contains[i],o.beginKeywords?"\\.?(?:"+o.begin+")\\.?":o.begin);t.terminator_end&&d("end",t.terminator_end),t.illegal&&d("illegal",t.illegal);var v=l.map((function(t){return t[1]}));return r=n(function(t,n){for(var r=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./,o=0,c="",i=0;i<t.length;i++){var l=o+=1,h=e(t[i]);for(i>0&&(c+=n),c+="(";h.length>0;){var f=r.exec(h);if(null==f){c+=h;break}c+=h.substring(0,f.index),h=h.substring(f.index+f[0].length),"\\"==f[0][0]&&f[1]?c+="\\"+String(Number(f[1])+l):(c+=f[0],"("==f[0]&&o++)}c+=")"}return c}(v,"|"),!0),h.lastIndex=0,h.exec=function(s){var e;if(0===l.length)return null;r.lastIndex=h.lastIndex;var n=r.exec(s);if(!n)return null;for(var i=0;i<n.length;i++)if(null!=n[i]&&null!=c[""+i]){e=c[""+i];break}return"string"==typeof e?(n.type=e,n.extra=[t.illegal,t.terminator_end]):(n.type="begin",n.rule=e),n},h}!function c(l,h){l.compiled||(l.compiled=!0,l.keywords=l.keywords||l.beginKeywords,l.keywords&&(l.keywords=function(t,e){var n={};return"string"==typeof t?o("keyword",t):r(t).forEach((function(e){o(e,t[e])})),n;function o(t,r){e&&(r=r.toLowerCase()),r.split(" ").forEach((function(e){var r=e.split("|");n[r[0]]=[t,M(r[0],r[1])]}))}}(l.keywords,t.case_insensitive)),l.lexemesRe=n(l.lexemes||/\w+/,!0),h&&(l.beginKeywords&&(l.begin="\\b("+l.beginKeywords.split(" ").join("|")+")\\b"),l.begin||(l.begin=/\B|\b/),l.beginRe=n(l.begin),l.endSameAsBegin&&(l.end=l.begin),l.end||l.endsWithParent||(l.end=/\B|\b/),l.end&&(l.endRe=n(l.end)),l.terminator_end=e(l.end)||"",l.endsWithParent&&h.terminator_end&&(l.terminator_end+=(l.end?"|":"")+h.terminator_end)),l.illegal&&(l.illegalRe=n(l.illegal)),null==l.relevance&&(l.relevance=1),l.contains||(l.contains=[]),l.contains=Array.prototype.concat.apply([],l.contains.map((function(t){return k("self"===t?l:t)}))),l.contains.forEach((function(t){c(t,l)})),l.starts&&c(l.starts,h),l.terminators=o(l))}(t)}function A(t,e,n,r){function c(t,e){var n=S.case_insensitive?e[0].toLowerCase():e[0];return t.keywords.hasOwnProperty(n)&&t.keywords[n]}function l(t,e,n,r){if(!n&&""===e)return"";if(!t)return e;var o='<span class="'+(r?"":v.classPrefix);return(o+=t+'">')+e+(n?"":d)}function h(){T+=null!=O.subLanguage?function(){var t="string"==typeof O.subLanguage;if(t&&!o[O.subLanguage])return y(D);var e=t?A(O.subLanguage,D,!0,M[O.subLanguage]):E(D,O.subLanguage.length?O.subLanguage:void 0);return O.relevance>0&&(R+=e.relevance),t&&(M[O.subLanguage]=e.top),l(e.language,e.value,!1,!0)}():function(){var t,e,n,r;if(!O.keywords)return y(D);for(r="",e=0,O.lexemesRe.lastIndex=0,n=O.lexemesRe.exec(D);n;)r+=y(D.substring(e,n.index)),(t=c(O,n))?(R+=t[1],r+=l(t[0],y(n[0]))):r+=y(n[0]),e=O.lexemesRe.lastIndex,n=O.lexemesRe.exec(D);return r+y(D.substr(e))}(),D=""}function f(t){T+=t.className?l(t.className,"",!0):"",O=Object.create(t,{parent:{value:O}})}function m(t){var e=t[0],n=t.rule;return n&&n.endSameAsBegin&&(n.endRe=function(t){return new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(e)),n.skip?D+=e:(n.excludeBegin&&(D+=e),h(),n.returnBegin||n.excludeBegin||(D=e)),f(n),n.returnBegin?0:e.length}function w(t){var e=t[0],n=function t(e,n){if(function(t,e){var n=t&&t.exec(e);return n&&0===n.index}(e.endRe,n)){for(;e.endsParent&&e.parent;)e=e.parent;return e}if(e.endsWithParent)return t(e.parent,n)}(O,e);if(n){var r=O;r.skip?D+=e:(r.returnEnd||r.excludeEnd||(D+=e),h(),r.excludeEnd&&(D=e));do{O.className&&(T+=d),O.skip||O.subLanguage||(R+=O.relevance),O=O.parent}while(O!==n.parent);return n.starts&&(n.endSameAsBegin&&(n.starts.endRe=n.endRe),f(n.starts)),r.returnEnd?0:e.length}}var x={};function C(t,r){var o=r&&r[0];if(D+=t,null==o)return h(),0;if("begin"==x.type&&"end"==r.type&&x.index==r.index&&""===o)return D+=e.slice(r.index,r.index+1),1;if(x=r,"begin"===r.type)return m(r);if("illegal"===r.type&&!n)throw new Error('Illegal lexeme "'+o+'" for mode "'+(O.className||"<unnamed>")+'"');if("end"===r.type){var c=w(r);if(null!=c)return c}return D+=o,o.length}var S=P(t);if(!S)throw new Error('Unknown language: "'+t+'"');N(S);var k,O=r||S,M={},T="";for(k=O;k!==S;k=k.parent)k.className&&(T=l(k.className,"",!0)+T);var D="",R=0;try{for(var B,F,I=0;O.terminators.lastIndex=I,B=O.terminators.exec(e);)F=C(e.substring(I,B.index),B),I=B.index+F;for(C(e.substr(I)),k=O;k.parent;k=k.parent)k.className&&(T+=d);return{relevance:R,value:T,illegal:!1,language:t,top:O}}catch(t){if(t.message&&-1!==t.message.indexOf("Illegal"))return{illegal:!0,relevance:0,value:y(e)};throw t}}function E(text,t){t=t||v.languages||r(o);var e={relevance:0,value:y(text)},n=e;return t.filter(P).filter(B).forEach((function(t){var r=A(t,text,!1);r.language=t,r.relevance>n.relevance&&(n=r),r.relevance>e.relevance&&(n=e,e=r)})),n.language&&(e.second_best=n),e}function T(t){return v.tabReplace||v.useBR?t.replace(f,(function(t,e){return v.useBR&&"\n"===t?"<br>":v.tabReplace?e.replace(/\t/g,v.tabReplace):""})):t}function D(t){var e,r,o,l,text,f=function(t){var i,e,n,r,o=t.className+" ";if(o+=t.parentNode?t.parentNode.className:"",e=h.exec(o))return P(e[1])?e[1]:"no-highlight";for(i=0,n=(o=o.split(/\s+/)).length;i<n;i++)if(x(r=o[i])||P(r))return r}(t);x(f)||(v.useBR?(e=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=t.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):e=t,text=e.textContent,o=f?A(f,text,!0):E(text),(r=S(e)).length&&((l=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=o.value,o.value=function(t,e,r){var o=0,c="",l=[];function h(){return t.length&&e.length?t[0].offset!==e[0].offset?t[0].offset<e[0].offset?t:e:"start"===e[0].event?t:e:t.length?t:e}function f(t){c+="<"+w(t)+n.map.call(t.attributes,(function(a){return" "+a.nodeName+'="'+y(a.value).replace('"',"&quot;")+'"'})).join("")+">"}function d(t){c+="</"+w(t)+">"}function v(t){("start"===t.event?f:d)(t.node)}for(;t.length||e.length;){var m=h();if(c+=y(r.substring(o,m[0].offset)),o=m[0].offset,m===t){l.reverse().forEach(d);do{v(m.splice(0,1)[0]),m=h()}while(m===t&&m.length&&m[0].offset===o);l.reverse().forEach(f)}else"start"===m[0].event?l.push(m[0].node):l.pop(),v(m.splice(0,1)[0])}return c+y(r.substr(o))}(r,S(l),text)),o.value=T(o.value),t.innerHTML=o.value,t.className=function(t,e,n){var r=e?c[e]:n,o=[t.trim()];return t.match(/\bhljs\b/)||o.push("hljs"),-1===t.indexOf(r)&&o.push(r),o.join(" ").trim()}(t.className,f,o.language),t.result={language:o.language,re:o.relevance},o.second_best&&(t.second_best={language:o.second_best.language,re:o.second_best.relevance}))}function R(){if(!R.called){R.called=!0;var t=document.querySelectorAll("pre code");n.forEach.call(t,D)}}function P(t){return t=(t||"").toLowerCase(),o[t]||o[c[t]]}function B(t){var e=P(t);return e&&!e.disableAutodetect}return t.highlight=A,t.highlightAuto=E,t.fixMarkup=T,t.highlightBlock=D,t.configure=function(t){v=C(v,t)},t.initHighlighting=R,t.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",R,!1),addEventListener("load",R,!1)},t.registerLanguage=function(e,n){var r=o[e]=n(t);O(r),r.rawDefinition=n.bind(null,t),r.aliases&&r.aliases.forEach((function(t){c[t]=e}))},t.listLanguages=function(){return r(o)},t.getLanguage=P,t.autoDetection=B,t.inherit=C,t.IDENT_RE="[a-zA-Z]\\w*",t.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",t.NUMBER_RE="\\b\\d+(\\.\\d+)?",t.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",t.BINARY_NUMBER_RE="\\b(0b[01]+)",t.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",t.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},t.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},t.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},t.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},t.COMMENT=function(e,n,r){var o=t.inherit({className:"comment",begin:e,end:n,contains:[]},r||{});return o.contains.push(t.PHRASAL_WORDS_MODE),o.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),o},t.C_LINE_COMMENT_MODE=t.COMMENT("//","$"),t.C_BLOCK_COMMENT_MODE=t.COMMENT("/\\*","\\*/"),t.HASH_COMMENT_MODE=t.COMMENT("#","$"),t.NUMBER_MODE={className:"number",begin:t.NUMBER_RE,relevance:0},t.C_NUMBER_MODE={className:"number",begin:t.C_NUMBER_RE,relevance:0},t.BINARY_NUMBER_MODE={className:"number",begin:t.BINARY_NUMBER_RE,relevance:0},t.CSS_NUMBER_MODE={className:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},t.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[t.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[t.BACKSLASH_ESCAPE]}]},t.TITLE_MODE={className:"title",begin:t.IDENT_RE,relevance:0},t.UNDERSCORE_TITLE_MODE={className:"title",begin:t.UNDERSCORE_IDENT_RE,relevance:0},t.METHOD_GUARD={begin:"\\.\\s*"+t.UNDERSCORE_IDENT_RE,relevance:0},t},c="object"==typeof window&&window||"object"==typeof self&&self,e.nodeType?c&&(c.hljs=o({}),void 0===(r=function(){return c.hljs}.apply(e,[]))||(t.exports=r)):o(e)},266:function(t,e,n){"use strict";var r=n(267),o=c(Error);function c(t){return e.displayName=t.displayName||t.name,e;function e(e){return e&&(e=r.apply(null,arguments)),new t(e)}}t.exports=o,o.eval=c(EvalError),o.range=c(RangeError),o.reference=c(ReferenceError),o.syntax=c(SyntaxError),o.type=c(TypeError),o.uri=c(URIError),o.create=c},267:function(t,e,n){!function(){var e;function n(t){for(var e,n,r,o,c=1,l=[].slice.call(arguments),i=0,h=t.length,f="",d=!1,v=!1,m=function(){return l[c++]},y=function(){for(var n="";/\d/.test(t[i]);)n+=t[i++],e=t[i];return n.length>0?parseInt(n):null};i<h;++i)if(e=t[i],d)switch(d=!1,"."==e?(v=!1,e=t[++i]):"0"==e&&"."==t[i+1]?(v=!0,e=t[i+=2]):v=!0,o=y(),e){case"b":f+=parseInt(m(),10).toString(2);break;case"c":f+="string"==typeof(n=m())||n instanceof String?n:String.fromCharCode(parseInt(n,10));break;case"d":f+=parseInt(m(),10);break;case"f":r=String(parseFloat(m()).toFixed(o||6)),f+=v?r:r.replace(/^0/,"");break;case"j":f+=JSON.stringify(m());break;case"o":f+="0"+parseInt(m(),10).toString(8);break;case"s":f+=m();break;case"x":f+="0x"+parseInt(m(),10).toString(16);break;case"X":f+="0x"+parseInt(m(),10).toString(16).toUpperCase();break;default:f+=e}else"%"===e?d=!0:f+=e;return f}(e=t.exports=n).format=n,e.vsprintf=function(t,e){return n.apply(null,[t].concat(e))},"undefined"!=typeof console&&"function"==typeof console.log&&(e.printf=function(){console.log(n.apply(null,arguments))})}()},268:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(182),o=n(269),c=n(219),l=function(t,content){return function(tr){Array.isArray(t)||(t=[t]);for(var i=0,e=t.length;i<e;i++){var n=L(t[i])(tr.selection);if(n){var r=C(n.pos,content)(tr);if(r!==tr)return r}}return tr}},h=function(content){return function(tr){if(y(tr.selection)){var t=tr.selection,e=t.$from,n=t.$to;if(content instanceof o.Fragment&&e.parent.canReplace(e.index(),e.indexAfter(),content)||e.parent.canReplaceWith(e.index(),e.indexAfter(),content.type))return x(tr.replaceWith(e.pos,n.pos,content).setSelection(new r.NodeSelection(tr.doc.resolve(e.pos))))}return tr}},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(tr){var n=r.Selection.findFrom(tr.doc.resolve(t),e,!0);return n?tr.setSelection(n):tr}},d=function(t){return t.type&&t.type.spec.selectable},v=function(t,e,tr){return function(t){return d(t)&&t.type.isLeaf}(t)?tr.setSelection(new r.NodeSelection(tr.doc.resolve(e))):f(e)(tr)},m=function(content,t,e){return function(tr){var n="number"==typeof t,r=tr.selection.$from,o=n?tr.doc.resolve(t):y(tr.selection)?tr.doc.resolve(r.pos+1):r,c=o.parent;if(y(tr.selection)&&e&&tr!==(tr=h(content)(tr)))return tr;if(N(c)&&tr!==(tr=l(c.type,content)(tr))){var f=d(content)?o.before(o.depth):o.pos;return v(content,f,tr)}if(M(o,content)){tr.insert(o.pos,content);var m=n?o.pos:d(content)?tr.selection.$anchor.pos-1:tr.selection.$anchor.pos;return x(v(content,m,tr))}for(var i=o.depth;i>0;i--){var w=o.after(i),C=tr.doc.resolve(w);if(M(C,content))return tr.insert(w,content),x(v(content,w,tr))}return tr}},y=function(t){return t instanceof r.NodeSelection},w=function(t,e){return Array.isArray(t)&&t.indexOf(e.type)>-1||e.type===t},x=function(tr){return Object.assign(Object.create(tr),tr).setTime(Date.now())},C=function(t,content){return function(tr){var e=tr.doc.nodeAt(t),n=tr.doc.resolve(t);if(S(n,content)){var r=(tr=tr.replaceWith(t,t+e.nodeSize,content)).selection.$from.pos-1;return tr=f(Math.max(r,0),-1)(tr),tr=f(tr.selection.$from.start())(tr),x(tr)}return tr}},S=function(t,content){var e=t.node(t.depth);return e&&e.type.validContent(content instanceof o.Fragment?content:o.Fragment.from(content))},k=function(t){return function(tr){var e=tr.doc.nodeAt(t);return x(tr.delete(t,t+e.nodeSize))}},O=function(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;var e={};return Object.keys(t.nodes).forEach((function(n){var r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)})),t.cached.tableNodeTypes=e,e},M=function(t,content){var e=t.index();return content instanceof o.Fragment?t.parent.canReplace(e,e,content):content instanceof o.Node&&t.parent.canReplaceWith(e,e,content.type)},N=function(t){return!t||"paragraph"===t.type.name&&2===t.nodeSize},A=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?t.createChecked(null,e):t.createAndFill()},E=function(rect){return function(t){for(var map=c.TableMap.get(t.$anchorCell.node(-1)),e=t.$anchorCell.start(-1),n=map.cellsInRect(rect),r=map.cellsInRect(map.rectBetween(t.$anchorCell.pos-e,t.$headCell.pos-e)),i=0,o=n.length;i<o;i++)if(-1===r.indexOf(n[i]))return!1;return!0}},T=function(t){return t[0].map((function(e,i){return t.map((function(t){return t[i]}))}))},D=function(t){for(var map=c.TableMap.get(t),e=[],n=0;n<map.height;n++){for(var r=[],o={},l=0;l<map.width;l++){var h=map.map[n*map.width+l],f=t.nodeAt(h),rect=map.findCell(h);o[h]||rect.top!==n?r.push(null):(o[h]=!0,r.push(f))}e.push(r)}return e},R=function(t,e){for(var n=[],map=c.TableMap.get(t),r=0;r<map.height;r++){for(var o=t.child(r),l=[],h=0;h<map.width;h++)if(e[r][h]){var f=map.map[r*map.width+h],d=e[r][h],v=t.nodeAt(f).type.createChecked(Object.assign({},d.attrs),d.content,d.marks);l.push(v)}n.push(o.type.createChecked(o.attrs,l,o.marks))}return t.type.createChecked(t.attrs,n,t.marks)},P=function(t,e,n,r){var o=e[0]>n[0]?-1:1,c=t.splice(e[0],e.length),l=c.length%2==0?1:0,h=void 0;return h=-1===r&&1===o?n[0]-1:1===r&&-1===o?n[n.length-1]-l+1:-1===o?n[0]:n[n.length-1]-l,t.splice.apply(t,[h,0].concat(c)),t},B=function(t,e,n,r){var o="Target position is invalid, you can't move the "+r+" "+t+" to "+e+", the target can't be split. You could use tryToFit option.";if(1===(t>e?-1:1)){if(-1!==n.slice(0,n.length-1).indexOf(e))throw new Error(o)}else if(-1!==n.slice(1).indexOf(e))throw new Error(o);return!0},F=function(t){return function(e){var n=e.$from;return I(n,t)}},I=function(t,e){for(var i=t.depth;i>0;i--){var n=t.node(i);if(e(n))return{pos:i>0?t.before(i):0,start:t.start(i),depth:i,node:n}}},_=function(t,e){return function(n){var r=F(t)(n);if(r)return V(r.pos,e)}},z=function(t){return function(e){return!!F(t)(e)}},L=function(t){return function(e){return F((function(e){return w(t,e)}))(e)}},j=function(t){var e=t.$from.nodeBefore,n=r.Selection.findFrom(t.$from,-1);if(n&&e){var o=L(e.type)(n);return o?o.pos:n.$from.pos}},V=function(t,e){var n=e(t),r=n.node.childNodes[n.offset];return n.node.nodeType===Node.TEXT_NODE?n.node.parentNode:r&&r.nodeType!==Node.TEXT_NODE?r:n.node},$=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)throw new Error('Invalid "node" parameter');var n=[];return t.descendants((function(t,r){if(n.push({node:t,pos:r}),!e)return!1})),n},U=function(t,e,n){if(!t)throw new Error('Invalid "node" parameter');if(!e)throw new Error('Invalid "predicate" parameter');return $(t,n).filter((function(t){return e(t.node)}))},W=function(t,e,n){return U(t,(function(t){return t.type===e}),n)};var J=function(t){return F((function(t){return t.type.spec.tableRole&&"table"===t.type.spec.tableRole}))(t)},H=function(t){return t instanceof c.CellSelection},K=function(t){if(H(t)){var map=c.TableMap.get(t.$anchorCell.node(-1));return E({left:0,right:map.width,top:0,bottom:map.height})(t)}return!1},Y=function(t){return function(e){var table=J(e);if(table){var map=c.TableMap.get(table.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=map.width-1){var n=map.cellsInRect({left:e,right:e+1,top:0,bottom:map.height});return t.concat(n.map((function(t){var e=table.node.nodeAt(t),n=t+table.start;return{pos:n,start:n+1,node:e}})))}}),[])}}},X=function(t){return function(e){var table=J(e);if(table){var map=c.TableMap.get(table.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=map.height-1){var n=map.cellsInRect({left:0,right:map.width,top:e,bottom:e+1});return t.concat(n.map((function(t){var e=table.node.nodeAt(t),n=t+table.start;return{pos:n,start:n+1,node:e}})))}}),[])}}},select=function(t){return function(e,n){return function(tr){var table=J(tr.selection),r="row"===t;if(table){var map=c.TableMap.get(table.node);if(e>=0&&e<(r?map.height:map.width)){var o=r?0:e,l=r?e:0,h=r?map.width:e+1,f=r?e+1:map.height;if(n){var d=it(tr.selection.$from);if(!d)return tr;var v=map.findCell(d.pos-table.start);r?(l=Math.min(l,v.top),f=Math.max(f,v.bottom)):(o=Math.min(o,v.left),h=Math.max(h,v.right))}var m=map.cellsInRect({left:o,top:l,right:r?h:o+1,bottom:r?l+1:f}),y=f-l==1?m:map.cellsInRect({left:r?o:h-1,top:r?f-1:l,right:h,bottom:f}),head=table.start+m[0],w=table.start+y[y.length-1],C=tr.doc.resolve(head),S=tr.doc.resolve(w);return x(tr.setSelection(new c.CellSelection(S,C)))}}return tr}}},G=select("column"),Z=select("row"),Q=function(t){return function(tr){var table=J(tr.selection);if(table){var map=c.TableMap.get(table.node);if(t>=0&&t<=map.height){for(var e=table.node,n=O(e.type.schema),r=table.start,i=0;i<t+1;i++)r+=e.child(i).nodeSize;var o=e.child(t),l=[],h=0;if(o.forEach((function(t){1===t.attrs.rowspan&&(h+=t.attrs.colspan,l.push(n[t.type.spec.tableRole].createAndFill(t.attrs,t.marks)))})),h<map.width){for(var f=[],d=function(e){var n=at(e,(function(n,tr){var r=n.node.attrs.rowspan;return r>1&&e+r>t}))(tr);f.push.apply(f,function(t){if(Array.isArray(t)){for(var i=0,e=Array(t.length);i<t.length;i++)e[i]=t[i];return e}return Array.from(t)}(n))},v=t;v>=0;v--)d(v);f.length&&f.forEach((function(t){tr=ot(t,{rowspan:t.node.attrs.rowspan+1})(tr)}))}return m(n.row.create(o.attrs,l),r)(tr)}}return tr}},tt=function(t){return function(tr){var table=J(tr.selection);if(table){var map=c.TableMap.get(table.node);if(0===t&&1===map.width)return nt(tr);if(t>=0&&t<=map.width)return c.removeColumn(tr,{map:map,tableStart:table.start,table:table.node},t),x(tr)}return tr}},et=function(t){return function(tr){var table=J(tr.selection);if(table){var map=c.TableMap.get(table.node);if(0===t&&1===map.height)return nt(tr);if(t>=0&&t<=map.height)return c.removeRow(tr,{map:map,tableStart:table.start,table:table.node},t),x(tr)}return tr}},nt=function(tr){for(var t=tr.selection.$from,e=t.depth;e>0;e--){if("table"===t.node(e).type.spec.tableRole)return x(tr.delete(t.before(e),t.after(e)))}return tr},ot=function(t,e){return function(tr){return t?(tr.setNodeMarkup(t.pos,null,Object.assign({},t.node.attrs,e)),x(tr)):tr}},it=function(t){return I(t,(function(t){return t.type.spec.tableRole&&/cell/i.test(t.type.spec.tableRole)}))},st=function(t){var e=it(t);if(e){var table=function(t){return I(t,(function(t){return t.type.spec.tableRole&&/table/i.test(t.type.spec.tableRole)}))}(t),map=c.TableMap.get(table.node),n=e.pos-table.start;return map.rectBetween(n,n)}},at=function(t,e){return function(tr){var n=[],r=X(t)(tr.selection);if(r)for(var o=r.length-1;o>=0;o--)e(r[o],tr)&&n.push(r[o]);return n}},ct=function(t){return function(tr){for(var e=t,n=t,r=function(i){var t=Y(i)(tr.selection);t&&t.forEach((function(t){var r=t.node.attrs.colspan+i-1;r>=e&&(e=i),r>n&&(n=r)}))},i=t;i>=0;i--)r(i);var o=function(i){var t=Y(i)(tr.selection);t&&t.forEach((function(t){var e=t.node.attrs.colspan+i-1;t.node.attrs.colspan>1&&e>n&&(n=e)}))};for(i=t;i<=n;i++)o(i);var c=[];for(i=e;i<=n;i++){var l=Y(i)(tr.selection);l&&l.length&&c.push(i)}e=c[0],n=c[c.length-1];for(var h=Y(e)(tr.selection),f=X(0)(tr.selection),d=tr.doc.resolve(h[h.length-1].pos),v=void 0,m=n;m>=e;m--){var y=Y(m)(tr.selection);if(y&&y.length){for(var w=f.length-1;w>=0;w--)if(f[w].pos===y[0].pos){v=y[0];break}if(v)break}}return{$anchor:d,$head:tr.doc.resolve(v.pos),indexes:c}}},ut=function(t){return function(tr){for(var e=t,n=t,r=function(i){X(i)(tr.selection).forEach((function(t){var r=t.node.attrs.rowspan+i-1;r>=e&&(e=i),r>n&&(n=r)}))},i=t;i>=0;i--)r(i);var o=function(i){X(i)(tr.selection).forEach((function(t){var e=t.node.attrs.rowspan+i-1;t.node.attrs.rowspan>1&&e>n&&(n=e)}))};for(i=t;i<=n;i++)o(i);var c=[];for(i=e;i<=n;i++){var l=X(i)(tr.selection);l&&l.length&&c.push(i)}e=c[0],n=c[c.length-1];for(var h=X(e)(tr.selection),f=Y(0)(tr.selection),d=tr.doc.resolve(h[h.length-1].pos),v=void 0,m=n;m>=e;m--){var y=X(m)(tr.selection);if(y&&y.length){for(var w=f.length-1;w>=0;w--)if(f[w].pos===y[0].pos){v=y[0];break}if(v)break}}return{$anchor:d,$head:tr.doc.resolve(v.pos),indexes:c}}};e.isNodeSelection=y,e.canInsert=M,e.convertTableNodeToArrayOfRows=D,e.convertArrayOfRowsToTableNode=R,e.findParentNode=F,e.findParentNodeClosestToPos=I,e.findParentDomRef=_,e.hasParentNode=z,e.findParentNodeOfType=L,e.findParentNodeOfTypeClosestToPos=function(t,e){return I(t,(function(t){return w(e,t)}))},e.hasParentNodeOfType=function(t){return function(e){return z((function(e){return w(t,e)}))(e)}},e.findParentDomRefOfType=function(t,e){return function(n){return _((function(e){return w(t,e)}),e)(n)}},e.findSelectedNodeOfType=function(t){return function(e){if(y(e)){var n=e.node,r=e.$from;if(w(t,n))return{node:n,pos:r.pos,depth:r.depth}}}},e.findPositionOfNodeBefore=j,e.findDomRefAtPos=V,e.flatten=$,e.findChildren=U,e.findTextNodes=function(t,e){return U(t,(function(t){return t.isText}),e)},e.findInlineNodes=function(t,e){return U(t,(function(t){return t.isInline}),e)},e.findBlockNodes=function(t,e){return U(t,(function(t){return t.isBlock}),e)},e.findChildrenByAttr=function(t,e,n){return U(t,(function(t){return!!e(t.attrs)}),n)},e.findChildrenByType=W,e.findChildrenByMark=function(t,e,n){return U(t,(function(t){return e.isInSet(t.marks)}),n)},e.contains=function(t,e){return!!W(t,e).length},e.findTable=J,e.isCellSelection=H,e.getSelectionRect=function(t){if(H(t)){var e=t.$anchorCell.start(-1);return c.TableMap.get(t.$anchorCell.node(-1)).rectBetween(t.$anchorCell.pos-e,t.$headCell.pos-e)}},e.isColumnSelected=function(t){return function(e){if(H(e)){var map=c.TableMap.get(e.$anchorCell.node(-1));return E({left:t,right:t+1,top:0,bottom:map.height})(e)}return!1}},e.isRowSelected=function(t){return function(e){if(H(e)){var map=c.TableMap.get(e.$anchorCell.node(-1));return E({left:0,right:map.width,top:t,bottom:t+1})(e)}return!1}},e.isTableSelected=K,e.getCellsInColumn=Y,e.getCellsInRow=X,e.getCellsInTable=function(t){var table=J(t);if(table){var map=c.TableMap.get(table.node);return map.cellsInRect({left:0,right:map.width,top:0,bottom:map.height}).map((function(t){var e=table.node.nodeAt(t),n=t+table.start;return{pos:n,start:n+1,node:e}}))}},e.selectColumn=G,e.selectRow=Z,e.selectTable=function(tr){var table=J(tr.selection);if(table){var map=c.TableMap.get(table.node).map;if(map&&map.length){var head=table.start+map[0],t=table.start+map[map.length-1],e=tr.doc.resolve(head),n=tr.doc.resolve(t);return x(tr.setSelection(new c.CellSelection(n,e)))}}return tr},e.emptyCell=function(t,e){return function(tr){if(t){var content=O(e).cell.createAndFill().content;if(!t.node.content.eq(content))return tr.replaceWith(t.pos+1,t.pos+t.node.nodeSize,content),x(tr)}return tr}},e.addColumnAt=function(t){return function(tr){var table=J(tr.selection);if(table){var map=c.TableMap.get(table.node);if(t>=0&&t<=map.width)return x(c.addColumn(tr,{map:map,tableStart:table.start,table:table.node},t))}return tr}},e.moveRow=function(t,e,n){return function(tr){var r=Object.assign({tryToFit:!1,direction:0},n),table=J(tr.selection);if(!table)return tr;var o=ut(t)(tr).indexes,c=ut(e)(tr).indexes;if(o.indexOf(e)>-1)return tr;!r.tryToFit&&c.length>1&&B(t,e,c,"row");var l=function(table,t,e,n){var r=D(table.node);return r=P(r,t,e,n),R(table.node,r)}(table,o,c,r.direction);return x(tr).replaceWith(table.pos,table.pos+table.node.nodeSize,l)}},e.moveColumn=function(t,e,n){return function(tr){var r=Object.assign({tryToFit:!1,direction:0},n),table=J(tr.selection);if(!table)return tr;var o=ct(t)(tr).indexes,c=ct(e)(tr).indexes;if(o.indexOf(e)>-1)return tr;!r.tryToFit&&c.length>1&&B(t,e,c,"column");var l=function(table,t,e,n){var r=T(D(table.node));return r=P(r,t,e,n),r=T(r),R(table.node,r)}(table,o,c,r.direction);return x(tr).replaceWith(table.pos,table.pos+table.node.nodeSize,l)}},e.addRowAt=function(t,e){return function(tr){var table=J(tr.selection);if(table){var map=c.TableMap.get(table.node),n=t-1;if(e&&n>=0)return x(Q(n)(tr));if(t>=0&&t<=map.height)return x(c.addRow(tr,{map:map,tableStart:table.start,table:table.node},t))}return tr}},e.cloneRowAt=Q,e.removeColumnAt=tt,e.removeRowAt=et,e.removeTable=nt,e.removeSelectedColumns=function(tr){var t=tr.selection;if(K(t))return nt(tr);if(H(t)){var table=J(t);if(table){var map=c.TableMap.get(table.node),rect=map.rectBetween(t.$anchorCell.pos-table.start,t.$headCell.pos-table.start);if(0==rect.left&&rect.right==map.width)return!1;for(var e=Object.assign({},rect,{map:map,table:table.node,tableStart:table.start}),i=e.right-1;c.removeColumn(tr,e,i),i!==e.left;i--)e.table=e.tableStart?tr.doc.nodeAt(e.tableStart-1):tr.doc,e.map=c.TableMap.get(e.table);return x(tr)}}return tr},e.removeSelectedRows=function(tr){var t=tr.selection;if(K(t))return nt(tr);if(H(t)){var table=J(t);if(table){var map=c.TableMap.get(table.node),rect=map.rectBetween(t.$anchorCell.pos-table.start,t.$headCell.pos-table.start);if(0==rect.top&&rect.bottom==map.height)return!1;for(var e=Object.assign({},rect,{map:map,table:table.node,tableStart:table.start}),i=e.bottom-1;c.removeRow(tr,e,i),i!==e.top;i--)e.table=e.tableStart?tr.doc.nodeAt(e.tableStart-1):tr.doc,e.map=c.TableMap.get(e.table);return x(tr)}}return tr},e.removeColumnClosestToPos=function(t){return function(tr){var rect=st(t);return rect?tt(rect.left)(f(t.pos)(tr)):tr}},e.removeRowClosestToPos=function(t){return function(tr){var rect=st(t);return rect?et(rect.top)(f(t.pos)(tr)):tr}},e.forEachCellInColumn=function(t,e,n){return function(tr){var o=Y(t)(tr.selection);if(o){for(var i=o.length-1;i>=0;i--)tr=e(o[i],tr);if(n){var c=tr.doc.resolve(tr.mapping.map(o[o.length-1].pos));tr.setSelection(r.Selection.near(c))}return x(tr)}return tr}},e.forEachCellInRow=function(t,e,n){return function(tr){var o=X(t)(tr.selection);if(o){for(var i=o.length-1;i>=0;i--)tr=e(o[i],tr);if(n){var c=tr.doc.resolve(tr.mapping.map(o[o.length-1].pos));tr.setSelection(r.Selection.near(c))}}return tr}},e.setCellAttrs=ot,e.createTable=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=O(t),l=c.cell,h=c.header_cell,f=c.row,table=c.table,d=[],v=[],i=0;i<n;i++)d.push(A(l,o)),r&&v.push(A(h,o));for(var m=[],y=0;y<e;y++)m.push(f.createChecked(null,r&&0===y?v:d));return table.createChecked(null,m)},e.findCellClosestToPos=it,e.findCellRectClosestToPos=st,e.getSelectionRangeInColumn=ct,e.getSelectionRangeInRow=ut,e.removeParentNodeOfType=function(t){return function(tr){var e=L(t)(tr.selection);return e?k(e.pos)(tr):tr}},e.replaceParentNodeOfType=l,e.removeSelectedNode=function(tr){if(y(tr.selection)){var t=tr.selection.$from.pos,e=tr.selection.$to.pos;return x(tr.delete(t,e))}return tr},e.replaceSelectedNode=h,e.setTextSelection=f,e.safeInsert=m,e.setParentNodeMarkup=function(t,e,n,r){return function(tr){var o=L(t)(tr.selection);return o?x(tr.setNodeMarkup(o.pos,e,Object.assign({},o.node.attrs,n),r)):tr}},e.selectParentNodeOfType=function(t){return function(tr){if(!y(tr.selection)){var e=L(t)(tr.selection);if(e)return x(tr.setSelection(r.NodeSelection.create(tr.doc,e.pos)))}return tr}},e.removeNodeBefore=function(tr){var t=j(tr.selection);return"number"==typeof t?k(t)(tr):tr}},269:function(t,e,n){"use strict";n.r(e),n.d(e,"ContentMatch",(function(){return L})),n.d(e,"DOMParser",(function(){return ct})),n.d(e,"DOMSerializer",(function(){return Ct})),n.d(e,"Fragment",(function(){return o})),n.d(e,"Mark",(function(){return d})),n.d(e,"MarkType",(function(){return it})),n.d(e,"Node",(function(){return F})),n.d(e,"NodeRange",(function(){return R})),n.d(e,"NodeType",(function(){return tt})),n.d(e,"ReplaceError",(function(){return v})),n.d(e,"ResolvedPos",(function(){return N})),n.d(e,"Schema",(function(){return st})),n.d(e,"Slice",(function(){return m}));var r=n(185);var o=function(content,t){if(this.content=content,this.size=t||0,null==t)for(var i=0;i<content.length;i++)this.size+=content[i].nodeSize},c={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};o.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,c=0;c<e;i++){var l=this.content[i],h=c+l.nodeSize;if(h>t&&!1!==n(l,r+c,o,i)&&l.content.size){var f=c+1;l.nodesBetween(Math.max(0,t-f),Math.min(l.content.size,e-f),n,r+f)}c=h}},o.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},o.prototype.textBetween=function(t,e,n,r){var text="",o=!0;return this.nodesBetween(t,e,(function(c,l){c.isText?(text+=c.text.slice(Math.max(t,l)-l,e-l),o=!n):c.isLeaf&&r?(text+=r,o=!n):!o&&c.isBlock&&(text+=n,o=!0)}),0),text},o.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,content=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(content[content.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)content.push(t.content[i]);return new o(content,this.size+t.size)},o.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,c=0;c<e;i++){var l=this.content[i],h=c+l.nodeSize;h>t&&((c<t||h>e)&&(l=l.isText?l.cut(Math.max(0,t-c),Math.min(l.text.length,e-c)):l.cut(Math.max(0,t-c-1),Math.min(l.content.size,e-c-1))),n.push(l),r+=l.nodeSize),c=h}return new o(n,r)},o.prototype.cutByIndex=function(t,e){return t==e?o.empty:0==t&&e==this.content.length?this:new o(this.content.slice(t,e))},o.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),c=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new o(r,c)},o.prototype.addToStart=function(t){return new o([t].concat(this.content),this.size+t.nodeSize)},o.prototype.addToEnd=function(t){return new o(this.content.concat(t),this.size+t.nodeSize)},o.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0},c.firstChild.get=function(){return this.content.length?this.content[0]:null},c.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},c.childCount.get=function(){return this.content.length},o.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},o.prototype.maybeChild=function(t){return this.content[t]},o.prototype.forEach=function(t){for(var i=0,p=0;i<this.content.length;i++){var e=this.content[i];t(e,p,i),p+=e.nodeSize}},o.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(a,b,e){for(var i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:e;var n=a.child(i),r=b.child(i);if(n!=r){if(!n.sameMarkup(r))return e;if(n.isText&&n.text!=r.text){for(var o=0;n.text[o]==r.text[o];o++)e++;return e}if(n.content.size||r.content.size){var c=t(n.content,r.content,e+1);if(null!=c)return c}e+=n.nodeSize}else e+=n.nodeSize}}(this,t,e)},o.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(a,b,e,n){for(var r=a.childCount,o=b.childCount;;){if(0==r||0==o)return r==o?null:{a:e,b:n};var c=a.child(--r),l=b.child(--o),h=c.nodeSize;if(c!=l){if(!c.sameMarkup(l))return{a:e,b:n};if(c.isText&&c.text!=l.text){for(var f=0,d=Math.min(c.text.length,l.text.length);f<d&&c.text[c.text.length-f-1]==l.text[l.text.length-f-1];)f++,e--,n--;return{a:e,b:n}}if(c.content.size||l.content.size){var v=t(c.content,l.content,e-1,n-1);if(v)return v}e-=h,n-=h}else e-=h,n-=h}}(this,t,e,n)},o.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return h(0,t);if(t==this.size)return h(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var i=0,n=0;;i++){var r=n+this.child(i).nodeSize;if(r>=t)return r==t||e>0?h(i+1,r):h(i,n);n=r}},o.prototype.toString=function(){return"<"+this.toStringInner()+">"},o.prototype.toStringInner=function(){return this.content.join(", ")},o.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},o.fromJSON=function(t,e){if(!e)return o.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new o(e.map(t.nodeFromJSON))},o.fromArray=function(t){if(!t.length)return o.empty;for(var e,n=0,i=0;i<t.length;i++){var r=t[i];n+=r.nodeSize,i&&r.isText&&t[i-1].sameMarkup(r)?(e||(e=t.slice(0,i)),e[e.length-1]=r.withText(e[e.length-1].text+r.text)):e&&e.push(r)}return new o(e||t,n)},o.from=function(t){if(!t)return o.empty;if(t instanceof o)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new o([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(o.prototype,c);var l={index:0,offset:0};function h(t,e){return l.index=t,l.offset=e,l}function f(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var t=Array.isArray(a);if(Array.isArray(b)!=t)return!1;if(t){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!f(a[i],b[i]))return!1}else{for(var p in a)if(!(p in b&&f(a[p],b[p])))return!1;for(var e in b)if(!(e in a))return!1}return!0}o.empty=new o([],0);var d=function(t,e){this.type=t,this.attrs=e};function v(t){var e=Error.call(this,t);return e.__proto__=v.prototype,e}d.prototype.addToSet=function(t){for(var e,n=!1,i=0;i<t.length;i++){var r=t[i];if(this.eq(r))return t;if(this.type.excludes(r.type))e||(e=t.slice(0,i));else{if(r.type.excludes(this.type))return t;!n&&r.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),n=!0),e&&e.push(r)}}return e||(e=t.slice()),n||e.push(this),e},d.prototype.removeFromSet=function(t){for(var i=0;i<t.length;i++)if(this.eq(t[i]))return t.slice(0,i).concat(t.slice(i+1));return t},d.prototype.isInSet=function(t){for(var i=0;i<t.length;i++)if(this.eq(t[i]))return!0;return!1},d.prototype.eq=function(t){return this==t||this.type==t.type&&f(this.attrs,t.attrs)},d.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},d.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},d.sameSet=function(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0},d.setFrom=function(t){if(!t||0==t.length)return d.none;if(t instanceof d)return[t];var e=t.slice();return e.sort((function(a,b){return a.type.rank-b.type.rank})),e},d.none=[],v.prototype=Object.create(Error.prototype),v.prototype.constructor=v,v.prototype.name="ReplaceError";var m=function(content,t,e){this.content=content,this.openStart=t,this.openEnd=e},y={size:{configurable:!0}};function w(t,e,n){if(n.openStart>t.depth)throw new v("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new v("Inconsistent open depths");return function t(e,n,r,c){var l=e.index(c),h=e.node(c);if(l==n.index(c)&&c<e.depth-r.openStart){var f=t(e,n,r,c+1);return h.copy(h.content.replaceChild(l,f))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=c||n.depth!=c){var d=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(o.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),v=d.start,m=d.end;return O(h,function t(e,n,r,c,l){var h=e.depth>l&&C(e,n,l+1),f=c.depth>l&&C(r,c,l+1),content=[];k(null,e,l,content),h&&f&&n.index(l)==r.index(l)?(x(h,f),S(O(h,t(e,n,r,c,l+1)),content)):(h&&S(O(h,M(e,n,l+1)),content),k(n,r,l,content),f&&S(O(f,M(r,c,l+1)),content));return k(c,null,l,content),new o(content)}(e,v,m,n,c))}var y=e.parent,content=y.content;return O(y,content.cut(0,e.parentOffset).append(r.content).append(content.cut(n.parentOffset)))}return O(h,M(e,n,c))}(t,e,n,0)}function x(main,sub){if(!sub.type.compatibleContent(main.type))throw new v("Cannot join "+sub.type.name+" onto "+main.type.name)}function C(t,e,n){var r=t.node(n);return x(r,e.node(n)),r}function S(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function k(t,e,n,r){var o=(e||t).node(n),c=0,l=e?e.index(n):o.childCount;t&&(c=t.index(n),t.depth>n?c++:t.textOffset&&(S(t.nodeAfter,r),c++));for(var i=c;i<l;i++)S(o.child(i),r);e&&e.depth==n&&e.textOffset&&S(e.nodeBefore,r)}function O(t,content){if(!t.type.validContent(content))throw new v("Invalid content for node "+t.type.name);return t.copy(content)}function M(t,e,n){var content=[];(k(null,t,n,content),t.depth>n)&&S(O(C(t,e,n+1),M(t,e,n+1)),content);return k(e,null,n,content),new o(content)}y.size.get=function(){return this.content.size-this.openStart-this.openEnd},m.prototype.insertAt=function(t,e){var content=function t(content,e,n,r){var o=content.findIndex(e),c=o.index,l=o.offset,h=content.maybeChild(c);if(l==e||h.isText)return r&&!r.canReplace(c,c,n)?null:content.cut(0,e).append(n).append(content.cut(e));var f=t(h.content,e-l-1,n);return f&&content.replaceChild(c,h.copy(f))}(this.content,t+this.openStart,e,null);return content&&new m(content,this.openStart,this.openEnd)},m.prototype.removeBetween=function(t,e){return new m(function t(content,e,n){var r=content.findIndex(e),o=r.index,c=r.offset,l=content.maybeChild(o),h=content.findIndex(n),f=h.index,d=h.offset;if(c==e||l.isText){if(d!=n&&!content.child(f).isText)throw new RangeError("Removing non-flat range");return content.cut(0,e).append(content.cut(n))}if(o!=f)throw new RangeError("Removing non-flat range");return content.replaceChild(o,l.copy(t(l.content,e-c-1,n-c-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},m.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},m.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},m.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},m.fromJSON=function(t,e){if(!e)return m.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new m(o.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},m.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var c=t.lastChild;c&&!c.isLeaf&&(e||!c.type.spec.isolating);c=c.lastChild)r++;return new m(t,n,r)},Object.defineProperties(m.prototype,y),m.empty=new m(o.empty,0,0);var N=function(t,path,e){this.pos=t,this.path=path,this.depth=path.length/3-1,this.parentOffset=e},A={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};N.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},A.parent.get=function(){return this.node(this.depth)},A.doc.get=function(){return this.node(0)},N.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},N.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},N.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},N.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},N.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},N.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},N.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},A.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},A.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},A.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},N.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return d.none;if(this.textOffset)return t.child(e).marks;var main=t.maybeChild(e-1),n=t.maybeChild(e);if(!main){var r=main;main=n,n=r}for(var o=main.marks,i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||n&&o[i].isInSet(n.marks)||(o=o[i--].removeFromSet(o));return o},N.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n},N.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},N.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new R(this,t,n)},N.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},N.prototype.max=function(t){return t.pos>this.pos?t:this},N.prototype.min=function(t){return t.pos<this.pos?t:this},N.prototype.toString=function(){for(var t="",i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset},N.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var path=[],n=0,r=e,o=t;;){var c=o.content.findIndex(r),l=c.index,h=c.offset,f=r-h;if(path.push(o,l,n+h),!f)break;if((o=o.child(l)).isText)break;r=f-1,n+=h+1}return new N(e,path,r)},N.resolveCached=function(t,e){for(var i=0;i<E.length;i++){var n=E[i];if(n.pos==e&&n.doc==t)return n}var r=E[T]=N.resolve(t,e);return T=(T+1)%D,r},Object.defineProperties(N.prototype,A);var E=[],T=0,D=12,R=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},P={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};P.start.get=function(){return this.$from.before(this.depth+1)},P.end.get=function(){return this.$to.after(this.depth+1)},P.parent.get=function(){return this.$from.node(this.depth)},P.startIndex.get=function(){return this.$from.index(this.depth)},P.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(R.prototype,P);var B=Object.create(null),F=function(t,e,content,n){this.type=t,this.attrs=e,this.content=content||o.empty,this.marks=n||d.none},I={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};I.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},I.childCount.get=function(){return this.content.childCount},F.prototype.child=function(t){return this.content.child(t)},F.prototype.maybeChild=function(t){return this.content.maybeChild(t)},F.prototype.forEach=function(t){this.content.forEach(t)},F.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},F.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},I.textContent.get=function(){return this.textBetween(0,this.content.size,"")},F.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},I.firstChild.get=function(){return this.content.firstChild},I.lastChild.get=function(){return this.content.lastChild},F.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},F.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},F.prototype.hasMarkup=function(t,e,n){return this.type==t&&f(this.attrs,e||t.defaultAttrs||B)&&d.sameSet(this.marks,n||d.none)},F.prototype.copy=function(content){return void 0===content&&(content=null),content==this.content?this:new this.constructor(this.type,this.attrs,content,this.marks)},F.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},F.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},F.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return m.empty;var r=this.resolve(t),o=this.resolve(e),c=n?0:r.sharedDepth(e),l=r.start(c),content=r.node(c).content.cut(r.pos-l,o.pos-l);return new m(content,r.depth-c,o.depth-c)},F.prototype.replace=function(t,e,n){return w(this.resolve(t),this.resolve(e),n)},F.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},F.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},F.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},F.prototype.resolve=function(t){return N.resolveCached(this,t)},F.prototype.resolveNoCache=function(t){return N.resolve(this,t)},F.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},I.isBlock.get=function(){return this.type.isBlock},I.isTextblock.get=function(){return this.type.isTextblock},I.inlineContent.get=function(){return this.type.inlineContent},I.isInline.get=function(){return this.type.isInline},I.isText.get=function(){return this.type.isText},I.isLeaf.get=function(){return this.type.isLeaf},I.isAtom.get=function(){return this.type.isAtom},F.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),z(this.marks,t)},F.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},F.prototype.canReplace=function(t,e,n,r,c){void 0===n&&(n=o.empty),void 0===r&&(r=0),void 0===c&&(c=n.childCount);var l=this.contentMatchAt(t).matchFragment(n,r,c),h=l&&l.matchFragment(this.content,e);if(!h||!h.validEnd)return!1;for(var i=r;i<c;i++)if(!this.type.allowsMarks(n.child(i).marks))return!1;return!0},F.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),c=o&&o.matchFragment(this.content,e);return!!c&&c.validEnd},F.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},F.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},F.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},F.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var content=o.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,content,n)},Object.defineProperties(F.prototype,I);var _=function(t){function e(e,n,content,r){if(t.call(this,e,n,null,r),!content)throw new RangeError("Empty text nodes are not allowed");this.text=content}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):z(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(text){return text==this.text?this:new e(this.type,this.attrs,text,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var base=t.prototype.toJSON.call(this);return base.text=this.text,base},Object.defineProperties(e.prototype,n),e}(F);function z(t,e){for(var i=t.length-1;i>=0;i--)e=t[i].type.name+"("+e+")";return e}var L=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},j={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};L.parse=function(t,e){var n=new V(t,e);if(null==n.next)return L.empty;var r=U(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var c=o.indexOf(n),l=c>-1&&o[c+1];X(t,r).forEach((function(t){l||o.push(n,l=[]),-1==l.indexOf(t)&&l.push(t)}))}}))}));for(var c=e[r.join(",")]=new L(r.indexOf(t.length-1)>-1),i=0;i<o.length;i+=2){var l=o[i+1].sort(Y);c.next.push(o[i],e[l.join(",")]||n(l))}return c}(X(t,0))}(function(t){var e=[[]];return o(function t(e,c){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,c))}),[]);if("seq"==e.type)for(var i=0;;i++){var l=t(e.exprs[i],c);if(i==e.exprs.length-1)return l;o(l,c=n())}else{if("star"==e.type){var h=n();return r(c,h),o(t(e.expr,h),h),[r(h)]}if("plus"==e.type){var f=n();return o(t(e.expr,c),f),o(t(e.expr,f),f),[r(f)]}if("opt"==e.type)return[r(c)].concat(t(e.expr,c));if("range"==e.type){for(var d=c,v=0;v<e.min;v++){var m=n();o(t(e.expr,d),m),d=m}if(-1==e.max)o(t(e.expr,d),d);else for(var y=e.min;y<e.max;y++){var w=n();r(d,w),o(t(e.expr,d),w),d=w}return[r(d)]}if("name"==e.type)return[r(c,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var i=0,n=[t];i<n.length;i++){for(var r=n[i],o=!r.validEnd,c=[],l=0;l<r.next.length;l+=2){var h=r.next[l],f=r.next[l+1];c.push(h.name),!o||h.isText||h.hasRequiredAttrs()||(o=!1),-1==n.indexOf(f)&&n.push(f)}o&&e.err("Only non-generatable nodes ("+c.join(", ")+") in a required position")}}(o,n),o},L.prototype.matchType=function(t){for(var i=0;i<this.next.length;i+=2)if(this.next[i]==t)return this.next[i+1];return null},L.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,i=e;r&&i<n;i++)r=r.matchType(t.child(i).type);return r},j.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},j.defaultType.get=function(){for(var i=0;i<this.next.length;i+=2){var t=this.next[i];if(!t.isText&&!t.hasRequiredAttrs())return t}},L.prototype.compatible=function(t){for(var i=0;i<this.next.length;i+=2)for(var e=0;e<t.next.length;e+=2)if(this.next[i]==t.next[e])return!0;return!1},L.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function c(l,h){var f=l.matchFragment(t,n);if(f&&(!e||f.validEnd))return o.from(h.map((function(t){return t.createAndFill()})));for(var i=0;i<l.next.length;i+=2){var d=l.next[i],v=l.next[i+1];if(!d.isText&&!d.hasRequiredAttrs()&&-1==r.indexOf(v)){r.push(v);var m=c(v,h.concat(d));if(m)return m}}}(this,[])},L.prototype.findWrapping=function(t){for(var i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==t)return this.wrapCache[i+1];var e=this.computeWrapping(t);return this.wrapCache.push(t,e),e},L.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var c=[],l=r;l.type;l=l.via)c.push(l.type);return c.reverse()}for(var i=0;i<o.next.length;i+=2){var h=o.next[i];h.isLeaf||h.hasRequiredAttrs()||h.name in e||r.type&&!o.next[i+1].validEnd||(n.push({match:h.contentMatch,type:h,via:r}),e[h.name]=!0)}}},j.edgeCount.get=function(){return this.next.length>>1},L.prototype.edge=function(t){var i=t<<1;if(i>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[i],next:this.next[i+1]}},L.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var i=1;i<n.next.length;i+=2)-1==t.indexOf(n.next[i])&&e(n.next[i])}(this),t.map((function(e,i){for(var n=i+(e.validEnd?"*":" ")+" ",r=0;r<e.next.length;r+=2)n+=(r?", ":"")+e.next[r].name+"->"+t.indexOf(e.next[r+1]);return n})).join("\n")},Object.defineProperties(L.prototype,j),L.empty=new L(!0);var V=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},$={next:{configurable:!0}};function U(t){var e=[];do{e.push(W(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function W(t){var e=[];do{e.push(J(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function J(t){for(var e=function(t){if(t.eat("(")){var e=U(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var c in n){var l=n[c];l.groups.indexOf(e)>-1&&o.push(l)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=K(t,e)}return e}function H(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function K(t,e){var n=H(t),r=n;return t.eat(",")&&(r="}"!=t.next?H(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Y(a,b){return b-a}function X(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var c=o[i],l=c.term,h=c.to;l||-1!=n.indexOf(h)||e(h)}}(e),n.sort(Y)}function G(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Z(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var c=t[r];if(!c.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=c.default}n[r]=o}return n}function Q(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new nt(t[n]);return e}$.next.get=function(){return this.tokens[this.pos]},V.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},V.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(V.prototype,$);var tt=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Q(n.attrs),this.defaultAttrs=G(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},et={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};et.isInline.get=function(){return!this.isBlock},et.isTextblock.get=function(){return this.isBlock&&this.inlineContent},et.isLeaf.get=function(){return this.contentMatch==L.empty},et.isAtom.get=function(){return this.isLeaf||this.spec.atom},tt.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},tt.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},tt.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Z(this.attrs,t)},tt.prototype.create=function(t,content,e){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new F(this,this.computeAttrs(t),o.from(content),d.setFrom(e))},tt.prototype.createChecked=function(t,content,e){if(content=o.from(content),!this.validContent(content))throw new RangeError("Invalid content for node "+this.name);return new F(this,this.computeAttrs(t),content,d.setFrom(e))},tt.prototype.createAndFill=function(t,content,e){if(t=this.computeAttrs(t),(content=o.from(content)).size){var n=this.contentMatch.fillBefore(content);if(!n)return null;content=n.append(content)}var r=this.contentMatch.matchFragment(content).fillBefore(o.empty,!0);return r?new F(this,t,content.append(r),d.setFrom(e)):null},tt.prototype.validContent=function(content){var t=this.contentMatch.matchFragment(content);if(!t||!t.validEnd)return!1;for(var i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0},tt.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},tt.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0},tt.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,i=0;i<t.length;i++)this.allowsMarkType(t[i].type)?e&&e.push(t[i]):e||(e=t.slice(0,i));return e?e.length?e:d.empty:t},tt.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new tt(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(tt.prototype,et);var nt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ot={isRequired:{configurable:!0}};ot.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(nt.prototype,ot);var it=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Q(r.attrs),this.rank=e,this.excluded=null;var o=G(this.attrs);this.instance=o&&new d(this,o)};it.prototype.create=function(t){return!t&&this.instance?this.instance:new d(this,Z(this.attrs,t))},it.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new it(t,r++,e,o)})),n},it.prototype.removeFromSet=function(t){for(var i=0;i<t.length;i++)if(t[i].type==this)return t.slice(0,i).concat(t.slice(i+1));return t},it.prototype.isInSet=function(t){for(var i=0;i<t.length;i++)if(t[i].type==this)return t[i]},it.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var st=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=tt.compile(this.spec.nodes,this),this.marks=it.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var c=this.nodes[o],l=c.spec.content||"",h=c.spec.marks;c.contentMatch=n[l]||(n[l]=L.parse(l,this.nodes)),c.inlineContent=c.contentMatch.inlineContent,c.markSet="_"==h?null:h?at(this,h.split(" ")):""!=h&&c.inlineContent?null:[]}for(var f in this.marks){var d=this.marks[f],v=d.spec.excludes;d.excluded=null==v?[d]:""==v?[]:at(this,v.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function at(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i],mark=t.marks[r],o=mark;if(mark)n.push(mark);else for(var c in t.marks){var l=t.marks[c];("_"==r||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}st.prototype.node=function(t,e,content,n){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof tt))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,content,n)},st.prototype.text=function(t,e){var n=this.nodes.text;return new _(n,n.defaultAttrs,t,d.setFrom(e))},st.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},st.prototype.nodeFromJSON=function(t){return F.fromJSON(this,t)},st.prototype.markFromJSON=function(t){return d.fromJSON(this,t)},st.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var ct=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};ct.prototype.parse=function(t,e){void 0===e&&(e={});var n=new gt(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},ct.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new gt(this,e,!0);return n.addAll(t,null,e.from,e.to),m.maxOpen(n.finish())},ct.prototype.matchTag=function(t,e){for(var i=0;i<this.tags.length;i++){var n=this.tags[i];if(bt(t,n.tag)&&(void 0===n.namespace||t.namespaceURI==n.namespace)&&(!n.context||e.matchesContext(n.context))){if(n.getAttrs){var r=n.getAttrs(t);if(!1===r)continue;n.attrs=r}return n}}},ct.prototype.matchStyle=function(t,e,n){for(var i=0;i<this.styles.length;i++){var r=this.styles[i];if(!(0!=r.style.indexOf(t)||r.context&&!n.matchesContext(r.context)||r.style.length>t.length&&(61!=r.style.charCodeAt(t.length)||r.style.slice(t.length+1)!=e))){if(r.getAttrs){var o=r.getAttrs(e);if(!1===o)continue;r.attrs=o}return r}}},ct.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,i=0;i<e.length;i++){var r=e[i];if((null==r.priority?50:r.priority)<n)break}e.splice(i,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=wt(t)),t.mark=e}))};for(var o in t.marks)r(o);var c;for(var l in t.nodes)c=void 0,(c=t.nodes[l].spec.parseDOM)&&c.forEach((function(t){n(t=wt(t)),t.node=l}));return e},ct.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new ct(t,ct.schemaRules(t)))};var ut={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},lt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ht={ol:!0,ul:!0},ft=1,pt=2;function vt(t){return(t?ft:0)|("full"===t?pt:0)}var mt=function(t,e,n,r,o,c,l){this.type=t,this.attrs=e,this.solid=o,this.match=c||(4&l?null:t.contentMatch),this.options=l,this.content=[],this.marks=n,this.activeMarks=d.none,this.pendingMarks=r};mt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(o.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},mt.prototype.finish=function(t){if(!(this.options&ft)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var content=o.from(this.content);return!t&&this.match&&(content=content.append(this.match.fillBefore(o.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content},mt.prototype.applyPending=function(t){for(var i=0,e=this.pendingMarks;i<e.length;i++){var mark=e[i];(this.type?this.type.allowsMarkType(mark.type):xt(mark.type,t))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}};var gt=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,c=vt(e.preserveWhitespace)|(n?4:0);r=o?new mt(o.type,o.attrs,d.none,d.none,!0,e.topMatch||o.type.contentMatch,c):new mt(n?null:t.schema.topNodeType,null,d.none,d.none,!0,null,c),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},yt={top:{configurable:!0},currentPos:{configurable:!0}};function bt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function wt(t){var e={};for(var n in t)e[n]=t[n];return e}function xt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var c=[],l=function(t){c.push(t);for(var i=0;i<t.edgeCount;i++){var n=t.edge(i),r=n.type,o=n.next;if(r==e)return!0;if(c.indexOf(o)<0&&l(o))return!0}};return l(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var c=r(o);if(c)return c.v}}yt.top.get=function(){return this.nodes[this.open]},gt.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var style=t.getAttribute("style"),e=style?this.readStyles(function(style){var t,e=/\s*([\w-]+)\s*:\s*([^;]+)/g,n=[];for(;t=e.exec(style);)n.push(t[1],t[2].trim());return n}(style)):null,n=this.top;if(null!=e)for(var i=0;i<e.length;i++)this.addPendingMark(e[i]);if(this.addElement(t),null!=e)for(var r=0;r<e.length;r++)this.removePendingMark(e[r],n)}},gt.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(n.options&ft)n.options&pt||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},gt.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();ht.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&ht.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:lt.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,c=this.needsBlock;if(ut.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=c}else this.addElementByRule(t,n)},gt.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},gt.prototype.readStyles=function(t){for(var e=d.none,i=0;i<t.length;i+=2){var n=this.parser.matchStyle(t[i],t[i+1],this);if(n){if(n.ignore)return null;e=this.parser.schema.marks[n.mark].create(n.attrs).addToSet(e)}}return e},gt.prototype.addElementByRule=function(t,e){var n,r,mark,o=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(mark=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(mark));var c=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return o.insertNode(t)}));else{var l=e.contentElement;"string"==typeof l?l=t.querySelector(l):"function"==typeof l&&(l=l(t)),l||(l=t),this.findAround(t,l,!0),this.addAll(l,n)}n&&(this.sync(c),this.open--),mark&&this.removePendingMark(mark,c)},gt.prototype.addAll=function(t,e,n,r){for(var o=n||0,c=n?t.childNodes[n]:t.firstChild,l=null==r?null:t.childNodes[r];c!=l;c=c.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(c),e&&ut.hasOwnProperty(c.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},gt.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],c=o.findWrapping(t);if(c&&(!e||e.length>c.length)&&(e=c,n=o,!c.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0},gt.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,i=0;i<t.marks.length;i++)n.type&&!n.type.allowsMarkType(t.marks[i].type)||(r=t.marks[i].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},gt.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},gt.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var c=null==r?-5&o.options:vt(r);4&o.options&&0==o.content.length&&(c|=4),this.nodes.push(new mt(t,e,o.activeMarks,o.pendingMarks,n,null,c)),this.open++},gt.prototype.closeExtra=function(t){var i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}},gt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},gt.prototype.sync=function(t){for(var i=this.open;i>=0;i--)if(this.nodes[i]==t)return void(this.open=i)},yt.currentPos.get=function(){this.closeExtra();for(var t=0,i=this.open;i>=0;i--){for(var content=this.nodes[i].content,e=content.length-1;e>=0;e--)t+=content[e].nodeSize;i&&t++}return t},gt.prototype.findAtPoint=function(t,e){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&this.find[i].offset==e&&(this.find[i].pos=this.currentPos)},gt.prototype.findInside=function(t){if(this.find)for(var i=0;i<this.find.length;i++)null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)},gt.prototype.findAround=function(t,content,e){if(t!=content&&this.find)for(var i=0;i<this.find.length;i++){if(null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node))content.compareDocumentPosition(this.find[i].node)&(e?2:4)&&(this.find[i].pos=this.currentPos)}},gt.prototype.findInText=function(t){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))},gt.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),option=this.options.context,r=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),o=-(option?option.depth+1:0)+(r?0:1),c=function(i,t){for(;i>=0;i--){var l=n[i];if(""==l){if(i==n.length-1||0==i)continue;for(;t>=o;t--)if(c(i-1,t))return!0;return!1}var h=t>0||0==t&&r?e.nodes[t].type:option&&t>=o?option.node(t-o).type:null;if(!h||h.name!=l&&-1==h.groups.indexOf(l))return!1;t--}return!0};return c(n.length-1,this.open)},gt.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},gt.prototype.addPendingMark=function(mark){this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)},gt.prototype.removePendingMark=function(mark,t){for(var e=this.open;e>=0;e--){var n=this.nodes[e];if(n.pendingMarks.lastIndexOf(mark)>-1?n.pendingMarks=mark.removeFromSet(n.pendingMarks):n.activeMarks=mark.removeFromSet(n.activeMarks),n==t)break}},Object.defineProperties(gt.prototype,yt);var Ct=function(t,e){this.nodes=t||{},this.marks=e||{}};function St(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function kt(t){return t.document||window.document}Ct.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=kt(e).createDocumentFragment());var o=n,c=null;return t.forEach((function(t){if(c||t.marks.length){c||(c=[]);for(var n=0,l=0;n<c.length&&l<t.marks.length;){var h=t.marks[l];if(r.marks[h.type.name]){if(!h.eq(c[n])||!1===h.type.spec.spanning)break;n+=2,l++}else l++}for(;n<c.length;)o=c.pop(),c.pop();for(;l<t.marks.length;){var f=t.marks[l++],d=r.serializeMark(f,t.isInline,e);d&&(c.push(f,o),o.appendChild(d.dom),o=d.contentDOM||d.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Ct.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Ct.renderSpec(kt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Ct.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),i=t.marks.length-1;i>=0;i--){var r=this.serializeMark(t.marks[i],t.isInline,e);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n},Ct.prototype.serializeMark=function(mark,t,e){void 0===e&&(e={});var n=this.marks[mark.type.name];return n&&Ct.renderSpec(kt(e),n(mark,t))},Ct.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var c=null,l=n?t.createElementNS(n,r):t.createElement(r),h=e[1],f=1;if(h&&"object"==typeof h&&null==h.nodeType&&!Array.isArray(h))for(var d in f=2,h)if(null!=h[d]){var v=d.indexOf(" ");v>0?l.setAttributeNS(d.slice(0,v),d.slice(v+1),h[d]):l.setAttribute(d,h[d])}for(var i=f;i<e.length;i++){var m=e[i];if(0===m){if(i<e.length-1||i>f)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}var y=Ct.renderSpec(t,m,n),w=y.dom,x=y.contentDOM;if(l.appendChild(w),x){if(c)throw new RangeError("Multiple content holes");c=x}}return{dom:l,contentDOM:c}},Ct.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Ct(this.nodesFromSchema(t),this.marksFromSchema(t)))},Ct.nodesFromSchema=function(t){var e=St(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Ct.marksFromSchema=function(t){return St(t.marks)}},276:function(t,e,n){"use strict";n.d(e,"a",(function(){return vo})),n.d(e,"b",(function(){return mo})),n.d(e,"c",(function(){return yo})),n.d(e,"d",(function(){return uo})),n.d(e,"e",(function(){return lo})),n.d(e,"f",(function(){return bo})),n.d(e,"g",(function(){return go}));var r=n(205),o=n(220),c=n(264),l=n.n(c),h=n(182),f=n(185);var d=function(content,t){if(this.content=content,this.size=t||0,null==t)for(var i=0;i<content.length;i++)this.size+=content[i].nodeSize},v={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};d.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,c=0;c<e;i++){var l=this.content[i],h=c+l.nodeSize;if(h>t&&!1!==n(l,r+c,o,i)&&l.content.size){var f=c+1;l.nodesBetween(Math.max(0,t-f),Math.min(l.content.size,e-f),n,r+f)}c=h}},d.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},d.prototype.textBetween=function(t,e,n,r){var text="",o=!0;return this.nodesBetween(t,e,(function(c,l){c.isText?(text+=c.text.slice(Math.max(t,l)-l,e-l),o=!n):c.isLeaf&&r?(text+=r,o=!n):!o&&c.isBlock&&(text+=n,o=!0)}),0),text},d.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,content=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(content[content.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)content.push(t.content[i]);return new d(content,this.size+t.size)},d.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,o=0;o<e;i++){var c=this.content[i],l=o+c.nodeSize;l>t&&((o<t||l>e)&&(c=c.isText?c.cut(Math.max(0,t-o),Math.min(c.text.length,e-o)):c.cut(Math.max(0,t-o-1),Math.min(c.content.size,e-o-1))),n.push(c),r+=c.nodeSize),o=l}return new d(n,r)},d.prototype.cutByIndex=function(t,e){return t==e?d.empty:0==t&&e==this.content.length?this:new d(this.content.slice(t,e))},d.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new d(r,o)},d.prototype.addToStart=function(t){return new d([t].concat(this.content),this.size+t.nodeSize)},d.prototype.addToEnd=function(t){return new d(this.content.concat(t),this.size+t.nodeSize)},d.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0},v.firstChild.get=function(){return this.content.length?this.content[0]:null},v.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},v.childCount.get=function(){return this.content.length},d.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},d.prototype.maybeChild=function(t){return this.content[t]},d.prototype.forEach=function(t){for(var i=0,p=0;i<this.content.length;i++){var e=this.content[i];t(e,p,i),p+=e.nodeSize}},d.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(a,b,e){for(var i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:e;var n=a.child(i),r=b.child(i);if(n!=r){if(!n.sameMarkup(r))return e;if(n.isText&&n.text!=r.text){for(var o=0;n.text[o]==r.text[o];o++)e++;return e}if(n.content.size||r.content.size){var c=t(n.content,r.content,e+1);if(null!=c)return c}e+=n.nodeSize}else e+=n.nodeSize}}(this,t,e)},d.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(a,b,e,n){for(var r=a.childCount,o=b.childCount;;){if(0==r||0==o)return r==o?null:{a:e,b:n};var c=a.child(--r),l=b.child(--o),h=c.nodeSize;if(c!=l){if(!c.sameMarkup(l))return{a:e,b:n};if(c.isText&&c.text!=l.text){for(var f=0,d=Math.min(c.text.length,l.text.length);f<d&&c.text[c.text.length-f-1]==l.text[l.text.length-f-1];)f++,e--,n--;return{a:e,b:n}}if(c.content.size||l.content.size){var v=t(c.content,l.content,e-1,n-1);if(v)return v}e-=h,n-=h}else e-=h,n-=h}}(this,t,e,n)},d.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return y(0,t);if(t==this.size)return y(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var i=0,n=0;;i++){var r=n+this.child(i).nodeSize;if(r>=t)return r==t||e>0?y(i+1,r):y(i,n);n=r}},d.prototype.toString=function(){return"<"+this.toStringInner()+">"},d.prototype.toStringInner=function(){return this.content.join(", ")},d.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},d.fromJSON=function(t,e){if(!e)return d.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new d(e.map(t.nodeFromJSON))},d.fromArray=function(t){if(!t.length)return d.empty;for(var e,n=0,i=0;i<t.length;i++){var r=t[i];n+=r.nodeSize,i&&r.isText&&t[i-1].sameMarkup(r)?(e||(e=t.slice(0,i)),e[e.length-1]=r.withText(e[e.length-1].text+r.text)):e&&e.push(r)}return new d(e||t,n)},d.from=function(t){if(!t)return d.empty;if(t instanceof d)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new d([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(d.prototype,v);var m={index:0,offset:0};function y(t,e){return m.index=t,m.offset=e,m}function w(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var t=Array.isArray(a);if(Array.isArray(b)!=t)return!1;if(t){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!w(a[i],b[i]))return!1}else{for(var p in a)if(!(p in b&&w(a[p],b[p])))return!1;for(var e in b)if(!(e in a))return!1}return!0}d.empty=new d([],0);var x=function(t,e){this.type=t,this.attrs=e};function C(t){var e=Error.call(this,t);return e.__proto__=C.prototype,e}x.prototype.addToSet=function(t){for(var e,n=!1,i=0;i<t.length;i++){var r=t[i];if(this.eq(r))return t;if(this.type.excludes(r.type))e||(e=t.slice(0,i));else{if(r.type.excludes(this.type))return t;!n&&r.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),n=!0),e&&e.push(r)}}return e||(e=t.slice()),n||e.push(this),e},x.prototype.removeFromSet=function(t){for(var i=0;i<t.length;i++)if(this.eq(t[i]))return t.slice(0,i).concat(t.slice(i+1));return t},x.prototype.isInSet=function(t){for(var i=0;i<t.length;i++)if(this.eq(t[i]))return!0;return!1},x.prototype.eq=function(t){return this==t||this.type==t.type&&w(this.attrs,t.attrs)},x.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},x.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},x.sameSet=function(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0},x.setFrom=function(t){if(!t||0==t.length)return x.none;if(t instanceof x)return[t];var e=t.slice();return e.sort((function(a,b){return a.type.rank-b.type.rank})),e},x.none=[],C.prototype=Object.create(Error.prototype),C.prototype.constructor=C,C.prototype.name="ReplaceError";var S=function(content,t,e){this.content=content,this.openStart=t,this.openEnd=e},k={size:{configurable:!0}};function O(t,e,n){if(n.openStart>t.depth)throw new C("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new C("Inconsistent open depths");return function t(e,n,r,o){var c=e.index(o),l=e.node(o);if(c==n.index(o)&&o<e.depth-r.openStart){var h=t(e,n,r,o+1);return l.copy(l.content.replaceChild(c,h))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var f=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(d.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),v=f.start,m=f.end;return T(l,function t(e,n,r,o,c){var l=e.depth>c&&N(e,n,c+1),h=o.depth>c&&N(r,o,c+1),content=[];E(null,e,c,content),l&&h&&n.index(c)==r.index(c)?(M(l,h),A(T(l,t(e,n,r,o,c+1)),content)):(l&&A(T(l,D(e,n,c+1)),content),E(n,r,c,content),h&&A(T(h,D(r,o,c+1)),content));return E(o,null,c,content),new d(content)}(e,v,m,n,o))}var y=e.parent,content=y.content;return T(y,content.cut(0,e.parentOffset).append(r.content).append(content.cut(n.parentOffset)))}return T(l,D(e,n,o))}(t,e,n,0)}function M(main,sub){if(!sub.type.compatibleContent(main.type))throw new C("Cannot join "+sub.type.name+" onto "+main.type.name)}function N(t,e,n){var r=t.node(n);return M(r,e.node(n)),r}function A(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function E(t,e,n,r){var o=(e||t).node(n),c=0,l=e?e.index(n):o.childCount;t&&(c=t.index(n),t.depth>n?c++:t.textOffset&&(A(t.nodeAfter,r),c++));for(var i=c;i<l;i++)A(o.child(i),r);e&&e.depth==n&&e.textOffset&&A(e.nodeBefore,r)}function T(t,content){if(!t.type.validContent(content))throw new C("Invalid content for node "+t.type.name);return t.copy(content)}function D(t,e,n){var content=[];(E(null,t,n,content),t.depth>n)&&A(T(N(t,e,n+1),D(t,e,n+1)),content);return E(e,null,n,content),new d(content)}k.size.get=function(){return this.content.size-this.openStart-this.openEnd},S.prototype.insertAt=function(t,e){var content=function t(content,e,n,r){var o=content.findIndex(e),c=o.index,l=o.offset,h=content.maybeChild(c);if(l==e||h.isText)return r&&!r.canReplace(c,c,n)?null:content.cut(0,e).append(n).append(content.cut(e));var f=t(h.content,e-l-1,n);return f&&content.replaceChild(c,h.copy(f))}(this.content,t+this.openStart,e,null);return content&&new S(content,this.openStart,this.openEnd)},S.prototype.removeBetween=function(t,e){return new S(function t(content,e,n){var r=content.findIndex(e),o=r.index,c=r.offset,l=content.maybeChild(o),h=content.findIndex(n),f=h.index,d=h.offset;if(c==e||l.isText){if(d!=n&&!content.child(f).isText)throw new RangeError("Removing non-flat range");return content.cut(0,e).append(content.cut(n))}if(o!=f)throw new RangeError("Removing non-flat range");return content.replaceChild(o,l.copy(t(l.content,e-c-1,n-c-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},S.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},S.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},S.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},S.fromJSON=function(t,e){if(!e)return S.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new S(d.fromJSON(t,e.content),n,r)},S.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var c=t.lastChild;c&&!c.isLeaf&&(e||!c.type.spec.isolating);c=c.lastChild)r++;return new S(t,n,r)},Object.defineProperties(S.prototype,k),S.empty=new S(d.empty,0,0);var R=function(t,path,e){this.pos=t,this.path=path,this.depth=path.length/3-1,this.parentOffset=e},P={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};R.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},P.parent.get=function(){return this.node(this.depth)},P.doc.get=function(){return this.node(0)},R.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},R.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},R.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},R.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},R.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},R.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},R.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},P.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},P.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},P.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},R.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,i=0;i<t;i++)r+=n.child(i).nodeSize;return r},R.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return x.none;if(this.textOffset)return t.child(e).marks;var main=t.maybeChild(e-1),n=t.maybeChild(e);if(!main){var r=main;main=n,n=r}for(var o=main.marks,i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||n&&o[i].isInSet(n.marks)||(o=o[i--].removeFromSet(o));return o},R.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n},R.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},R.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new _(this,t,n)},R.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},R.prototype.max=function(t){return t.pos>this.pos?t:this},R.prototype.min=function(t){return t.pos<this.pos?t:this},R.prototype.toString=function(){for(var t="",i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset},R.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var path=[],n=0,r=e,o=t;;){var c=o.content.findIndex(r),l=c.index,h=c.offset,f=r-h;if(path.push(o,l,n+h),!f)break;if((o=o.child(l)).isText)break;r=f-1,n+=h+1}return new R(e,path,r)},R.resolveCached=function(t,e){for(var i=0;i<B.length;i++){var n=B[i];if(n.pos==e&&n.doc==t)return n}var r=B[F]=R.resolve(t,e);return F=(F+1)%I,r},Object.defineProperties(R.prototype,P);var B=[],F=0,I=12,_=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},z={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};z.start.get=function(){return this.$from.before(this.depth+1)},z.end.get=function(){return this.$to.after(this.depth+1)},z.parent.get=function(){return this.$from.node(this.depth)},z.startIndex.get=function(){return this.$from.index(this.depth)},z.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(_.prototype,z);var L=Object.create(null),j=function(t,e,content,n){this.type=t,this.attrs=e,this.content=content||d.empty,this.marks=n||x.none},V={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};V.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},V.childCount.get=function(){return this.content.childCount},j.prototype.child=function(t){return this.content.child(t)},j.prototype.maybeChild=function(t){return this.content.maybeChild(t)},j.prototype.forEach=function(t){this.content.forEach(t)},j.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},j.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},V.textContent.get=function(){return this.textBetween(0,this.content.size,"")},j.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},V.firstChild.get=function(){return this.content.firstChild},V.lastChild.get=function(){return this.content.lastChild},j.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},j.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},j.prototype.hasMarkup=function(t,e,n){return this.type==t&&w(this.attrs,e||t.defaultAttrs||L)&&x.sameSet(this.marks,n||x.none)},j.prototype.copy=function(content){return void 0===content&&(content=null),content==this.content?this:new this.constructor(this.type,this.attrs,content,this.marks)},j.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},j.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},j.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return S.empty;var r=this.resolve(t),o=this.resolve(e),c=n?0:r.sharedDepth(e),l=r.start(c),content=r.node(c).content.cut(r.pos-l,o.pos-l);return new S(content,r.depth-c,o.depth-c)},j.prototype.replace=function(t,e,n){return O(this.resolve(t),this.resolve(e),n)},j.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},j.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},j.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},j.prototype.resolve=function(t){return R.resolveCached(this,t)},j.prototype.resolveNoCache=function(t){return R.resolve(this,t)},j.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},V.isBlock.get=function(){return this.type.isBlock},V.isTextblock.get=function(){return this.type.isTextblock},V.inlineContent.get=function(){return this.type.inlineContent},V.isInline.get=function(){return this.type.isInline},V.isText.get=function(){return this.type.isText},V.isLeaf.get=function(){return this.type.isLeaf},V.isAtom.get=function(){return this.type.isAtom},j.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),U(this.marks,t)},j.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},j.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=d.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var c=this.contentMatchAt(t).matchFragment(n,r,o),l=c&&c.matchFragment(this.content,e);if(!l||!l.validEnd)return!1;for(var i=r;i<o;i++)if(!this.type.allowsMarks(n.child(i).marks))return!1;return!0},j.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),c=o&&o.matchFragment(this.content,e);return!!c&&c.validEnd},j.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},j.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},j.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},j.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var content=d.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,content,n)},Object.defineProperties(j.prototype,V);var $=function(t){function e(e,n,content,r){if(t.call(this,e,n,null,r),!content)throw new RangeError("Empty text nodes are not allowed");this.text=content}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):U(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(text){return text==this.text?this:new e(this.type,this.attrs,text,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var base=t.prototype.toJSON.call(this);return base.text=this.text,base},Object.defineProperties(e.prototype,n),e}(j);function U(t,e){for(var i=t.length-1;i>=0;i--)e=t[i].type.name+"("+e+")";return e}var W=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},J={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};W.parse=function(t,e){var n=new H(t,e);if(null==n.next)return W.empty;var r=Y(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var c=o.indexOf(n),l=c>-1&&o[c+1];et(t,r).forEach((function(t){l||o.push(n,l=[]),-1==l.indexOf(t)&&l.push(t)}))}}))}));for(var c=e[r.join(",")]=new W(r.indexOf(t.length-1)>-1),i=0;i<o.length;i+=2){var l=o[i+1].sort(tt);c.next.push(o[i],e[l.join(",")]||n(l))}return c}(et(t,0))}(function(t){var e=[[]];return o(function t(e,c){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,c))}),[]);if("seq"==e.type)for(var i=0;;i++){var l=t(e.exprs[i],c);if(i==e.exprs.length-1)return l;o(l,c=n())}else{if("star"==e.type){var h=n();return r(c,h),o(t(e.expr,h),h),[r(h)]}if("plus"==e.type){var f=n();return o(t(e.expr,c),f),o(t(e.expr,f),f),[r(f)]}if("opt"==e.type)return[r(c)].concat(t(e.expr,c));if("range"==e.type){for(var d=c,v=0;v<e.min;v++){var m=n();o(t(e.expr,d),m),d=m}if(-1==e.max)o(t(e.expr,d),d);else for(var y=e.min;y<e.max;y++){var w=n();r(d,w),o(t(e.expr,d),w),d=w}return[r(d)]}if("name"==e.type)return[r(c,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var i=0,n=[t];i<n.length;i++){for(var r=n[i],o=!r.validEnd,c=[],l=0;l<r.next.length;l+=2){var h=r.next[l],f=r.next[l+1];c.push(h.name),!o||h.isText||h.hasRequiredAttrs()||(o=!1),-1==n.indexOf(f)&&n.push(f)}o&&e.err("Only non-generatable nodes ("+c.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},W.prototype.matchType=function(t){for(var i=0;i<this.next.length;i+=2)if(this.next[i]==t)return this.next[i+1];return null},W.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,i=e;r&&i<n;i++)r=r.matchType(t.child(i).type);return r},J.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},J.defaultType.get=function(){for(var i=0;i<this.next.length;i+=2){var t=this.next[i];if(!t.isText&&!t.hasRequiredAttrs())return t}},W.prototype.compatible=function(t){for(var i=0;i<this.next.length;i+=2)for(var e=0;e<t.next.length;e+=2)if(this.next[i]==t.next[e])return!0;return!1},W.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(c,l){var h=c.matchFragment(t,n);if(h&&(!e||h.validEnd))return d.from(l.map((function(t){return t.createAndFill()})));for(var i=0;i<c.next.length;i+=2){var f=c.next[i],v=c.next[i+1];if(!f.isText&&!f.hasRequiredAttrs()&&-1==r.indexOf(v)){r.push(v);var m=o(v,l.concat(f));if(m)return m}}}(this,[])},W.prototype.findWrapping=function(t){for(var i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==t)return this.wrapCache[i+1];var e=this.computeWrapping(t);return this.wrapCache.push(t,e),e},W.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var c=[],l=r;l.type;l=l.via)c.push(l.type);return c.reverse()}for(var i=0;i<o.next.length;i+=2){var h=o.next[i];h.isLeaf||h.hasRequiredAttrs()||h.name in e||r.type&&!o.next[i+1].validEnd||(n.push({match:h.contentMatch,type:h,via:r}),e[h.name]=!0)}}},J.edgeCount.get=function(){return this.next.length>>1},W.prototype.edge=function(t){var i=t<<1;if(i>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[i],next:this.next[i+1]}},W.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var i=1;i<n.next.length;i+=2)-1==t.indexOf(n.next[i])&&e(n.next[i])}(this),t.map((function(e,i){for(var n=i+(e.validEnd?"*":" ")+" ",r=0;r<e.next.length;r+=2)n+=(r?", ":"")+e.next[r].name+"->"+t.indexOf(e.next[r+1]);return n})).join("\n")},Object.defineProperties(W.prototype,J),W.empty=new W(!0);var H=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},K={next:{configurable:!0}};function Y(t){var e=[];do{e.push(X(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function X(t){var e=[];do{e.push(G(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function G(t){for(var e=function(t){if(t.eat("(")){var e=Y(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var c in n){var l=n[c];l.groups.indexOf(e)>-1&&o.push(l)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Q(t,e)}return e}function Z(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Q(t,e){var n=Z(t),r=n;return t.eat(",")&&(r="}"!=t.next?Z(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function tt(a,b){return b-a}function et(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var c=o[i],l=c.term,h=c.to;l||-1!=n.indexOf(h)||e(h)}}(e),n.sort(tt)}function nt(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function ot(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var c=t[r];if(!c.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=c.default}n[r]=o}return n}function it(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new ct(t[n]);return e}K.next.get=function(){return this.tokens[this.pos]},H.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},H.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(H.prototype,K);var st=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=it(n.attrs),this.defaultAttrs=nt(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},at={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};at.isInline.get=function(){return!this.isBlock},at.isTextblock.get=function(){return this.isBlock&&this.inlineContent},at.isLeaf.get=function(){return this.contentMatch==W.empty},at.isAtom.get=function(){return this.isLeaf||this.spec.atom},st.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},st.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},st.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:ot(this.attrs,t)},st.prototype.create=function(t,content,e){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new j(this,this.computeAttrs(t),d.from(content),x.setFrom(e))},st.prototype.createChecked=function(t,content,e){if(content=d.from(content),!this.validContent(content))throw new RangeError("Invalid content for node "+this.name);return new j(this,this.computeAttrs(t),content,x.setFrom(e))},st.prototype.createAndFill=function(t,content,e){if(t=this.computeAttrs(t),(content=d.from(content)).size){var n=this.contentMatch.fillBefore(content);if(!n)return null;content=n.append(content)}var r=this.contentMatch.matchFragment(content).fillBefore(d.empty,!0);return r?new j(this,t,content.append(r),x.setFrom(e)):null},st.prototype.validContent=function(content){var t=this.contentMatch.matchFragment(content);if(!t||!t.validEnd)return!1;for(var i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0},st.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},st.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0},st.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,i=0;i<t.length;i++)this.allowsMarkType(t[i].type)?e&&e.push(t[i]):e||(e=t.slice(0,i));return e?e.length?e:x.empty:t},st.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new st(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(st.prototype,at);var ct=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ut={isRequired:{configurable:!0}};ut.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(ct.prototype,ut);var lt=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=it(r.attrs),this.rank=e,this.excluded=null;var o=nt(this.attrs);this.instance=o&&new x(this,o)};lt.prototype.create=function(t){return!t&&this.instance?this.instance:new x(this,ot(this.attrs,t))},lt.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new lt(t,r++,e,o)})),n},lt.prototype.removeFromSet=function(t){for(var i=0;i<t.length;i++)if(t[i].type==this)return t.slice(0,i).concat(t.slice(i+1));return t},lt.prototype.isInSet=function(t){for(var i=0;i<t.length;i++)if(t[i].type==this)return t[i]},lt.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var ht=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=f.a.from(t.nodes),this.spec.marks=f.a.from(t.marks),this.nodes=st.compile(this.spec.nodes,this),this.marks=lt.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],c=o.spec.content||"",l=o.spec.marks;o.contentMatch=n[c]||(n[c]=W.parse(c,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==l?null:l?ft(this,l.split(" ")):""!=l&&o.inlineContent?null:[]}for(var h in this.marks){var d=this.marks[h],v=d.spec.excludes;d.excluded=null==v?[d]:""==v?[]:ft(this,v.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ft(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i],mark=t.marks[r],o=mark;if(mark)n.push(mark);else for(var c in t.marks){var l=t.marks[c];("_"==r||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}ht.prototype.node=function(t,e,content,n){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof st))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,content,n)},ht.prototype.text=function(t,e){var n=this.nodes.text;return new $(n,n.defaultAttrs,t,x.setFrom(e))},ht.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},ht.prototype.nodeFromJSON=function(t){return j.fromJSON(this,t)},ht.prototype.markFromJSON=function(t){return x.fromJSON(this,t)},ht.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var pt=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};pt.prototype.parse=function(t,e){void 0===e&&(e={});var n=new Ct(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},pt.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new Ct(this,e,!0);return n.addAll(t,null,e.from,e.to),S.maxOpen(n.finish())},pt.prototype.matchTag=function(t,e){for(var i=0;i<this.tags.length;i++){var n=this.tags[i];if(kt(t,n.tag)&&(void 0===n.namespace||t.namespaceURI==n.namespace)&&(!n.context||e.matchesContext(n.context))){if(n.getAttrs){var r=n.getAttrs(t);if(!1===r)continue;n.attrs=r}return n}}},pt.prototype.matchStyle=function(t,e,n){for(var i=0;i<this.styles.length;i++){var r=this.styles[i];if(!(0!=r.style.indexOf(t)||r.context&&!n.matchesContext(r.context)||r.style.length>t.length&&(61!=r.style.charCodeAt(t.length)||r.style.slice(t.length+1)!=e))){if(r.getAttrs){var o=r.getAttrs(e);if(!1===o)continue;r.attrs=o}return r}}},pt.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,i=0;i<e.length;i++){var r=e[i];if((null==r.priority?50:r.priority)<n)break}e.splice(i,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Ot(t)),t.mark=e}))};for(var o in t.marks)r(o);var c;for(var l in t.nodes)c=void 0,(c=t.nodes[l].spec.parseDOM)&&c.forEach((function(t){n(t=Ot(t)),t.node=l}));return e},pt.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new pt(t,pt.schemaRules(t)))};var vt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},mt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},gt={ol:!0,ul:!0},yt=1,bt=2;function wt(t){return(t?yt:0)|("full"===t?bt:0)}var xt=function(t,e,n,r,o,c,l){this.type=t,this.attrs=e,this.solid=o,this.match=c||(4&l?null:t.contentMatch),this.options=l,this.content=[],this.marks=n,this.activeMarks=x.none,this.pendingMarks=r};xt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(d.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},xt.prototype.finish=function(t){if(!(this.options&yt)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var content=d.from(this.content);return!t&&this.match&&(content=content.append(this.match.fillBefore(d.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content},xt.prototype.applyPending=function(t){for(var i=0,e=this.pendingMarks;i<e.length;i++){var mark=e[i];(this.type?this.type.allowsMarkType(mark.type):Mt(mark.type,t))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}};var Ct=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,c=wt(e.preserveWhitespace)|(n?4:0);r=o?new xt(o.type,o.attrs,x.none,x.none,!0,e.topMatch||o.type.contentMatch,c):new xt(n?null:t.schema.topNodeType,null,x.none,x.none,!0,null,c),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},St={top:{configurable:!0},currentPos:{configurable:!0}};function kt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Ot(t){var e={};for(var n in t)e[n]=t[n];return e}function Mt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var c=[],l=function(t){c.push(t);for(var i=0;i<t.edgeCount;i++){var n=t.edge(i),r=n.type,o=n.next;if(r==e)return!0;if(c.indexOf(o)<0&&l(o))return!0}};return l(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var c=r(o);if(c)return c.v}}St.top.get=function(){return this.nodes[this.open]},Ct.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var style=t.getAttribute("style"),e=style?this.readStyles(function(style){var t,e=/\s*([\w-]+)\s*:\s*([^;]+)/g,n=[];for(;t=e.exec(style);)n.push(t[1],t[2].trim());return n}(style)):null,n=this.top;if(null!=e)for(var i=0;i<e.length;i++)this.addPendingMark(e[i]);if(this.addElement(t),null!=e)for(var r=0;r<e.length;r++)this.removePendingMark(e[r],n)}},Ct.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(n.options&yt)n.options&bt||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},Ct.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();gt.hasOwnProperty(e)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&gt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:mt.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip||n.closeParent){n&&n.closeParent?this.open=Math.max(0,this.open-1):n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,c=this.needsBlock;if(vt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=c}else this.addElementByRule(t,n)},Ct.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},Ct.prototype.readStyles=function(t){for(var e=x.none,i=0;i<t.length;i+=2){var n=this.parser.matchStyle(t[i],t[i+1],this);if(n){if(n.ignore)return null;e=this.parser.schema.marks[n.mark].create(n.attrs).addToSet(e)}}return e},Ct.prototype.addElementByRule=function(t,e){var n,r,mark,o=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(mark=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(mark));var c=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return o.insertNode(t)}));else{var l=e.contentElement;"string"==typeof l?l=t.querySelector(l):"function"==typeof l&&(l=l(t)),l||(l=t),this.findAround(t,l,!0),this.addAll(l,n)}n&&(this.sync(c),this.open--),mark&&this.removePendingMark(mark,c)},Ct.prototype.addAll=function(t,e,n,r){for(var o=n||0,c=n?t.childNodes[n]:t.firstChild,l=null==r?null:t.childNodes[r];c!=l;c=c.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(c),e&&vt.hasOwnProperty(c.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},Ct.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],c=o.findWrapping(t);if(c&&(!e||e.length>c.length)&&(e=c,n=o,!c.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0},Ct.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,i=0;i<t.marks.length;i++)n.type&&!n.type.allowsMarkType(t.marks[i].type)||(r=t.marks[i].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},Ct.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},Ct.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var c=null==r?-5&o.options:wt(r);4&o.options&&0==o.content.length&&(c|=4),this.nodes.push(new xt(t,e,o.activeMarks,o.pendingMarks,n,null,c)),this.open++},Ct.prototype.closeExtra=function(t){var i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}},Ct.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Ct.prototype.sync=function(t){for(var i=this.open;i>=0;i--)if(this.nodes[i]==t)return void(this.open=i)},St.currentPos.get=function(){this.closeExtra();for(var t=0,i=this.open;i>=0;i--){for(var content=this.nodes[i].content,e=content.length-1;e>=0;e--)t+=content[e].nodeSize;i&&t++}return t},Ct.prototype.findAtPoint=function(t,e){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&this.find[i].offset==e&&(this.find[i].pos=this.currentPos)},Ct.prototype.findInside=function(t){if(this.find)for(var i=0;i<this.find.length;i++)null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)},Ct.prototype.findAround=function(t,content,e){if(t!=content&&this.find)for(var i=0;i<this.find.length;i++){if(null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node))content.compareDocumentPosition(this.find[i].node)&(e?2:4)&&(this.find[i].pos=this.currentPos)}},Ct.prototype.findInText=function(t){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))},Ct.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),option=this.options.context,r=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),o=-(option?option.depth+1:0)+(r?0:1),c=function(i,t){for(;i>=0;i--){var l=n[i];if(""==l){if(i==n.length-1||0==i)continue;for(;t>=o;t--)if(c(i-1,t))return!0;return!1}var h=t>0||0==t&&r?e.nodes[t].type:option&&t>=o?option.node(t-o).type:null;if(!h||h.name!=l&&-1==h.groups.indexOf(l))return!1;t--}return!0};return c(n.length-1,this.open)},Ct.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Ct.prototype.addPendingMark=function(mark){this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)},Ct.prototype.removePendingMark=function(mark,t){for(var e=this.open;e>=0;e--){var n=this.nodes[e];if(n.pendingMarks.lastIndexOf(mark)>-1?n.pendingMarks=mark.removeFromSet(n.pendingMarks):n.activeMarks=mark.removeFromSet(n.activeMarks),n==t)break}},Object.defineProperties(Ct.prototype,St);var Nt=function(t,e){this.nodes=t||{},this.marks=e||{}};function At(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Et(t){return t.document||window.document}Nt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Et(e).createDocumentFragment());var o=n,c=null;return t.forEach((function(t){if(c||t.marks.length){c||(c=[]);for(var n=0,l=0;n<c.length&&l<t.marks.length;){var h=t.marks[l];if(r.marks[h.type.name]){if(!h.eq(c[n])||!1===h.type.spec.spanning)break;n+=2,l++}else l++}for(;n<c.length;)o=c.pop(),c.pop();for(;l<t.marks.length;){var f=t.marks[l++],d=r.serializeMark(f,t.isInline,e);d&&(c.push(f,o),o.appendChild(d.dom),o=d.contentDOM||d.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Nt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Nt.renderSpec(Et(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Nt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),i=t.marks.length-1;i>=0;i--){var r=this.serializeMark(t.marks[i],t.isInline,e);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n},Nt.prototype.serializeMark=function(mark,t,e){void 0===e&&(e={});var n=this.marks[mark.type.name];return n&&Nt.renderSpec(Et(e),n(mark,t))},Nt.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var c=null,l=n?t.createElementNS(n,r):t.createElement(r),h=e[1],f=1;if(h&&"object"==typeof h&&null==h.nodeType&&!Array.isArray(h))for(var d in f=2,h)if(null!=h[d]){var v=d.indexOf(" ");v>0?l.setAttributeNS(d.slice(0,v),d.slice(v+1),h[d]):l.setAttribute(d,h[d])}for(var i=f;i<e.length;i++){var m=e[i];if(0===m){if(i<e.length-1||i>f)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}var y=Nt.renderSpec(t,m,n),w=y.dom,x=y.contentDOM;if(l.appendChild(w),x){if(c)throw new RangeError("Multiple content holes");c=x}}return{dom:l,contentDOM:c}},Nt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Nt(this.nodesFromSchema(t),this.marksFromSchema(t)))},Nt.nodesFromSchema=function(t){var e=At(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Nt.marksFromSchema=function(t){return At(t.marks)};var Tt=n(183),Dt={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Rt=/Edge\/(\d+)/.exec(navigator.userAgent),Pt=/MSIE \d/.test(navigator.userAgent),Bt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Dt.mac=/Mac/.test(navigator.platform);var Ft=Dt.ie=!!(Pt||Bt||Rt);Dt.ie_version=Pt?document.documentMode||6:Bt?+Bt[1]:Rt?+Rt[1]:null,Dt.gecko=!Ft&&/gecko\/(\d+)/i.test(navigator.userAgent),Dt.gecko_version=Dt.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var It=!Ft&&/Chrome\/(\d+)/.exec(navigator.userAgent);Dt.chrome=!!It,Dt.chrome_version=It&&+It[1],Dt.ios=!Ft&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Dt.android=/Android \d/.test(navigator.userAgent),Dt.webkit="webkitFontSmoothing"in document.documentElement.style,Dt.safari=/Apple Computer/.test(navigator.vendor),Dt.webkit_version=Dt.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var _t=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},zt=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},Lt=function(t,e,n){var r=document.createRange();return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},jt=function(t,e,n,r){return n&&($t(t,e,n,r,-1)||$t(t,e,n,r,1))},Vt=/^(img|br|input|textarea|hr)$/i;function $t(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:qt(t))){var c=t.parentNode;if(1!=c.nodeType||Ut(t)||Vt.test(t.nodeName)||"false"==t.contentEditable)return!1;e=_t(t)+(o<0?0:1),t=c}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?qt(t):0}}}function qt(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Ut(t){for(var desc,e=t;e&&!(desc=e.pmViewDesc);e=e.parentNode);return desc&&desc.node&&desc.node.isBlock&&(desc.dom==t||desc.contentDOM==t)}var Wt=function(t){var e=t.isCollapsed;return e&&Dt.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function Jt(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function Ht(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function Kt(t,e){return"number"==typeof t?t:t[e]}function Yt(view,rect,t){for(var e=view.someProp("scrollThreshold")||0,n=view.someProp("scrollMargin")||5,r=view.dom.ownerDocument,o=r.defaultView,c=t||view.dom;c;c=zt(c))if(1==c.nodeType){var l=c==r.body||1!=c.nodeType,h=l?Ht(o):c.getBoundingClientRect(),f=0,d=0;if(rect.top<h.top+Kt(e,"top")?d=-(h.top-rect.top+Kt(n,"top")):rect.bottom>h.bottom-Kt(e,"bottom")&&(d=rect.bottom-h.bottom+Kt(n,"bottom")),rect.left<h.left+Kt(e,"left")?f=-(h.left-rect.left+Kt(n,"left")):rect.right>h.right-Kt(e,"right")&&(f=rect.right-h.right+Kt(n,"right")),f||d)if(l)o.scrollBy(f,d);else{var v=c.scrollLeft,m=c.scrollTop;d&&(c.scrollTop+=d),f&&(c.scrollLeft+=f);var y=c.scrollLeft-v,w=c.scrollTop-m;rect={left:rect.left-y,top:rect.top-w,right:rect.right-y,bottom:rect.bottom-w}}if(l)break}}function Xt(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=zt(t));return e}function Gt(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=n.dom,o=n.top,c=n.left;r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=c&&(r.scrollLeft=c)}}var Zt=null;function Qt(t,e){for(var n,r,o=2e8,c=0,l=e.top,h=e.top,f=t.firstChild,d=0;f;f=f.nextSibling,d++){var v=void 0;if(1==f.nodeType)v=f.getClientRects();else{if(3!=f.nodeType)continue;v=Lt(f).getClientRects()}for(var i=0;i<v.length;i++){var rect=v[i];if(rect.top<=l&&rect.bottom>=h){l=Math.max(rect.bottom,l),h=Math.min(rect.top,h);var m=rect.left>e.left?rect.left-e.left:rect.right<e.left?e.left-rect.right:0;if(m<o){n=f,o=m,r=m&&3==n.nodeType?{left:rect.right<e.left?rect.right:rect.left,top:e.top}:e,1==f.nodeType&&m&&(c=d+(e.left>=(rect.left+rect.right)/2?1:0));continue}}!n&&(e.left>=rect.right&&e.top>=rect.top||e.left>=rect.left&&e.top>=rect.bottom)&&(c=d+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);var rect=ne(r,1);if(rect.top!=rect.bottom&&te(e,rect))return{node:t,offset:i+(e.left>=(rect.left+rect.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:c}:Qt(n,r)}function te(t,rect){return t.left>=rect.left-1&&t.left<=rect.right+1&&t.top>=rect.top-1&&t.top<=rect.bottom+1}function ee(view,t){var e,n,r,o,c=view.root;if(c.caretPositionFromPoint)try{var l=c.caretPositionFromPoint(t.left,t.top);l&&(r=(e=l).offsetNode,o=e.offset)}catch(t){}if(!r&&c.caretRangeFromPoint){var h=c.caretRangeFromPoint(t.left,t.top);h&&(r=(n=h).startContainer,o=n.startOffset)}var f,d=c.elementFromPoint(t.left,t.top+1);if(!d||!view.dom.contains(1!=d.nodeType?d.parentNode:d)){var v=view.dom.getBoundingClientRect();if(!te(t,v))return null;if(!(d=function t(element,e,n){var r=element.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var c=element.childNodes[i];if(1==c.nodeType)for(var l=c.getClientRects(),h=0;h<l.length;h++){var rect=l[h];if(te(e,rect))return t(c,e,rect)}if((i=(i+1)%r)==o)break}return element}(view.dom,t,v)))return null}if(d=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(d,t),r){if(Dt.gecko&&1==r.nodeType&&(o=Math.min(o,r.childNodes.length))<r.childNodes.length){var m,y=r.childNodes[o];"IMG"==y.nodeName&&(m=y.getBoundingClientRect()).right<=t.left&&m.bottom>t.top&&o++}r==view.dom&&o==r.childNodes.length-1&&1==r.lastChild.nodeType&&t.top>r.lastChild.getBoundingClientRect().bottom?f=view.state.doc.content.size:0!=o&&1==r.nodeType&&"BR"==r.childNodes[o-1].nodeName||(f=function(view,t,e,n){for(var r=-1,o=t;o!=view.dom;){var desc=view.docView.nearestDesc(o,!0);if(!desc)return null;if(desc.node.isBlock&&desc.parent){var rect=desc.dom.getBoundingClientRect();if(rect.left>n.left||rect.top>n.top)r=desc.posBefore;else{if(!(rect.right<n.left||rect.bottom<n.top))break;r=desc.posAfter}}o=desc.dom.parentNode}return r>-1?r:view.docView.posFromDOM(t,e)}(view,r,o,t))}null==f&&(f=function(view,t,e){var n=Qt(t,e),r=n.node,o=n.offset,c=-1;if(1==r.nodeType&&!r.firstChild){var rect=r.getBoundingClientRect();c=rect.left!=rect.right&&e.left>(rect.left+rect.right)/2?1:-1}return view.docView.posFromDOM(r,o,c)}(view,d,t));var desc=view.docView.nearestDesc(d,!0);return{pos:f,inside:desc?desc.posAtStart-desc.border:-1}}function ne(object,t){var e=object.getClientRects();return e.length?e[t<0?0:e.length-1]:object.getBoundingClientRect()}function re(view,t){var e=view.docView.domFromPos(t),n=e.node,r=e.offset;if(3==n.nodeType&&(Dt.webkit||Dt.gecko)){var rect=ne(Lt(n,r,r),0);if(Dt.gecko&&r&&/\s/.test(n.nodeValue[r-1])&&r<n.nodeValue.length){var o=ne(Lt(n,r-1,r-1),-1);if(o.top==rect.top){var c=ne(Lt(n,r,r+1),-1);if(c.top!=rect.top)return oe(c,c.left<o.left)}}return rect}if(1==n.nodeType&&!view.state.doc.resolve(t).parent.inlineContent){var l,h=!0;if(r<n.childNodes.length){var f=n.childNodes[r];1==f.nodeType&&(l=f.getBoundingClientRect())}if(!l&&r){var d=n.childNodes[r-1];1==d.nodeType&&(l=d.getBoundingClientRect(),h=!1)}return function(rect,t){if(0==rect.height)return rect;var e=t?rect.top:rect.bottom;return{top:e,bottom:e,left:rect.left,right:rect.right}}(l||n.getBoundingClientRect(),h)}for(var v=-1;v<2;v+=2)if(v<0&&r){var m=void 0,y=3==n.nodeType?Lt(n,r-1,r):3==(m=n.childNodes[r-1]).nodeType?Lt(m):1==m.nodeType&&"BR"!=m.nodeName?m:null;if(y){var w=ne(y,1);if(w.top<w.bottom)return oe(w,!1)}}else if(v>0&&r<qt(n)){var x=void 0,C=3==n.nodeType?Lt(n,r,r+1):3==(x=n.childNodes[r]).nodeType?Lt(x):1==x.nodeType?x:null;if(C){var S=ne(C,-1);if(S.top<S.bottom)return oe(S,!0)}}return oe(ne(3==n.nodeType?Lt(n):n,0),!1)}function oe(rect,t){if(0==rect.width)return rect;var e=t?rect.left:rect.right;return{top:rect.top,bottom:rect.bottom,left:e,right:e}}function ie(view,t,e){var n=view.state,r=view.root.activeElement;n!=t&&view.updateState(t),r!=view.dom&&view.focus();try{return e()}finally{n!=t&&view.updateState(n),r!=view.dom&&r.focus()}}var se=/[\u0590-\u08ac]/;var ae=null,ce=null,ue=!1;function le(view,t,e){return ae==t&&ce==e?ue:(ae=t,ce=e,ue="up"==e||"down"==e?function(view,t,e){var n=t.selection,r="up"==e?n.$anchor.min(n.$head):n.$anchor.max(n.$head);return ie(view,t,(function(){for(var t=view.docView.domFromPos(r.pos).node;;){var n=view.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.dom;break}t=n.dom.parentNode}for(var o=re(view,r.pos),c=t.firstChild;c;c=c.nextSibling){var l=void 0;if(1==c.nodeType)l=c.getClientRects();else{if(3!=c.nodeType)continue;l=Lt(c,0,c.nodeValue.length).getClientRects()}for(var i=0;i<l.length;i++){var h=l[i];if(h.bottom>h.top&&("up"==e?h.bottom<o.top+1:h.top>o.bottom-1))return!1}}return!0}))}(view,t,e):function(view,t,e){var n=t.selection.$head;if(!n.parent.isTextblock)return!1;var r=n.parentOffset,o=!r,c=r==n.parent.content.size,l=getSelection();return se.test(n.parent.textContent)&&l.modify?ie(view,t,(function(){var t=l.getRangeAt(0),r=l.focusNode,o=l.focusOffset,c=l.caretBidiLevel;l.modify("move",e,"character");var h=!(n.depth?view.docView.domAfterPos(n.before()):view.dom).contains(1==l.focusNode.nodeType?l.focusNode:l.focusNode.parentNode)||r==l.focusNode&&o==l.focusOffset;return l.removeAllRanges(),l.addRange(t),null!=c&&(l.caretBidiLevel=c),h})):"left"==e||"backward"==e?o:c}(view,t,e))}var he=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},fe={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0}};he.prototype.matchesWidget=function(){return!1},he.prototype.matchesMark=function(){return!1},he.prototype.matchesNode=function(){return!1},he.prototype.matchesHack=function(){return!1},fe.beforePosition.get=function(){return!1},he.prototype.parseRule=function(){return null},he.prototype.stopEvent=function(){return!1},fe.size.get=function(){for(var t=0,i=0;i<this.children.length;i++)t+=this.children[i].size;return t},fe.border.get=function(){return 0},he.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var i=0;i<this.children.length;i++)this.children[i].destroy()},he.prototype.posBeforeChild=function(t){for(var i=0,e=this.posAtStart;i<this.children.length;i++){var n=this.children[i];if(n==t)return e;e+=n.size}},fe.posBefore.get=function(){return this.parent.posBeforeChild(this)},fe.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},fe.posAfter.get=function(){return this.posBefore+this.size},fe.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},he.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,desc;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(desc=r.pmViewDesc)||desc.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(desc)+desc.size:this.posAtStart}var o,c;if(t==this.contentDOM)o=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&(!(c=o.pmViewDesc)||c.parent!=this);)o=o.nextSibling;return o?this.posBeforeChild(c):this.posAtEnd}var l;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))l=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var h=t;;h=h.parentNode){if(h==this.dom){l=!1;break}if(h.parentNode.firstChild!=h)break}if(null==l&&e==t.childNodes.length)for(var f=t;;f=f.parentNode){if(f==this.dom){l=!0;break}if(f.parentNode.lastChild!=f)break}}return(null==l?n>0:l)?this.posAtEnd:this.posAtStart},he.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var desc=this.getDesc(r);if(desc&&(!e||desc.node)){if(!n||!desc.nodeDOM||(1==desc.nodeDOM.nodeType?desc.nodeDOM.contains(1==t.nodeType?t:t.parentNode):desc.nodeDOM==t))return desc;n=!1}}},he.prototype.getDesc=function(t){for(var desc=t.pmViewDesc,e=desc;e;e=e.parent)if(e==this)return desc},he.prototype.posFromDOM=function(t,e,n){for(var r=t;;r=r.parentNode){var desc=this.getDesc(r);if(desc)return desc.localPosFromDOM(t,e,n)}},he.prototype.descAt=function(t){for(var i=0,e=0;i<this.children.length;i++){var n=this.children[i],r=e+n.size;if(e==t&&r!=e){for(;!n.border&&n.children.length;)n=n.children[0];return n}if(t<r)return n.descAt(t-e-n.border);e=r}},he.prototype.domFromPos=function(t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var e=0,i=0;;i++){if(e==t){for(;i<this.children.length&&(this.children[i].beforePosition||this.children[i].dom.parentNode!=this.contentDOM);)i++;return{node:this.contentDOM,offset:i==this.children.length?this.contentDOM.childNodes.length:_t(this.children[i].dom)}}if(i==this.children.length)throw new Error("Invalid position "+t);var n=this.children[i],r=e+n.size;if(t<r)return n.domFromPos(t-e-n.border);e=r}},he.prototype.parseRange=function(t,e,base){if(void 0===base&&(base=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var n=-1,r=-1,o=base,i=0;;i++){var c=this.children[i],l=o+c.size;if(-1==n&&t<=l){var h=o+c.border;if(t>=h&&e<=l-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,e,h);t=o;for(var f=i;f>0;f--){var d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){n=_t(d.dom)+1;break}t-=d.size}-1==n&&(n=0)}if(n>-1&&e<=l){e=l;for(var v=i+1;v<this.children.length;v++){var m=this.children[v];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(-1)){r=_t(m.dom);break}e+=m.size}-1==r&&(r=this.contentDOM.childNodes.length);break}o=l}return{node:this.contentDOM,from:t,to:e,fromOffset:n,toOffset:r}},he.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},he.prototype.domAfterPos=function(t){var e=this.domFromPos(t),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},he.prototype.setSelection=function(t,head,e,n){for(var r=Math.min(t,head),o=Math.max(t,head),i=0,c=0;i<this.children.length;i++){var l=this.children[i],h=c+l.size;if(r>c&&o<h)return l.setSelection(t-c-l.border,head-c-l.border,e,n);c=h}var f=this.domFromPos(t),d=this.domFromPos(head),v=e.getSelection();if(n||!jt(f.node,f.offset,v.anchorNode,v.anchorOffset)||!jt(d.node,d.offset,v.focusNode,v.focusOffset)){var m=!1;if(v.extend||t==head){v.collapse(f.node,f.offset);try{t!=head&&v.extend(d.node,d.offset),m=!0}catch(t){if(!(t instanceof DOMException))throw t}}if(!m){if(t>head){var y=f;f=d,d=y}var w=document.createRange();w.setEnd(d.node,d.offset),w.setStart(f.node,f.offset),v.removeAllRanges(),v.addRange(w)}}},he.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},fe.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},he.prototype.markDirty=function(t,e){for(var n=0,i=0;i<this.children.length;i++){var r=this.children[i],o=n+r.size;if(n==o?t<=o&&e>=n:t<o&&e>n){var c=n+r.border,l=o-r.border;if(t>=c&&e<=l)return this.dirty=t==n||e==o?2:1,void(t!=c||e!=l||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-c,e-c):r.dirty=3);r.dirty=3}n=o}this.dirty=2},he.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},Object.defineProperties(he.prototype,fe);var pe=[],de=function(t){function e(e,n,view,r){var o,c=n.type.toDOM;if("function"==typeof c&&(c=c(view,(function(){return o?o.parent?o.parent.posBeforeChild(o):void 0:r}))),!n.type.spec.raw){if(1!=c.nodeType){var l=document.createElement("span");l.appendChild(c),c=l}c.contentEditable=!1,c.classList.add("ProseMirror-widget")}t.call(this,e,pe,c,null),this.widget=n,o=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},Object.defineProperties(e.prototype,n),e}(he),ve=function(t){function e(e,n,r,text){t.call(this,e,pe,n,null),this.textDOM=r,this.text=text}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(he),me=function(t){function e(e,mark,n,r){t.call(this,e,[],n,r),this.mark=mark}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,mark,n,view){var r=view.nodeViews[mark.type.name],o=r&&r(mark,view,n);return o&&o.dom||(o=Nt.renderSpec(document,mark.type.spec.toDOM(mark,n))),new e(t,mark,o.dom,o.contentDOM||o.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(mark){return 3!=this.dirty&&this.mark.eq(mark)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,view){var r=e.create(this.parent,this.mark,!0,view),o=this.children,c=this.size;n<c&&(o=Re(o,n,c,view)),t>0&&(o=Re(o,0,t,view));for(var i=0;i<o.length;i++)o[i].parent=r;return r.children=o,r},e}(he),ge=function(t){function e(e,n,r,o,c,l,h,view,f){t.call(this,e,n.isLeaf?pe:[],c,l),this.nodeDOM=h,this.node=n,this.outerDeco=r,this.innerDeco=o,l&&this.updateChildren(view,f)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0}};return e.create=function(t,n,r,o,view,c){var l,h,f=view.nodeViews[n.type.name],d=f&&f(n,view,(function(){return h?h.parent?h.parent.posBeforeChild(h):void 0:c}),r),v=d&&d.dom,m=d&&d.contentDOM;if(n.isText)if(v){if(3!=v.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else v=document.createTextNode(n.text);else v||(v=(l=Nt.renderSpec(document,n.type.spec.toDOM(n))).dom,m=l.contentDOM);m||n.isText||"BR"==v.nodeName||(v.hasAttribute("contenteditable")||(v.contentEditable=!1),n.type.spec.draggable&&(v.draggable=!0));var y=v;return v=Ne(v,r,n),d?h=new xe(t,n,r,o,v,m,y,d,view,c+1):n.isText?new be(t,n,r,o,v,y,view):new e(t,n,r,o,v,m,y,view,c+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?d.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Ae(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(view,t){var e=this,n=this.node.inlineContent,r=t,o=n&&view.composing&&this.localCompositionNode(view,t),c=new Te(this,o&&o.node);!function(t,e,n,r){var o=e.locals(t),c=0;if(0==o.length){for(var i=0;i<t.childCount;i++){var l=t.child(i);r(l,o,e.forChild(c,l),i),c+=l.nodeSize}return}for(var h=0,f=[],d=null,v=0;;){if(h<o.length&&o[h].to==c){for(var m=o[h++],y=void 0;h<o.length&&o[h].to==c;)(y||(y=[m])).push(o[h++]);if(y){y.sort(De);for(var w=0;w<y.length;w++)n(y[w],v,!!d)}else n(m,v,!!d)}var x=void 0,C=void 0;if(d)C=-1,x=d,d=null;else{if(!(v<t.childCount))break;C=v,x=t.child(v++)}for(var S=0;S<f.length;S++)f[S].to<=c&&f.splice(S--,1);for(;h<o.length&&o[h].from==c;)f.push(o[h++]);var k=c+x.nodeSize;if(x.isText){var O=k;h<o.length&&o[h].from<O&&(O=o[h].from);for(var M=0;M<f.length;M++)f[M].to<O&&(O=f[M].to);O<k&&(d=x.cut(O-c),x=x.cut(0,O-c),k=O,C=-1)}r(x,f.length?f.slice():pe,e.forChild(c,x),C),c=k}}(this.node,this.innerDeco,(function(t,i,o){t.spec.marks?c.syncToMarks(t.spec.marks,n,view):t.type.side>=0&&!o&&c.syncToMarks(i==e.node.childCount?x.none:e.node.child(i).marks,n,view),c.placeWidget(t,view,r)}),(function(t,e,o,i){c.syncToMarks(t.marks,n,view),c.findNodeMatch(t,e,o,i)||c.updateNextNode(t,e,o,view,i)||c.addNode(t,e,o,view,r),r+=t.nodeSize})),c.syncToMarks(pe,n,view),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||2==this.dirty)&&(o&&this.protectLocalComposition(view,o),this.renderChildren())},e.prototype.renderChildren=function(){!function t(e,n){for(var r=e.firstChild,i=0;i<n.length;i++){var desc=n[i],o=desc.dom;if(o.parentNode==e){for(;o!=r;)r=Ee(r);r=r.nextSibling}else e.insertBefore(o,r);if(desc instanceof me){var c=r?r.previousSibling:e.lastChild;t(desc.contentDOM,desc.children),r=c?c.nextSibling:e.firstChild}}for(;r;)r=Ee(r)}(this.contentDOM,this.children),Dt.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom)},e.prototype.localCompositionNode=function(view,t){var e=view.state.selection,n=e.from,r=e.to;if(!(!(view.state.selection instanceof h.TextSelection)||n<t||r>t+this.node.content.size)){var o=view.root.getSelection(),c=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=qt(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(o.focusNode,o.focusOffset);if(c&&this.dom.contains(c.parentNode)){var text=c.nodeValue,l=function(t,text,e,n){for(var i=0,r=0;i<t.childCount&&r<=n;){var o=t.child(i++),c=r;if(r+=o.nodeSize,o.isText){for(var l=o.text;i<t.childCount;){var h=t.child(i++);if(r+=h.nodeSize,!h.isText)break;l+=h.text}if(r>=e){var f=l.lastIndexOf(text,n-c);if(f>=0&&f+text.length+c>=e)return c+f}}}return-1}(this.node.content,text,n-t,r-t);return l<0?null:{node:c,pos:l,text:text}}}},e.prototype.protectLocalComposition=function(view,t){var e=t.node,n=t.pos,text=t.text;if(!this.getDesc(e)){for(var r=e;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=null)}var desc=new ve(this,r,e,text);view.compositionNodes.push(desc),this.children=Re(this.children,n,n+text.length,view,desc)}},e.prototype.update=function(t,e,n,view){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,view),!0)},e.prototype.updateInner=function(t,e,n,view){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(view,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!Ae(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Oe(this.dom,this.nodeDOM,ke(this.outerDeco,this.node,e),ke(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},Object.defineProperties(e.prototype,n),e}(he);function ye(t,e,n,r,view){return Ne(r,e,t),new ge(null,t,e,n,r,r,r,view,0)}var be=function(t){function e(e,n,r,o,c,l,view){t.call(this,e,n,r,o,c,null,l,view)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{skip:this.nodeDOM.parentNode||!0}},e.prototype.update=function(t,e){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,view){var r=this.node.cut(t,n),o=document.createTextNode(r.text);return new e(this.parent,r,this.outerDeco,this.innerDeco,o,o,view)},e}(ge),we=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},e}(he),xe=function(t){function e(e,n,r,o,c,l,h,f,view,d){t.call(this,e,n,r,o,c,l,h,view,d),this.spec=f}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,view){if(3==this.dirty)return!1;if(this.spec.update){var o=this.spec.update(e,n);return o&&this.updateInner(e,n,r,view),o}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,view)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,head,n,r){this.spec.setSelection?this.spec.setSelection(e,head,n):t.prototype.setSelection.call(this,e,head,n,r)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(ge);function Ce(t){t&&(this.nodeName=t)}Ce.prototype=Object.create(null);var Se=[new Ce];function ke(t,e,n){if(0==t.length)return Se;for(var r=n?Se[0]:new Ce,o=[r],i=0;i<t.length;i++){var c=t[i].type.attrs,l=r;if(c)for(var h in c.nodeName&&o.push(l=new Ce(c.nodeName)),c){var f=c[h];null!=f&&(n&&1==o.length&&o.push(l=r=new Ce(e.isInline?"span":"div")),"class"==h?l.class=(l.class?l.class+" ":"")+f:"style"==h?l.style=(l.style?l.style+";":"")+f:"nodeName"!=h&&(l[h]=f))}}return o}function Oe(t,e,n,r){if(n==Se&&r==Se)return e;for(var o=e,i=0;i<r.length;i++){var c=r[i],l=n[i];if(i){var h=void 0;l&&l.nodeName==c.nodeName&&o!=t&&(h=o.parentNode)&&h.tagName.toLowerCase()==c.nodeName?o=h:((h=document.createElement(c.nodeName)).appendChild(o),l=Se[0],o=h)}Me(o,l||Se[0],c)}return o}function Me(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var c=e.class?e.class.split(" "):pe,l=n.class?n.class.split(" "):pe,i=0;i<c.length;i++)-1==l.indexOf(c[i])&&t.classList.remove(c[i]);for(var h=0;h<l.length;h++)-1==c.indexOf(l[h])&&t.classList.add(l[h])}if(e.style!=n.style){if(e.style)for(var f,d=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;f=d.exec(e.style);)t.style.removeProperty(f[1]);n.style&&(t.style.cssText+=n.style)}}function Ne(t,e,n){return Oe(t,t,Se,ke(e,n,1!=t.nodeType))}function Ae(a,b){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].type.eq(b[i].type))return!1;return!0}function Ee(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var Te=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var pre=function(t,e){for(var n=[],r=t.childCount,i=e.length-1;r>0&&i>=0;i--){var desc=e[i],o=desc.node;if(o){if(o!=t.child(r-1))break;n.push(desc),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=pre.nodes,this.preMatchOffset=pre.offset};function De(a,b){return a.type.side-b.type.side}function Re(t,e,n,view,r){for(var o=[],i=0,c=0;i<t.length;i++){var l=t[i],h=c,f=c+=l.size;h>=n||f<=e?o.push(l):(h<e&&o.push(l.slice(0,e-h,view)),r&&(o.push(r),r=null),f>n&&o.push(l.slice(n-h,l.size,view)))}return o}function Pe(t,e){var n=t.selection,r=n.$anchor,o=n.$head,c=e>0?r.max(o):r.min(o),l=c.parent.inlineContent?c.depth?t.doc.resolve(e>0?c.after():c.before()):null:c;return l&&h.Selection.findFrom(l,e)}function Be(view,t){return view.dispatch(view.state.tr.setSelection(t).scrollIntoView()),!0}function Fe(view,t,e){var n=view.state.selection;if(n instanceof h.TextSelection){if(!n.empty||e.indexOf("s")>-1)return!1;if(view.endOfTextblock(t>0?"right":"left")){var r=Pe(view.state,t);return!!(r&&r instanceof h.NodeSelection)&&Be(view,r)}var desc,o=n.$head,c=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!c||c.isText)return!1;var l=t<0?o.pos-c.nodeSize:o.pos;return!!(c.isAtom||(desc=view.docView.descAt(l))&&!desc.contentDOM)&&(h.NodeSelection.isSelectable(c)?Be(view,new h.NodeSelection(t<0?view.state.doc.resolve(o.pos-c.nodeSize):o)):!!Dt.webkit&&Be(view,new h.TextSelection(view.state.doc.resolve(t<0?l:l+c.nodeSize))))}if(n instanceof h.NodeSelection&&n.node.isInline)return Be(view,new h.TextSelection(t>0?n.$to:n.$from));var f=Pe(view.state,t);return!!f&&Be(view,f)}function Ie(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function _e(t){var desc=t.pmViewDesc;return desc&&0==desc.size&&(t.nextSibling||"BR"!=t.nodeName)}function ze(view){var t=view.root.getSelection(),e=t.focusNode,n=t.focusOffset;if(e){var r,o,c=!1;for(Dt.gecko&&1==e.nodeType&&n<Ie(e)&&_e(e.childNodes[n])&&(c=!0);;)if(n>0){if(1!=e.nodeType)break;var l=e.childNodes[n-1];if(_e(l))r=e,o=--n;else{if(3!=l.nodeType)break;n=(e=l).nodeValue.length}}else{if(je(e))break;for(var h=e.previousSibling;h&&_e(h);)r=e.parentNode,o=_t(h),h=h.previousSibling;if(h)n=Ie(e=h);else{if((e=e.parentNode)==view.dom)break;n=0}}c?Ve(view,t,e,n):r&&Ve(view,t,r,o)}}function Le(view){var t=view.root.getSelection(),e=t.focusNode,n=t.focusOffset;if(e){for(var r,o,c=Ie(e);;)if(n<c){if(1!=e.nodeType)break;if(!_e(e.childNodes[n]))break;r=e,o=++n}else{if(je(e))break;for(var l=e.nextSibling;l&&_e(l);)r=l.parentNode,o=_t(l)+1,l=l.nextSibling;if(l)n=0,c=Ie(e=l);else{if((e=e.parentNode)==view.dom)break;n=c=0}}r&&Ve(view,t,r,o)}}function je(t){var desc=t.pmViewDesc;return desc&&desc.node&&desc.node.isBlock}function Ve(view,t,e,n){if(Wt(t)){var r=document.createRange();r.setEnd(e,n),r.setStart(e,n),t.removeAllRanges(),t.addRange(r)}else t.extend&&t.extend(e,n);view.domObserver.setCurSelection()}function $e(view,t,e){var n=view.state.selection;if(n instanceof h.TextSelection&&!n.empty||e.indexOf("s")>-1)return!1;var r=n.$from,o=n.$to;if(!r.parent.inlineContent||view.endOfTextblock(t<0?"up":"down")){var c=Pe(view.state,t);if(c&&c instanceof h.NodeSelection)return Be(view,c)}if(!r.parent.inlineContent){var l=h.Selection.findFrom(t<0?r:o,t);return!l||Be(view,l)}return!1}function qe(view,t){if(!(view.state.selection instanceof h.TextSelection))return!0;var e=view.state.selection,n=e.$head,r=e.$anchor,o=e.empty;if(!n.sameParent(r))return!0;if(!o)return!1;if(view.endOfTextblock(t>0?"forward":"backward"))return!0;var c=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(c&&!c.isText){var tr=view.state.tr;return t<0?tr.delete(n.pos-c.nodeSize,n.pos):tr.delete(n.pos,n.pos+c.nodeSize),view.dispatch(tr),!0}return!1}function Ue(view,t,e){view.domObserver.stop(),t.contentEditable=e,view.domObserver.start()}function We(view,t){var code=t.keyCode,e=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(t);return 8==code||Dt.mac&&72==code&&"c"==e?qe(view,-1)||ze(view):46==code||Dt.mac&&68==code&&"c"==e?qe(view,1)||Le(view):13==code||27==code||(37==code?Fe(view,-1,e)||ze(view):39==code?Fe(view,1,e)||Le(view):38==code?$e(view,-1,e)||ze(view):40==code?function(view){if(Dt.chrome&&!(view.state.selection.$head.parentOffset>0)){var t=view.root.getSelection(),e=t.focusNode,n=t.focusOffset;if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){var r=e.firstChild;Ue(view,r,!0),setTimeout((function(){return Ue(view,r,!1)}),20)}}}(view)||$e(view,1,e)||Le(view):e==(Dt.mac?"m":"c")&&(66==code||73==code||89==code||90==code))}function Je(view,t){var e,n,r=view.root.getSelection(),o=view.state.doc,c=view.docView.nearestDesc(r.focusNode),l=c&&0==c.size,head=view.docView.posFromDOM(r.focusNode,r.focusOffset),f=o.resolve(head);if(Wt(r)){for(e=f;c&&!c.node;)c=c.parent;if(c&&c.node.isAtom&&h.NodeSelection.isSelectable(c.node)&&c.parent&&(!c.node.isInline||!function(t,e,n){for(var r=0==e,o=e==qt(t);r||o;){if(t==n)return!0;var c=_t(t);if(!(t=t.parentNode))return!1;r=r&&0==c,o=o&&c==qt(t)}}(r.focusNode,r.focusOffset,c.dom))){var d=c.posBefore;n=new h.NodeSelection(head==d?f:o.resolve(d))}}else e=o.resolve(view.docView.posFromDOM(r.anchorNode,r.anchorOffset));n||(n=tn(view,e,f,"pointer"==t||view.state.selection.head<f.pos&&!l?1:-1));return n}function He(view,t){var e=view.state.selection;if(Ze(view,e),view.editable?view.hasFocus():en(view)&&document.activeElement.contains(view.dom)){if(view.domObserver.disconnectSelection(),view.cursorWrapper)!function(view){var t=view.root.getSelection(),e=document.createRange(),n=view.cursorWrapper.dom,img="IMG"==n.nodeName;img?e.setEnd(n.parentNode,_t(n)+1):e.setEnd(n,0);e.collapse(!1),t.removeAllRanges(),t.addRange(e),!img&&!view.state.selection.visible&&Dt.ie&&Dt.ie_version<=11&&(n.disabled=!0,n.disabled=!1)}(view);else{var n,r,o=e.anchor,head=e.head;!Ke||e instanceof h.TextSelection||(e.$from.parent.inlineContent||(n=Ye(view,e.from)),e.empty||e.$from.parent.inlineContent||(r=Ye(view,e.to))),view.docView.setSelection(o,head,view.root,t),Ke&&(n&&Ge(n),r&&Ge(r)),e.visible?view.dom.classList.remove("ProseMirror-hideselection"):(view.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(view){var t=view.dom.ownerDocument;t.removeEventListener("selectionchange",view.hideSelectionGuard);var e=view.root.getSelection(),n=e.anchorNode,r=e.anchorOffset;t.addEventListener("selectionchange",view.hideSelectionGuard=function(){e.anchorNode==n&&e.anchorOffset==r||(t.removeEventListener("selectionchange",view.hideSelectionGuard),view.dom.classList.remove("ProseMirror-hideselection"))})}(view))}view.domObserver.setCurSelection(),view.domObserver.connectSelection()}}Te.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},Te.prototype.destroyBetween=function(t,e){if(t!=e){for(var i=t;i<e;i++)this.top.children[i].destroy();this.top.children.splice(t,e-t),this.changed=!0}},Te.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Te.prototype.syncToMarks=function(t,e,view){for(var n=0,r=this.stack.length>>1,o=Math.min(r,t.length);n<o&&(n==r-1?this.top:this.stack[n+1<<1]).matchesMark(t[n])&&!1!==t[n].type.spec.spanning;)n++;for(;n<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);for(var c=-1,i=this.index;i<Math.min(this.index+3,this.top.children.length);i++)if(this.top.children[i].matchesMark(t[r])){c=i;break}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{var l=me.create(this.top,t[r],e,view);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,r++}},Te.prototype.findNodeMatch=function(t,e,n,r){var o=-1,c=r<0?void 0:this.getPreMatch(r),l=this.top.children;if(c&&c.matchesNode(t,e,n))o=l.indexOf(c);else for(var i=this.index,h=Math.min(l.length,i+5);i<h;i++){var f=l[i];if(f.matchesNode(t,e,n)&&this.preMatched.indexOf(f)<0){o=i;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},Te.prototype.updateNextNode=function(t,e,n,view,r){for(var i=this.index;i<this.top.children.length;i++){var o=this.top.children[i];if(o instanceof ge){var c=this.preMatched.indexOf(o);if(c>-1&&c+this.preMatchOffset!=r)return!1;var l=o.dom;if(!(this.lock&&(l==this.lock||1==l.nodeType&&l.contains(this.lock.parentNode))&&!(t.isText&&o.node&&o.node.isText&&o.nodeDOM.nodeValue==t.text&&3!=o.dirty&&Ae(e,o.outerDeco)))&&o.update(t,e,n,view))return this.destroyBetween(this.index,i),o.dom!=l&&(this.changed=!0),this.index++,!0;break}}return!1},Te.prototype.addNode=function(t,e,n,view,r){this.top.children.splice(this.index++,0,ge.create(this.top,t,e,n,view,r)),this.changed=!0},Te.prototype.placeWidget=function(t,view,e){if(this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(t))this.index++;else{var desc=new de(this.top,t,view,e);this.top.children.splice(this.index++,0,desc),this.changed=!0}},Te.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof me;)t=t.children[t.children.length-1];if(!t||!(t instanceof be)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new we(this.top,pe,e,null)),this.changed=!0}};var Ke=Dt.safari||Dt.chrome&&Dt.chrome_version<63;function Ye(view,t){var e=view.docView.domFromPos(t),n=e.node,r=e.offset,o=r<n.childNodes.length?n.childNodes[r]:null,c=r?n.childNodes[r-1]:null;if(Dt.safari&&o&&"false"==o.contentEditable)return Xe(o);if(!(o&&"false"!=o.contentEditable||c&&"false"!=c.contentEditable)){if(o)return Xe(o);if(c)return Xe(c)}}function Xe(element){return element.contentEditable="true",Dt.safari&&element.draggable&&(element.draggable=!1,element.wasDraggable=!0),element}function Ge(element){element.contentEditable="false",element.wasDraggable&&(element.draggable=!0,element.wasDraggable=null)}function Ze(view,t){if(t instanceof h.NodeSelection){var desc=view.docView.descAt(t.from);desc!=view.lastSelectedViewDesc&&(Qe(view),desc&&desc.selectNode(),view.lastSelectedViewDesc=desc)}else Qe(view)}function Qe(view){view.lastSelectedViewDesc&&(view.lastSelectedViewDesc.parent&&view.lastSelectedViewDesc.deselectNode(),view.lastSelectedViewDesc=null)}function tn(view,t,e,n){return view.someProp("createSelectionBetween",(function(n){return n(view,t,e)}))||h.TextSelection.between(t,e,n)}function en(view){var t=view.root.getSelection();if(!t.anchorNode)return!1;try{return view.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(view.editable||view.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(t){return!1}}function nn(t){var desc=t.pmViewDesc;if(desc)return desc.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Dt.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(t.parentNode.lastChild==t||Dt.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function rn(view,t,e,n,r){if(t<0){var o=view.lastSelectionTime>Date.now()-50?view.lastSelectionOrigin:null,c=Je(view,o);if(!view.state.selection.eq(c)){var l=view.state.tr.setSelection(c);"pointer"==o?l.setMeta("pointer",!0):"key"==o&&l.scrollIntoView(),view.dispatch(l)}}else{var f=view.state.doc.resolve(t),v=f.sharedDepth(e);t=f.before(v+1),e=view.state.doc.resolve(e).after(v+1);var m,y,w=view.state.selection,x=function(view,t,e){var n=view.docView.parseRange(t,e),r=n.node,o=n.fromOffset,c=n.toOffset,l=n.from,h=n.to,f=view.root.getSelection(),d=null,v=f.anchorNode;if(v&&view.dom.contains(1==v.nodeType?v:v.parentNode)&&(d=[{node:v,offset:f.anchorOffset}],Wt(f)||d.push({node:f.focusNode,offset:f.focusOffset})),Dt.chrome&&8===view.lastKeyCode)for(var m=c;m>o;m--){var y=r.childNodes[m-1],desc=y.pmViewDesc;if("BR"==y.nodeType&&!desc){c=m;break}if(!desc||desc.size)break}var w=view.state.doc,x=view.someProp("domParser")||pt.fromSchema(view.state.schema),C=w.resolve(l),S=null,k=x.parse(r,{topNode:C.parent,topMatch:C.parent.contentMatchAt(C.index()),topOpen:!0,from:o,to:c,preserveWhitespace:!C.parent.type.spec.code||"full",editableContent:!0,findPositions:d,ruleFromNode:nn,context:C});if(d&&null!=d[0].pos){var O=d[0].pos,head=d[1]&&d[1].pos;null==head&&(head=O),S={anchor:O+l,head:head+l}}return{doc:k,sel:S,from:l,to:h}}(view,t,e),C=view.state.doc,S=C.slice(x.from,x.to);8===view.lastKeyCode&&Date.now()-100<view.lastKeyCodeTime?(m=view.state.selection.to,y="end"):(m=view.state.selection.from,y="start"),view.lastKeyCode=null;var k=function(a,b,t,e,n){var r=a.findDiffStart(b,t);if(null==r)return null;var o=a.findDiffEnd(b,t+a.size,t+b.size),c=o.a,l=o.b;if("end"==n){var h=Math.max(0,r-Math.min(c,l));e-=c+h-r}if(c<r&&a.size<b.size){l=(r-=e<=r&&e>=c?r-e:0)+(l-c),c=r}else if(l<r){c=(r-=e<=r&&e>=l?r-e:0)+(c-l),l=r}return{start:r,endA:c,endB:l}}(S.content,x.doc.content,x.from,m,y);if(!k){if(!(n&&w instanceof h.TextSelection&&!w.empty&&w.$head.sameParent(w.$anchor))||view.composing||x.sel&&x.sel.anchor!=x.sel.head){if(x.sel){var O=on(view,view.state.doc,x.sel);O&&!O.eq(view.state.selection)&&view.dispatch(view.state.tr.setSelection(O))}return}k={start:w.from,endA:w.to,endB:w.to}}view.domChangeCount++,view.state.selection.from<view.state.selection.to&&k.start==k.endB&&view.state.selection instanceof h.TextSelection&&(k.start>view.state.selection.from&&k.start<=view.state.selection.from+2?k.start=view.state.selection.from:k.endA<view.state.selection.to&&k.endA>=view.state.selection.to-2&&(k.endB+=view.state.selection.to-k.endA,k.endA=view.state.selection.to)),Dt.ie&&Dt.ie_version<=11&&k.endB==k.start+1&&k.endA==k.start&&k.start>x.from&&"  "==x.doc.textBetween(k.start-x.from-1,k.start-x.from+1)&&(k.start--,k.endA--,k.endB--);var M,N=x.doc.resolveNoCache(k.start-x.from),A=x.doc.resolveNoCache(k.endB-x.from);if((Dt.ios&&view.lastIOSEnter>Date.now()-100&&(!N.sameParent(A)||r.some((function(t){return"DIV"==t.nodeName})))||!N.sameParent(A)&&N.pos<x.doc.content.size&&(M=h.Selection.findFrom(x.doc.resolve(N.pos+1),1,!0))&&M.head==A.pos)&&view.someProp("handleKeyDown",(function(t){return t(view,Jt(13,"Enter"))})))view.lastIOSEnter=0;else if(view.state.selection.anchor>k.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||sn(r,!0,!1)<o.pos)return!1;var c=t.resolve(e);if(c.parentOffset<c.parent.content.size||!c.parent.isTextblock)return!1;var l=t.resolve(sn(c,!0,!0));if(!l.parent.isTextblock||l.pos>n||sn(l,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(l.parent.content)}(C,k.start,k.endA,N,A)&&view.someProp("handleKeyDown",(function(t){return t(view,Jt(8,"Backspace"))})))Dt.android&&Dt.chrome&&view.domObserver.suppressSelectionUpdates();else{var tr,E,T,D,R=k.start,P=k.endA;if(N.sameParent(A)&&N.parent.inlineContent)if(N.pos==A.pos)Dt.ie&&Dt.ie_version<=11&&0==N.parentOffset&&(view.domObserver.suppressSelectionUpdates(),setTimeout((function(){return He(view)}),20)),tr=view.state.tr.delete(R,P),E=C.resolve(k.start).marksAcross(C.resolve(k.endA));else if(k.endA==k.endB&&(D=C.resolve(k.start))&&(T=function(t,e){for(var n,mark,r,o=t.firstChild.marks,c=e.firstChild.marks,l=o,h=c,i=0;i<c.length;i++)l=c[i].removeFromSet(l);for(var f=0;f<o.length;f++)h=o[f].removeFromSet(h);if(1==l.length&&0==h.length)mark=l[0],n="add",r=function(t){return t.mark(mark.addToSet(t.marks))};else{if(0!=l.length||1!=h.length)return null;mark=h[0],n="remove",r=function(t){return t.mark(mark.removeFromSet(t.marks))}}for(var v=[],m=0;m<e.childCount;m++)v.push(r(e.child(m)));if(d.from(v).eq(t))return{mark:mark,type:n}}(N.parent.content.cut(N.parentOffset,A.parentOffset),D.parent.content.cut(D.parentOffset,k.endA-D.start()))))tr=view.state.tr,"add"==T.type?tr.addMark(R,P,T.mark):tr.removeMark(R,P,T.mark);else if(N.parent.child(N.index()).isText&&N.index()==A.index()-(A.textOffset?0:1)){var text=N.parent.textBetween(N.parentOffset,A.parentOffset);if(view.someProp("handleTextInput",(function(t){return t(view,R,P,text)})))return;tr=view.state.tr.insertText(text,R,P)}if(tr||(tr=view.state.tr.replace(R,P,x.doc.slice(k.start-x.from,k.endB-x.from))),x.sel){var B=on(view,tr.doc,x.sel);B&&!(Dt.chrome&&Dt.android&&view.composing&&B.empty&&(B.head==R||B.head==tr.mapping.map(P)-1)||Dt.ie&&B.empty&&B.head==R)&&tr.setSelection(B)}E&&tr.ensureMarks(E),view.dispatch(tr.scrollIntoView())}}}function on(view,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:tn(view,t.resolve(e.anchor),t.resolve(e.head))}function sn(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var c=t.node(r).maybeChild(t.indexAfter(r));c&&!c.isLeaf;)c=c.firstChild,o++;return o}function an(view,t){for(var e=[],content=t.content,n=t.openStart,r=t.openEnd;n>1&&r>1&&1==content.childCount&&1==content.firstChild.childCount;){n--,r--;var o=content.firstChild;e.push(o.type.name,o.type.hasRequiredAttrs()?o.attrs:null),content=o.content}var c=view.someProp("clipboardSerializer")||Nt.fromSchema(view.state.schema),l=pn(),h=l.createElement("div");h.appendChild(c.serializeFragment(content,{document:l}));for(var f,d=h.firstChild;d&&1==d.nodeType&&(f=hn[d.nodeName.toLowerCase()]);){for(var i=f.length-1;i>=0;i--){for(var v=l.createElement(f[i]);h.firstChild;)v.appendChild(h.firstChild);h.appendChild(v)}d=h.firstChild}return d&&1==d.nodeType&&d.setAttribute("data-pm-slice",n+" "+r+" "+JSON.stringify(e)),{dom:h,text:view.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function cn(view,text,html,t,e){var n,r,o=e.parent.type.spec.code;if(!html&&!text)return null;var c=text&&(t||o||!html);if(c){if(view.someProp("transformPastedText",(function(t){text=t(text)})),o)return new S(d.from(view.state.schema.text(text)),0,0);var l=view.someProp("clipboardTextParser",(function(t){return t(text,e)}));l?r=l:(n=document.createElement("div"),text.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){n.appendChild(document.createElement("p")).textContent=t})))}else view.someProp("transformPastedHTML",(function(t){html=t(html)})),n=function(html){var t=/(\s*<meta [^>]*>)*/.exec(html);t&&(html=html.slice(t[0].length));var e,n=pn().createElement("div"),r=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(html),o=0;(e=r&&hn[r[1].toLowerCase()])&&(html=e.map((function(t){return"<"+t+">"})).join("")+html+e.map((function(t){return"</"+t+">"})).reverse().join(""),o=e.length);n.innerHTML=html;for(var i=0;i<o;i++)n=n.firstChild;return n}(html);var h=n&&n.querySelector("[data-pm-slice]"),f=h&&/^(\d+) (\d+) (.*)/.exec(h.getAttribute("data-pm-slice"));if(!r){var v=view.someProp("clipboardParser")||view.someProp("domParser")||pt.fromSchema(view.state.schema);r=v.parseSlice(n,{preserveWhitespace:!(!c&&!f),context:e})}return r=f?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var content=t.content,o=t.openStart,c=t.openEnd,i=n.length-2;i>=0;i-=2){var l=r.nodes[n[i]];if(!l||l.hasRequiredAttrs())break;content=d.from(l.create(n[i+1],content)),o++,c++}return new S(content,o,c)}(function(t,e,n){e<t.openStart&&(t=new S(ln(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new S(ln(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(r,+f[1],+f[2]),f[3]):S.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,c=[];if(t.forEach((function(t){if(c){var e,n=r.findWrapping(t.type);if(!n)return c=null;if(e=c.length&&o.length&&function t(e,n,r,o,c){if(c<e.length&&c<n.length&&e[c]==n[c]){var l=t(e,n,r,o.lastChild,c+1);if(l)return o.copy(o.content.replaceChild(o.childCount-1,l));if(o.contentMatchAt(o.childCount).matchType(c==e.length-1?r.type:e[c+1]))return o.copy(o.content.append(d.from(un(r,e,c+1))))}}(n,o,t,c[c.length-1],0))c[c.length-1]=e;else{c.length&&(c[c.length-1]=function t(e,n){if(0==n)return e;var r=e.content.replaceChild(e.childCount-1,t(e.lastChild,n-1)),o=e.contentMatchAt(e.childCount).fillBefore(d.empty,!0);return e.copy(r.append(o))}(c[c.length-1],o.length));var l=un(t,n);c.push(l),r=r.matchType(l.type,l.attrs),o=n}}})),c)return{v:d.from(c)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(r.content,e),!1),view.someProp("transformPasted",(function(t){r=t(r)})),r}function un(t,e,n){void 0===n&&(n=0);for(var i=e.length-1;i>=n;i--)t=e[i].create(null,d.from(t));return t}function ln(t,e,n,r,o,c){var l=e<0?t.firstChild:t.lastChild,h=l.content;return o<r-1&&(h=ln(h,e,n,r,o+1,c)),o>=n&&(h=e<0?l.contentMatchAt(0).fillBefore(h,t.childCount>1||c<=o).append(h):h.append(l.contentMatchAt(l.childCount).fillBefore(d.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,l.copy(h))}var hn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},fn=null;function pn(){return fn||(fn=document.implementation.createHTMLDocument("title"))}var dn={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},vn=Dt.ie&&Dt.ie_version<=11,mn=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};mn.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},mn.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var gn=function(view,t){var e=this;this.view=view,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var i=0;i<t.length;i++)e.queue.push(t[i]);Dt.ie&&Dt.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?e.flushSoon():e.flush()})),this.currentSelection=new mn,vn&&(this.onCharData=function(t){e.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),e.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};gn.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},gn.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},gn.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,dn),vn&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},gn.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var i=0;i<e.length;i++)this.queue.push(e[i]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}vn&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},gn.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},gn.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},gn.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},gn.prototype.onSelectionChange=function(){if((!(view=this.view).editable||view.root.activeElement==view.dom)&&en(view)){var view;if(this.suppressingSelectionUpdates)return He(this.view);if(Dt.ie&&Dt.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&jt(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},gn.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},gn.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,desc=this.view.docView.nearestDesc(e);return desc&&desc.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},gn.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&en(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,c=!1,l=[];if(this.view.editable)for(var i=0;i<t.length;i++){var h=this.registerMutation(t[i],l);h&&(r=r<0?h.from:Math.min(h.from,r),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(c=!0))}if(Dt.gecko&&l.length>1){var f=l.filter((function(t){return"BR"==t.nodeName}));if(2==f.length){var a=f[0],b=f[1];a.parentNode&&a.parentNode.parentNode==b.parentNode?b.remove():a.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(view){if(yn)return;yn=!0,"normal"==getComputedStyle(view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,c,l),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||He(this.view))}},gn.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var desc=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(desc==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!desc||desc.ignoreMutation(t))return null;if("childList"==t.type){var n=t.previousSibling,r=t.nextSibling;if(Dt.ie&&Dt.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var o=t.addedNodes[i],c=o.previousSibling,l=o.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(n=c),(!l||Array.prototype.indexOf.call(t.addedNodes,l)<0)&&(r=l)}for(var h=n&&n.parentNode==t.target?_t(n)+1:0,f=desc.localPosFromDOM(t.target,h,-1),d=r&&r.parentNode==t.target?_t(r):t.target.childNodes.length,v=0;v<t.addedNodes.length;v++)e.push(t.addedNodes[v]);return{from:f,to:desc.localPosFromDOM(t.target,d,1)}}return"attributes"==t.type?{from:desc.posAtStart-desc.border,to:desc.posAtEnd+desc.border}:{from:desc.posAtStart,to:desc.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var yn=!1;var bn={},wn={};function xn(view,t){view.lastSelectionOrigin=t,view.lastSelectionTime=Date.now()}function Cn(view){view.someProp("handleDOMEvents",(function(t){for(var e in t)view.eventHandlers[e]||view.dom.addEventListener(e,view.eventHandlers[e]=function(t){return Sn(view,t)})}))}function Sn(view,t){return view.someProp("handleDOMEvents",(function(e){var n=e[t.type];return!!n&&(n(view,t)||t.defaultPrevented)}))}function kn(t){return{left:t.clientX,top:t.clientY}}function On(view,t,e,n,r){if(-1==n)return!1;for(var o=view.state.doc.resolve(n),c=function(i){if(view.someProp(t,(function(t){return i>o.depth?t(view,e,o.nodeAfter,o.before(i),r,!0):t(view,e,o.node(i),o.before(i),r,!1)})))return{v:!0}},i=o.depth+1;i>0;i--){var l=c(i);if(l)return l.v}return!1}function Mn(view,t,e){view.focused||view.focus();var tr=view.state.tr.setSelection(t);"pointer"==e&&tr.setMeta("pointer",!0),view.dispatch(tr)}function Nn(view,t,e,n,r){return On(view,"handleClickOn",t,e,n)||view.someProp("handleClick",(function(e){return e(view,t,n)}))||(r?function(view,t){if(-1==t)return!1;var e,n,r=view.state.selection;r instanceof h.NodeSelection&&(e=r.node);for(var o=view.state.doc.resolve(t),i=o.depth+1;i>0;i--){var c=i>o.depth?o.nodeAfter:o.node(i);if(h.NodeSelection.isSelectable(c)){n=e&&r.$from.depth>0&&i>=r.$from.depth&&o.before(r.$from.depth+1)==r.$from.pos?o.before(r.$from.depth):o.before(i);break}}return null!=n&&(Mn(view,h.NodeSelection.create(view.state.doc,n),"pointer"),!0)}(view,e):function(view,t){if(-1==t)return!1;var e=view.state.doc.resolve(t),n=e.nodeAfter;return!!(n&&n.isAtom&&h.NodeSelection.isSelectable(n))&&(Mn(view,new h.NodeSelection(e),"pointer"),!0)}(view,e))}function An(view,t,e,n){return On(view,"handleDoubleClickOn",t,e,n)||view.someProp("handleDoubleClick",(function(e){return e(view,t,n)}))}function En(view,t,e,n){return On(view,"handleTripleClickOn",t,e,n)||view.someProp("handleTripleClick",(function(e){return e(view,t,n)}))||function(view,t){var e=view.state.doc;if(-1==t)return!!e.inlineContent&&(Mn(view,h.TextSelection.create(e,0,e.content.size),"pointer"),!0);for(var n=e.resolve(t),i=n.depth+1;i>0;i--){var r=i>n.depth?n.nodeAfter:n.node(i),o=n.before(i);if(r.inlineContent)Mn(view,h.TextSelection.create(e,o+1,o+1+r.content.size),"pointer");else{if(!h.NodeSelection.isSelectable(r))continue;Mn(view,h.NodeSelection.create(e,o),"pointer")}return!0}}(view,e)}function Tn(view){return In(view)}wn.keydown=function(view,t){if(view.shiftKey=16==t.keyCode||t.shiftKey,!Pn(view,t))if(view.domObserver.forceFlush(),view.lastKeyCode=t.keyCode,view.lastKeyCodeTime=Date.now(),!Dt.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)view.someProp("handleKeyDown",(function(e){return e(view,t)}))||We(view,t)?t.preventDefault():xn(view,"key");else{var e=Date.now();view.lastIOSEnter=e,setTimeout((function(){view.lastIOSEnter==e&&(view.someProp("handleKeyDown",(function(t){return t(view,Jt(13,"Enter"))})),view.lastIOSEnter=0)}),50)}},wn.keyup=function(view,t){16==t.keyCode&&(view.shiftKey=!1)},wn.keypress=function(view,t){if(!(Pn(view,t)||!t.charCode||t.ctrlKey&&!t.altKey||Dt.mac&&t.metaKey))if(view.someProp("handleKeyPress",(function(e){return e(view,t)})))t.preventDefault();else{var e=view.state.selection;if(!(e instanceof h.TextSelection&&e.$from.sameParent(e.$to))){var text=String.fromCharCode(t.charCode);view.someProp("handleTextInput",(function(t){return t(view,e.$from.pos,e.$to.pos,text)}))||view.dispatch(view.state.tr.insertText(text).scrollIntoView()),t.preventDefault()}}};var Dn=Dt.mac?"metaKey":"ctrlKey";bn.mousedown=function(view,t){view.shiftKey=t.shiftKey;var e=Tn(view),n=Date.now(),r="singleClick";n-view.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(t,view.lastClick)&&!t[Dn]&&("singleClick"==view.lastClick.type?r="doubleClick":"doubleClick"==view.lastClick.type&&(r="tripleClick")),view.lastClick={time:n,x:t.clientX,y:t.clientY,type:r};var o=view.posAtCoords(kn(t));o&&("singleClick"==r?view.mouseDown=new Rn(view,o,t,e):("doubleClick"==r?An:En)(view,o.pos,o.inside,t)?t.preventDefault():xn(view,"pointer"))};var Rn=function(view,t,e,n){var r,o,c=this;if(this.view=view,this.startDoc=view.state.doc,this.pos=t,this.event=e,this.flushed=n,this.selectNode=e[Dn],this.allowDefault=e.shiftKey,t.inside>-1)r=view.state.doc.nodeAt(t.inside),o=t.inside;else{var l=view.state.doc.resolve(t.pos);r=l.parent,o=l.depth?l.before():0}this.mightDrag=null;var f=n?null:e.target,d=f?view.docView.nearestDesc(f,!0):null;this.target=d?d.dom:null,(r.type.spec.draggable&&!1!==r.type.spec.selectable||view.state.selection instanceof h.NodeSelection&&o==view.state.selection.from)&&(this.mightDrag={node:r,pos:o,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Dt.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return c.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),view.root.addEventListener("mouseup",this.up=this.up.bind(this)),view.root.addEventListener("mousemove",this.move=this.move.bind(this)),xn(view,"pointer")};function Pn(view,t){return!!view.composing||!!(Dt.safari&&Math.abs(t.timeStamp-view.compositionEndedAt)<500)&&(view.compositionEndedAt=-2e8,!0)}Rn.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},Rn.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(kn(t))),this.allowDefault||!e?xn(this.view,"pointer"):Nn(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():!this.flushed&&(!Dt.chrome||this.view.state.selection instanceof h.TextSelection||e.pos!=this.view.state.selection.from&&e.pos!=this.view.state.selection.to)?xn(this.view,"pointer"):(Mn(this.view,h.Selection.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault())}},Rn.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),xn(this.view,"pointer")},bn.touchdown=function(view){Tn(view),xn(view,"pointer")},bn.contextmenu=function(view){return Tn(view)};var Bn=Dt.android?5e3:-1;function Fn(view,t){clearTimeout(view.composingTimeout),t>-1&&(view.composingTimeout=setTimeout((function(){return In(view)}),t))}function In(view,t){for(view.domObserver.forceFlush(),view.composing=!1;view.compositionNodes.length>0;)view.compositionNodes.pop().markParentsDirty();if(t||view.docView.dirty){var e=Je(view);return e.eq(view.state.selection)?view.updateState(view.state):view.dispatch(view.state.tr.setSelection(e)),!0}return!1}wn.compositionstart=wn.compositionupdate=function(view){if(!view.composing){view.domObserver.flush();var t=view.state,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))view.markCursor=view.state.storedMarks||e.marks(),In(view,!0),view.markCursor=null;else if(In(view),Dt.gecko&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length)for(var n=view.root.getSelection(),r=n.focusNode,o=n.focusOffset;r&&1==r.nodeType&&0!=o;){var c=o<0?r.lastChild:r.childNodes[o-1];if(!c)break;if(3==c.nodeType){n.collapse(c,c.nodeValue.length);break}r=c,o=-1}view.composing=!0}Fn(view,Bn)},wn.compositionend=function(view,t){view.composing&&(view.composing=!1,view.compositionEndedAt=t.timeStamp,Fn(view,20))};var _n=Dt.ie&&Dt.ie_version<15||Dt.ios&&Dt.webkit_version<604;function zn(view,text,html,t){var e=cn(view,text,html,view.shiftKey,view.state.selection.$from);if(!view.someProp("handlePaste",(function(n){return n(view,t,e||S.empty)}))&&e){var n=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(e),tr=n?view.state.tr.replaceSelectionWith(n,view.shiftKey):view.state.tr.replaceSelection(e);view.dispatch(tr.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste"))}}bn.copy=wn.cut=function(view,t){var e=view.state.selection,n="cut"==t.type;if(!e.empty){var data=_n?null:t.clipboardData,r=an(view,e.content()),o=r.dom,text=r.text;data?(t.preventDefault(),data.clearData(),data.setData("text/html",o.innerHTML),data.setData("text/plain",text)):function(view,t){var e=view.dom.ownerDocument,n=e.body.appendChild(e.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=e.createRange();o.selectNodeContents(t),view.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){e.body.removeChild(n),view.focus()}),50)}(view,o),n&&view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},wn.paste=function(view,t){var data=_n?null:t.clipboardData,html=data&&data.getData("text/html"),text=data&&data.getData("text/plain");data&&(html||text||data.files.length)?(zn(view,text,html,t),t.preventDefault()):function(view,t){var e=view.dom.ownerDocument,n=view.shiftKey||view.state.selection.$from.parent.type.spec.code,r=e.body.appendChild(e.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){view.focus(),e.body.removeChild(r),n?zn(view,r.value,null,t):zn(view,r.textContent,r.innerHTML,t)}),50)}(view,t)};var Ln=function(t,e){this.slice=t,this.move=e},jn=Dt.mac?"altKey":"ctrlKey";for(var Vn in bn.dragstart=function(view,t){var e=view.mouseDown;if(e&&e.done(),t.dataTransfer){var n=view.state.selection,r=n.empty?null:view.posAtCoords(kn(t));if(r&&r.pos>=n.from&&r.pos<=(n instanceof h.NodeSelection?n.to-1:n.to));else if(e&&e.mightDrag)view.dispatch(view.state.tr.setSelection(h.NodeSelection.create(view.state.doc,e.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var desc=view.docView.nearestDesc(t.target,!0);if(!desc||!desc.node.type.spec.draggable||desc==view.docView)return;view.dispatch(view.state.tr.setSelection(h.NodeSelection.create(view.state.doc,desc.posBefore)))}var o=view.state.selection.content(),c=an(view,o),l=c.dom,text=c.text;t.dataTransfer.clearData(),t.dataTransfer.setData(_n?"Text":"text/html",l.innerHTML),_n||t.dataTransfer.setData("text/plain",text),view.dragging=new Ln(o,!t[jn])}},bn.dragend=function(view){window.setTimeout((function(){return view.dragging=null}),50)},wn.dragover=wn.dragenter=function(t,e){return e.preventDefault()},wn.drop=function(view,t){var e=view.dragging;if(view.dragging=null,t.dataTransfer){var n=view.posAtCoords(kn(t));if(n){var r=view.state.doc.resolve(n.pos);if(r){var o=e&&e.slice||cn(view,t.dataTransfer.getData(_n?"Text":"text/plain"),_n?null:t.dataTransfer.getData("text/html"),!1,r);if(view.someProp("handleDrop",(function(n){return n(view,t,o||S.empty,e&&e.move)})))t.preventDefault();else if(o){t.preventDefault();var c=o?Object(Tt.h)(view.state.doc,r.pos,o):r.pos;null==c&&(c=r.pos);var tr=view.state.tr;e&&e.move&&tr.deleteSelection();var l=tr.mapping.map(c),f=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,d=tr.doc;if(f?tr.replaceRangeWith(l,l,o.content.firstChild):tr.replaceRange(l,l,o),!tr.doc.eq(d)){var v=tr.doc.resolve(l);f&&h.NodeSelection.isSelectable(o.content.firstChild)&&v.nodeAfter&&v.nodeAfter.sameMarkup(o.content.firstChild)?tr.setSelection(new h.NodeSelection(v)):tr.setSelection(tn(view,v,tr.doc.resolve(tr.mapping.map(c)))),view.focus(),view.dispatch(tr.setMeta("uiEvent","drop"))}}}}}},bn.focus=function(view){view.focused||(view.domObserver.stop(),view.dom.classList.add("ProseMirror-focused"),view.domObserver.start(),view.focused=!0,setTimeout((function(){view.docView&&view.hasFocus()&&!view.domObserver.currentSelection.eq(view.root.getSelection())&&He(view)}),20))},bn.blur=function(view){view.focused&&(view.domObserver.stop(),view.dom.classList.remove("ProseMirror-focused"),view.domObserver.start(),view.domObserver.currentSelection.set({}),view.focused=!1)},bn.beforeinput=function(view,t){if(Dt.chrome&&Dt.android&&"deleteContentBackward"==t.inputType){var e=view.domChangeCount;setTimeout((function(){if(view.domChangeCount==e&&(view.dom.blur(),view.focus(),!view.someProp("handleKeyDown",(function(t){return t(view,Jt(8,"Backspace"))})))){var t=view.state.selection.$cursor;t&&t.pos>0&&view.dispatch(view.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},wn)bn[Vn]=wn[Vn];function $n(a,b){if(a==b)return!0;for(var p in a)if(a[p]!==b[p])return!1;for(var t in b)if(!(t in a))return!1;return!0}var qn=function(t,e){this.spec=e||Yn,this.side=this.spec.side||0,this.toDOM=t};qn.prototype.map=function(t,span,e,n){var r=t.mapResult(span.from+n,this.side<0?-1:1),o=r.pos;return r.deleted?null:new Jn(o-e,o-e,this)},qn.prototype.valid=function(){return!0},qn.prototype.eq=function(t){return this==t||t instanceof qn&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&$n(this.spec,t.spec))};var Un=function(t,e){this.spec=e||Yn,this.attrs=t};Un.prototype.map=function(t,span,e,n){var r=t.map(span.from+n,this.spec.inclusiveStart?-1:1)-e,o=t.map(span.to+n,this.spec.inclusiveEnd?1:-1)-e;return r>=o?null:new Jn(r,o,this)},Un.prototype.valid=function(t,span){return span.from<span.to},Un.prototype.eq=function(t){return this==t||t instanceof Un&&$n(this.attrs,t.attrs)&&$n(this.spec,t.spec)},Un.is=function(span){return span.type instanceof Un};var Wn=function(t,e){this.spec=e||Yn,this.attrs=t};Wn.prototype.map=function(t,span,e,n){var r=t.mapResult(span.from+n,1);if(r.deleted)return null;var o=t.mapResult(span.to+n,-1);return o.deleted||o.pos<=r.pos?null:new Jn(r.pos-e,o.pos-e,this)},Wn.prototype.valid=function(t,span){var e=t.content.findIndex(span.from),n=e.index,r=e.offset;return r==span.from&&r+t.child(n).nodeSize==span.to},Wn.prototype.eq=function(t){return this==t||t instanceof Wn&&$n(this.attrs,t.attrs)&&$n(this.spec,t.spec)};var Jn=function(t,e,n){this.from=t,this.to=e,this.type=n},Hn={spec:{configurable:!0}};Jn.prototype.copy=function(t,e){return new Jn(t,e,this.type)},Jn.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},Jn.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},Jn.widget=function(t,e,n){return new Jn(t,t,new qn(e,n))},Jn.inline=function(t,e,n,r){return new Jn(t,e,new Un(n,r))},Jn.node=function(t,e,n,r){return new Jn(t,e,new Wn(n,r))},Hn.spec.get=function(){return this.type.spec},Object.defineProperties(Jn.prototype,Hn);var Kn=[],Yn={},Xn=function(t,e){this.local=t&&t.length?t:Kn,this.children=e&&e.length?e:Kn};Xn.create=function(t,e){return e.length?rr(e,t,0,Yn):Gn},Xn.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},Xn.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var span=this.local[i];span.from<=e&&span.to>=t&&(!o||o(span.spec))&&n.push(span.copy(span.from+r,span.to+r))}for(var c=0;c<this.children.length;c+=3)if(this.children[c]<e&&this.children[c+1]>t){var l=this.children[c]+1;this.children[c+2].findInner(t-l,e-l,n,r+l,o)}},Xn.prototype.map=function(t,e,n){return this==Gn||0==t.maps.length?this:this.mapInner(t,e,0,0,n||Yn)},Xn.prototype.mapInner=function(t,e,n,r,o){for(var c,i=0;i<this.local.length;i++){var l=this.local[i].map(t,n,r);l&&l.type.valid(e,l)?(c||(c=[])).push(l):o.onRemove&&o.onRemove(this.local[i].spec)}return this.children.length?function(t,e,n,r,o,c,l){for(var h=t.slice(),f=function(t,e,n,r){for(var i=0;i<h.length;i+=3){var l=h[i+1],f=void 0;-1==l||t>l+c||(e>=h[i]+c?h[i+1]=-1:n>=o&&(f=r-n-(e-t))&&(h[i]+=f,h[i+1]+=f))}},i=0;i<n.maps.length;i++)n.maps[i].forEach(f);for(var d=!1,v=0;v<h.length;v+=3)if(-1==h[v+1]){var m=n.map(h[v]+c),y=m-o;if(y<0||y>=r.content.size){d=!0;continue}var w=n.map(t[v+1]+c,-1)-o,x=r.content.findIndex(y),C=x.index,S=x.offset,k=r.maybeChild(C);if(k&&S==y&&S+k.nodeSize==w){var O=h[v+2].mapInner(n,k,m+1,h[v]+c+1,l);O!=Gn?(h[v]=y,h[v+1]=w,h[v+2]=O):(h[v+1]=-2,d=!0)}else d=!0}if(d){var M=rr(function(t,e,n,r,o,c,l){function h(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):l.onRemove&&l.onRemove(t.local[i].spec)}for(var f=0;f<t.children.length;f+=3)h(t.children[f+2],t.children[f]+e+1)}for(var i=0;i<t.length;i+=3)-1==t[i+1]&&h(t[i+2],e[i]+c+1);return n}(h,t,e||[],n,o,c,l),r,0,l);e=M.local;for(var N=0;N<h.length;N+=3)h[N+1]<0&&(h.splice(N,3),N-=3);for(var A=0,E=0;A<M.children.length;A+=3){for(var T=M.children[A];E<h.length&&h[E]<T;)E+=3;h.splice(E,0,M.children[A],M.children[A+1],M.children[A+2])}}return new Xn(e&&e.sort(or),h)}(this.children,c,t,e,n,r,o):c?new Xn(c.sort(or)):Gn},Xn.prototype.add=function(t,e){return e.length?this==Gn?Xn.create(t,e):this.addInner(t,e,0):this},Xn.prototype.addInner=function(t,e,n){var r,o=this,c=0;t.forEach((function(t,l){var h,f=l+n;if(h=er(e,t,f)){for(r||(r=o.children.slice());c<r.length&&r[c]<l;)c+=3;r[c]==l?r[c+2]=r[c+2].addInner(t,h,f+1):r.splice(c,0,l,l+t.nodeSize,rr(h,t,f+1,Yn)),c+=3}}));var l=Qn(c?nr(e):e,-n);return new Xn(l.length?this.local.concat(l).sort(or):this.local,r||this.children)},Xn.prototype.remove=function(t){return 0==t.length||this==Gn?this:this.removeInner(t,0)},Xn.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,i=0;i<n.length;i+=3){for(var o=void 0,c=n[i]+e,l=n[i+1]+e,h=0,span=void 0;h<t.length;h++)(span=t[h])&&span.from>c&&span.to<l&&(t[h]=null,(o||(o=[])).push(span));if(o){n==this.children&&(n=this.children.slice());var f=n[i+2].removeInner(o,c+1);f!=Gn?n[i+2]=f:(n.splice(i,3),i-=3)}}if(r.length)for(var d=0,v=void 0;d<t.length;d++)if(v=t[d])for(var m=0;m<r.length;m++)r[m].eq(v,e)&&(r==this.local&&(r=this.local.slice()),r.splice(m--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Xn(r,n):Gn},Xn.prototype.forChild=function(t,e){if(this==Gn)return this;if(e.isLeaf)return Xn.empty;for(var n,r,i=0;i<this.children.length;i+=3)if(this.children[i]>=t){this.children[i]==t&&(n=this.children[i+2]);break}for(var o=t+1,c=o+e.content.size,l=0;l<this.local.length;l++){var h=this.local[l];if(h.from<c&&h.to>o&&h.type instanceof Un){var f=Math.max(o,h.from)-o,d=Math.min(c,h.to)-o;f<d&&(r||(r=[])).push(h.copy(f,d))}}if(r){var v=new Xn(r.sort(or));return n?new Zn([v,n]):v}return n||Gn},Xn.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof Xn)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var i=0;i<this.local.length;i++)if(!this.local[i].eq(t.local[i]))return!1;for(var e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0},Xn.prototype.locals=function(t){return ir(this.localsInner(t))},Xn.prototype.localsInner=function(t){if(this==Gn)return Kn;if(t.inlineContent||!this.local.some(Un.is))return this.local;for(var e=[],i=0;i<this.local.length;i++)this.local[i].type instanceof Un||e.push(this.local[i]);return e};var Gn=new Xn;Xn.empty=Gn,Xn.removeOverlap=ir;var Zn=function(t){this.members=t};function Qn(t,e){if(!e||!t.length)return t;for(var n=[],i=0;i<t.length;i++){var span=t[i];n.push(new Jn(span.from+e,span.to+e,span.type))}return n}function er(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,span=void 0;i<t.length;i++)(span=t[i])&&span.from>n&&span.to<r&&((o||(o=[])).push(span),t[i]=null);return o}function nr(t){for(var e=[],i=0;i<t.length;i++)null!=t[i]&&e.push(t[i]);return e}function rr(t,e,n,r){var o=[],c=!1;e.forEach((function(e,l){var h=er(t,e,l+n);if(h){c=!0;var f=rr(h,e,n+l+1,r);f!=Gn&&o.push(l,l+e.nodeSize,f)}}));for(var l=Qn(c?nr(t):t,-n).sort(or),i=0;i<l.length;i++)l[i].type.valid(e,l[i])||(r.onRemove&&r.onRemove(l[i].spec),l.splice(i--,1));return l.length||o.length?new Xn(l,o):Gn}function or(a,b){return a.from-b.from||a.to-b.to}function ir(t){for(var e=t,i=0;i<e.length-1;i++){var span=e[i];if(span.from!=span.to)for(var n=i+1;n<e.length;n++){var r=e[n];if(r.from!=span.from){r.from<span.to&&(e==t&&(e=t.slice()),e[i]=span.copy(span.from,r.from),sr(e,n,span.copy(r.from,span.to)));break}r.to!=span.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,span.to),sr(e,n+1,r.copy(span.to,r.to)))}}return e}function sr(t,i,e){for(;i<t.length&&or(e,t[i])>0;)i++;t.splice(i,0,e)}function ar(view){var t=[];return view.someProp("decorations",(function(e){var n=e(view.state);n&&n!=Gn&&t.push(n)})),view.cursorWrapper&&t.push(Xn.create(view.state.doc,[view.cursorWrapper.deco])),Zn.from(t)}Zn.prototype.forChild=function(t,e){if(e.isLeaf)return Xn.empty;for(var n=[],i=0;i<this.members.length;i++){var r=this.members[i].forChild(t,e);r!=Gn&&(r instanceof Zn?n=n.concat(r.members):n.push(r))}return Zn.from(n)},Zn.prototype.eq=function(t){if(!(t instanceof Zn)||t.members.length!=this.members.length)return!1;for(var i=0;i<this.members.length;i++)if(!this.members[i].eq(t.members[i]))return!1;return!0},Zn.prototype.locals=function(t){for(var e,n=!0,i=0;i<this.members.length;i++){var r=this.members[i].localsInner(t);if(r.length)if(e){n&&(e=e.slice(),n=!1);for(var o=0;o<r.length;o++)e.push(r[o])}else e=r}return e?ir(n?e:e.sort(or)):Kn},Zn.from=function(t){switch(t.length){case 0:return Gn;case 1:return t[0];default:return new Zn(t)}};var cr=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=pr(this),this.markCursor=null,this.cursorWrapper=null,fr(this),this.nodeViews=dr(this),this.docView=ye(this.state.doc,lr(this),ar(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(view){view.shiftKey=!1,view.mouseDown=null,view.lastKeyCode=null,view.lastKeyCodeTime=0,view.lastClick={time:0,x:0,y:0,type:""},view.lastSelectionOrigin=null,view.lastSelectionTime=0,view.lastIOSEnter=0,view.composing=!1,view.composingTimeout=null,view.compositionNodes=[],view.compositionEndedAt=-2e8,view.domObserver=new gn(view,(function(t,e,n,r){return rn(view,t,e,n,r)})),view.domObserver.start(),view.domChangeCount=0,view.eventHandlers=Object.create(null);var t=function(t){var e=bn[t];view.dom.addEventListener(t,view.eventHandlers[t]=function(t){!function(view,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var e=t.target;e!=view.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}(view,t)||Sn(view,t)||!view.editable&&t.type in wn||e(view,t)})};for(var e in bn)t(e);Dt.safari&&view.dom.addEventListener("input",(function(){return null})),Cn(view)}(this),this.pluginViews=[],this.updatePluginViews()},ur={props:{configurable:!0},root:{configurable:!0}};function lr(view){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(view.editable),view.someProp("attributes",(function(e){if("function"==typeof e&&(e=e(view.state)),e)for(var n in e)"class"==n?t.class+=" "+e[n]:t[n]||"contenteditable"==n||"nodeName"==n||(t[n]=String(e[n]))})),[Jn.node(0,view.state.doc.content.size,t)]}function fr(view){if(view.markCursor){var t=document.createElement("img");t.setAttribute("mark-placeholder","true"),view.cursorWrapper={dom:t,deco:Jn.widget(view.state.selection.head,t,{raw:!0,marks:view.markCursor})}}else view.cursorWrapper=null}function pr(view){return!view.someProp("editable",(function(t){return!1===t(view.state)}))}function dr(view){var t={};return view.someProp("nodeViews",(function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])})),t}function vr(t){var e=t.getSelection(),n=e.focusOffset,r=e.focusNode;return r&&1==r.nodeType?[r,n,r.childNodes[n-1],r.childNodes[n]]:null}ur.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},cr.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Cn(this),this._props=t,this.updateStateInner(t.state,!0)},cr.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},cr.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},cr.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1;if(this.state=t,e){var c=dr(this);(function(a,b){var t=0,e=0;for(var n in a){if(a[n]!=b[n])return!0;t++}for(var r in b)e++;return t!=e})(c,this.nodeViews)&&(this.nodeViews=c,o=!0),Cn(this)}this.editable=pr(this),fr(this);var view,l,f,d,v,m,y,w,x,C,S,k=ar(this),O=lr(this),M=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",N=o||!this.docView.matchesNode(t.doc,O,k),A=N||!t.selection.eq(r.selection),E="preserve"==M&&A&&null==this.dom.style.overflowAnchor&&function(view){for(var t,e,rect=view.dom.getBoundingClientRect(),n=Math.max(0,rect.top),r=(rect.left+rect.right)/2,o=n+1;o<Math.min(innerHeight,rect.bottom);o+=5){var c=view.root.elementFromPoint(r,o);if(c!=view.dom&&view.dom.contains(c)){var l=c.getBoundingClientRect();if(l.top>=n-20){t=c,e=l.top;break}}}return{refDOM:t,refTop:e,stack:Xt(view.dom)}}(this);if(A){this.domObserver.stop();var T=N&&(Dt.ie||Dt.chrome)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&(d=r.selection,v=t.selection,m=Math.min(d.$anchor.sharedDepth(d.head),v.$anchor.sharedDepth(v.head)),d.$anchor.start(m)!=v.$anchor.start(m));if(N){var D=Dt.chrome&&vr(this.root);!o&&this.docView.update(t.doc,O,k,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=ye(t.doc,O,k,this.dom,this)),D&&function(t,e){var n=vr(e);if(!n||3==n[0].nodeType)return!1;for(var i=0;i<t.length;i++)if(n[i]!=t[i])return!0;return!1}(D,this.root)&&(T=!0)}T||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(view=this,l=view.docView.domFromPos(view.state.selection.anchor),f=view.root.getSelection(),jt(l.node,l.offset,f.anchorNode,f.anchorOffset)))?He(this,T):(Ze(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==M)this.dom.scrollTop=0;else if("to selection"==M){var R=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof h.NodeSelection?Yt(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),R):Yt(this,this.coordsAtPos(t.selection.head),R))}else E&&(w=(y=E).refDOM,x=y.refTop,C=y.stack,S=w?w.getBoundingClientRect().top:0,Gt(C,0==S?0:S-x))},cr.prototype.destroyPluginViews=function(){for(var view;view=this.pluginViews.pop();)view.destroy&&view.destroy()},cr.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var i=0;i<this.state.plugins.length;i++){var r=this.state.plugins[i];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}},cr.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var c=o[i].props[t];if(null!=c&&(n=e?e(c):c))return n}},cr.prototype.hasFocus=function(){return this.root.activeElement==this.dom},cr.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Zt)return t.focus(Zt);var e=Xt(t);t.focus(null==Zt?{get preventScroll(){return Zt={preventScroll:!0},!0}}:void 0),Zt||(Zt=!1,Gt(e,0))}(this.dom),He(this),this.domObserver.start()},ur.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},cr.prototype.posAtCoords=function(t){return ee(this,t)},cr.prototype.coordsAtPos=function(t){return re(this,t)},cr.prototype.domAtPos=function(t){return this.docView.domFromPos(t)},cr.prototype.nodeDOM=function(t){var desc=this.docView.descAt(t);return desc?desc.nodeDOM:null},cr.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},cr.prototype.endOfTextblock=function(t,e){return le(this,e||this.state,t)},cr.prototype.destroy=function(){this.docView&&(!function(view){for(var t in view.domObserver.stop(),view.eventHandlers)view.dom.removeEventListener(t,view.eventHandlers[t]);clearTimeout(view.composingTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ar(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},cr.prototype.dispatchEvent=function(t){return function(view,t){Sn(view,t)||!bn[t.type]||!view.editable&&t.type in wn||bn[t.type](view,t)}(this,t)},cr.prototype.dispatch=function(tr){var t=this._props.dispatchTransaction;t?t.call(this,tr):this.updateState(this.state.apply(tr))},Object.defineProperties(cr.prototype,ur);var mr=n(268),gr=n(219),yr=n(196),wr=function(t,e,n){this.step=t,this.inverted=e,this.origin=n};var xr=function(t,e){this.version=t,this.unconfirmed=e};var Cr=new h.PluginKey("collab");function Sr(t){return void 0===t&&(t={}),t={version:t.version||0,clientID:null==t.clientID?Math.floor(4294967295*Math.random()):t.clientID},new h.Plugin({key:Cr,state:{init:function(){return new xr(t.version,[])},apply:function(tr,t){var e=tr.getMeta(Cr);return e||(tr.docChanged?new xr(t.version,t.unconfirmed.concat(function(t){for(var e=[],i=0;i<t.steps.length;i++)e.push(new wr(t.steps[i],t.steps[i].invert(t.docs[i]),t));return e}(tr))):t)}},config:t,historyPreserveItems:!0})}function kr(t,e,n,r){for(var o=Cr.getState(t),c=o.version+e.length,l=Cr.get(t).spec.config.clientID,f=0;f<n.length&&n[f]==l;)++f;var d=o.unconfirmed.slice(f);if(!(e=f?e.slice(f):e).length)return t.tr.setMeta(Cr,new xr(c,d));var v=d.length,tr=t.tr;if(v)d=function(t,e,n){for(var i=t.length-1;i>=0;i--)n.step(t[i].inverted);for(var r=0;r<e.length;r++)n.step(e[r]);for(var o=[],c=0,l=t.length;c<t.length;c++){var h=t[c].step.map(n.mapping.slice(l));l--,h&&!n.maybeStep(h).failed&&(n.mapping.setMirror(l,n.steps.length-1),o.push(new wr(h,h.invert(n.docs[n.docs.length-1]),t[c].origin)))}return o}(d,e,tr);else{for(var i=0;i<e.length;i++)tr.step(e[i]);d=[]}var m=new xr(c,d);return r&&r.mapSelectionBackward&&t.selection instanceof h.TextSelection&&(tr.setSelection(h.TextSelection.between(tr.doc.resolve(tr.mapping.map(t.selection.anchor,-1)),tr.doc.resolve(tr.mapping.map(t.selection.head,-1)),-1)),tr.updated&=-2),tr.setMeta("rebased",v).setMeta("addToHistory",!1).setMeta(Cr,m)}var Or=function(){};Or.prototype.append=function(t){return t.length?(t=Or.from(t),!this.length&&t||t.length<200&&this.leafAppend(t)||this.length<200&&t.leafPrepend(this)||this.appendInner(t)):this},Or.prototype.prepend=function(t){return t.length?Or.from(t).append(this):this},Or.prototype.appendInner=function(t){return new Nr(this,t)},Or.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?Or.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},Or.prototype.get=function(i){if(!(i<0||i>=this.length))return this.getInner(i)},Or.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},Or.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(e,i){return r.push(t(e,i))}),e,n),r},Or.from=function(t){return t instanceof Or?t:t&&t.length?new Mr(t):Or.empty};var Mr=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(t,e,n,r){for(var i=e;i<n;i++)if(!1===t(this.values[i],r+i))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var i=e-1;i>=n;i--)if(!1===t(this.values[i],r+i))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=200)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=200)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Or);Or.empty=new Mr([]);var Nr=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0)},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(Or),Ar=Or,Er=function(t,e){this.items=t,this.eventCount=e};Er.prototype.popEvent=function(t,e){var n=this;if(0==this.eventCount)return null;for(var r,o,c=this.items.length;;c--){if(this.items.get(c-1).selection){--c;break}}e&&(r=this.remapping(c,this.items.length),o=r.maps.length);var l,h,f=t.tr,d=[],v=[];return this.items.forEach((function(t,i){if(!t.step)return r||(r=n.remapping(c,i+1),o=r.maps.length),o--,void v.push(t);if(r){v.push(new Tr(t.map));var map,e=t.step.map(r.slice(o));e&&f.maybeStep(e).doc&&(map=f.mapping.maps[f.mapping.maps.length-1],d.push(new Tr(map,null,null,d.length+v.length))),o--,map&&r.appendMap(map,o)}else f.maybeStep(t.step);return t.selection?(l=r?t.selection.map(r.slice(o)):t.selection,h=new Er(n.items.slice(0,c).append(v.reverse().concat(d)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:h,transform:f,selection:l}},Er.prototype.addTransform=function(t,e,n,r){for(var o=[],c=this.eventCount,l=this.items,h=!r&&l.length?l.get(l.length-1):null,i=0;i<t.steps.length;i++){var f,d=t.steps[i].invert(t.docs[i]),v=new Tr(t.mapping.maps[i],d,e);(f=h&&h.merge(v))&&(v=f,i?o.pop():l=l.slice(0,l.length-1)),o.push(v),e&&(c++,e=null),r||(h=v)}var m,y,w,x=c-n.depth;return x>Rr&&(y=x,(m=l).forEach((function(t,i){if(t.selection&&0==y--)return w=i,!1})),l=m.slice(w),c-=x),new Er(l.append(o),c)},Er.prototype.remapping=function(t,e){var n=new Tt.a;return this.items.forEach((function(e,i){var r=null!=e.mirrorOffset&&i-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:null;n.appendMap(e.map,r)}),t,e),n},Er.prototype.addMaps=function(t){return 0==this.eventCount?this:new Er(this.items.append(t.map((function(map){return new Tr(map)}))),this.eventCount)},Er.prototype.rebased=function(t,e){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-e),o=t.mapping,c=t.steps.length,l=this.eventCount;this.items.forEach((function(t){t.selection&&l--}),r);var h=e;this.items.forEach((function(e){var r=o.getMirror(--h);if(null!=r){c=Math.min(c,r);var map=o.maps[r];if(e.step){var f=t.steps[r].invert(t.docs[r]),d=e.selection&&e.selection.map(o.slice(h+1,r));d&&l++,n.push(new Tr(map,f,d))}else n.push(new Tr(map))}}),r);for(var f=[],i=e;i<c;i++)f.push(new Tr(o.maps[i]));var d=this.items.slice(0,r).append(f).append(n),v=new Er(d,l);return v.emptyItemCount()>500&&(v=v.compress(this.items.length-n.length)),v},Er.prototype.emptyItemCount=function(){var t=0;return this.items.forEach((function(e){e.step||t++})),t},Er.prototype.compress=function(t){void 0===t&&(t=this.items.length);var e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((function(c,i){if(i>=t)r.push(c),c.selection&&o++;else if(c.step){var l=c.step.map(e.slice(n)),map=l&&l.getMap();if(n--,map&&e.appendMap(map,n),l){var h=c.selection&&c.selection.map(e.slice(n));h&&o++;var f,d=new Tr(map.invert(),l,h),v=r.length-1;(f=r.length&&r[v].merge(d))?r[v]=f:r.push(d)}}else c.map&&n--}),this.items.length,0),new Er(Ar.from(r.reverse()),o)},Er.empty=new Er(Ar.empty,0);var Tr=function(map,t,e,n){this.map=map,this.step=t,this.selection=e,this.mirrorOffset=n};Tr.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var e=t.step.merge(this.step);if(e)return new Tr(e.getMap().invert(),e,this.selection)}};var Dr=function(t,e,n,r){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r},Rr=20;function Pr(map){var t=[];return map.forEach((function(e,n,r,o){return t.push(r,o)})),t}function Br(t,e){if(!t)return null;for(var n=[],i=0;i<t.length;i+=2){var r=e.map(t[i],1),o=e.map(t[i+1],-1);r<=o&&n.push(r,o)}return n}function Fr(t,e,n,r){var o=zr(e),c=Lr.get(e).spec.config,l=(r?t.undone:t.done).popEvent(e,o);if(l){var h=l.selection.resolve(l.transform.doc),f=(r?t.done:t.undone).addTransform(l.transform,e.selection.getBookmark(),c,o),d=new Dr(r?f:l.remaining,r?l.remaining:f,null,0);n(l.transform.setSelection(h).setMeta(Lr,{redo:r,historyState:d}).scrollIntoView())}}var Ir=!1,_r=null;function zr(t){var e=t.plugins;if(_r!=e){Ir=!1,_r=e;for(var i=0;i<e.length;i++)if(e[i].spec.historyPreserveItems){Ir=!0;break}}return Ir}var Lr=new h.PluginKey("history"),jr=new h.PluginKey("closeHistory");function Vr(t){return t={depth:t&&t.depth||100,newGroupDelay:t&&t.newGroupDelay||500},new h.Plugin({key:Lr,state:{init:function(){return new Dr(Er.empty,Er.empty,null,0)},apply:function(tr,e,n){return function(t,e,tr,n){var r,o=tr.getMeta(Lr);if(o)return o.historyState;tr.getMeta(jr)&&(t=new Dr(t.done,t.undone,null,0));var c=tr.getMeta("appendedTransaction");if(0==tr.steps.length)return t;if(c&&c.getMeta(Lr))return c.getMeta(Lr).redo?new Dr(t.done.addTransform(tr,null,n,zr(e)),t.undone,Pr(tr.mapping.maps[tr.steps.length-1]),t.prevTime):new Dr(t.done,t.undone.addTransform(tr,null,n,zr(e)),null,t.prevTime);if(!1===tr.getMeta("addToHistory")||c&&!1===c.getMeta("addToHistory"))return(r=tr.getMeta("rebased"))?new Dr(t.done.rebased(tr,r),t.undone.rebased(tr,r),Br(t.prevRanges,tr.mapping),t.prevTime):new Dr(t.done.addMaps(tr.mapping.maps),t.undone.addMaps(tr.mapping.maps),Br(t.prevRanges,tr.mapping),t.prevTime);var l=0==t.prevTime||!c&&(t.prevTime<(tr.time||0)-n.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach((function(t,r){for(var i=0;i<e.length;i+=2)t<=e[i+1]&&r>=e[i]&&(n=!0)})),n}(tr,t.prevRanges)),h=c?Br(t.prevRanges,tr.mapping):Pr(tr.mapping.maps[tr.steps.length-1]);return new Dr(t.done.addTransform(tr,l?e.selection.getBookmark():null,n,zr(e)),Er.empty,h,tr.time)}(e,n,tr,t)}},config:t})}function $r(t,e){var n=Lr.getState(t);return!(!n||0==n.done.eventCount)&&(e&&Fr(n,t,e,!1),!0)}function qr(t,e){var n=Lr.getState(t);return!(!n||0==n.undone.eventCount)&&(e&&Fr(n,t,e,!0),!0)}function Ur(t){var e=Lr.getState(t);return e?e.done.eventCount:0}function Wr(t){var e=Lr.getState(t);return e?e.undone.eventCount:0}function Jr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kr(t,e,n){return e&&Hr(t.prototype,e),n&&Hr(t,n),t}function Yr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xr(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Gr(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Xr(Object(source),!0).forEach((function(e){Yr(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Xr(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Zr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function to(t,p){return(to=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t})(t,p)}function eo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function no(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ro(t){return function(){var e,n=Qr(t);if(eo()){var r=Qr(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return no(this,e)}}function oo(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],n=!0,r=!1,o=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done)&&(e.push(c.value),!i||e.length!==i);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return e}(t,i)||so(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function io(t){return function(t){if(Array.isArray(t))return ao(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||so(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function so(t,e){if(t){if("string"==typeof t)return ao(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ao(t,e):void 0}}function ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}r.e,r.e,r.e;function co(t){var e=t.doc,n=t.name,r=[],o=Object(mr.findBlockNodes)(e).filter((function(t){return t.node.type.name===n}));return o.forEach((function(t){var e=t.pos+1;(function t(e){return e.reduce((function(a,b){return a.concat(Array.isArray(b)?t(b):b)}),[])})(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map((function(e){var r=[].concat(io(n),io(e.properties?e.properties.className:[]));return e.children?t(e.children,r):{text:e.value,classes:r}}))}(l.a.highlightAuto(t.node.textContent).value)).map((function(t){var n=e,r=n+t.text.length;return e=r,Gr({},t,{from:n,to:r})})).forEach((function(t){var e=Jn.inline(t.from,t.to,{class:t.classes.join(" ")});r.push(e)}))})),Xn.create(e,r)}r.e;var uo=function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"keys",value:function(t){var e=t.type,n=Object(o.a)(o.b,(function(t,n){return n(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0}));return{"Mod-Enter":n,"Shift-Enter":n}}},{key:"name",get:function(){return"hard_break"}},{key:"schema",get:function(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}}}}]),n}(r.e),lo=function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"commands",value:function(t){var e=t.type,n=t.schema;return function(t){return Object(o.p)(e,n.nodes.paragraph,t)}}},{key:"keys",value:function(t){var e=t.type;return this.options.levels.reduce((function(t,n){return Gr({},t,{},Yr({},"Shift-Ctrl-".concat(n),Object(o.k)(e,{level:n})))}),{})}},{key:"inputRules",value:function(t){var e=t.type;return this.options.levels.map((function(t){return Object(o.o)(new RegExp("^(#{1,".concat(t,"})\\s$")),e,(function(){return{level:t}}))}))}},{key:"name",get:function(){return"heading"}},{key:"defaultOptions",get:function(){return{levels:[1,2,3,4,5,6]}}},{key:"schema",get:function(){return{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:this.options.levels.map((function(t){return{tag:"h".concat(t),attrs:{level:t}}})),toDOM:function(t){return["h".concat(t.attrs.level),0]}}}}]),n}(r.e),ho=(r.e,/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/);r.e,r.e;function fo(t){var e=t.matcher,n=void 0===e?{char:"@",allowSpaces:!1,startOfLine:!1}:e,r=t.appendText,c=void 0===r?null:r,l=t.suggestionClass,f=void 0===l?"suggestion":l,d=t.command,v=void 0===d?function(){return!1}:d,m=t.items,y=void 0===m?[]:m,w=t.onEnter,x=void 0===w?function(){return!1}:w,C=t.onChange,S=void 0===C?function(){return!1}:C,k=t.onExit,O=void 0===k?function(){return!1}:k,M=t.onKeyDown,N=void 0===M?function(){return!1}:M,A=t.onFilter,E=void 0===A?function(t,e){return e?t.filter((function(t){return JSON.stringify(t).toLowerCase().includes(e.toLowerCase())})):t}:A;return new h.Plugin({key:new h.PluginKey("suggestions"),view:function(){var t=this;return{update:function(view,e){var n=t.key.getState(e),r=t.key.getState(view.state),l=n.active&&r.active&&n.range.from!==r.range.from,h=!n.active&&r.active,f=n.active&&!r.active,d=h||l,m=!h&&!f&&n.query!==r.query&&!l,w=f||l;if(d||m||w){var C=w?n:r,k=document.querySelector('[data-decoration-id="'.concat(C.decorationId,'"]')),M=k?{getBoundingClientRect:function(){return k.getBoundingClientRect()},clientWidth:k.clientWidth,clientHeight:k.clientHeight}:null,N={view:view,range:C.range,query:C.query,text:C.text,decorationNode:k,virtualNode:M,items:E(Array.isArray(y)?y:y(),C.query),command:function(t){var e=t.range,n=t.attrs;v({range:e,attrs:n,schema:view.state.schema})(view.state,view.dispatch,view),c&&Object(o.c)(c)(view.state,view.dispatch,view)}};w&&O(N),m&&S(N),d&&x(N)}}}},state:{init:function(){return{active:!1,range:{},query:null,text:null}},apply:function(tr,t){var e,r,o,c,l,h,f,d=tr.selection,v=Gr({},t);if(d.from===d.to){(d.from<t.range.from||d.from>t.range.to)&&(v.active=!1);var m=d.$from,y=(r=(e=n).char,o=void 0===r?"@":r,c=e.allowSpaces,l=void 0!==c&&c,h=e.startOfLine,f=void 0!==h&&h,function(t){if(t.depth<=0)return!1;for(var e,n="\\".concat(o),r=new RegExp("\\s".concat(n,"$")),c=f?"^":"",h=l?new RegExp("".concat(c).concat(n,".*?(?=\\s").concat(n,"|$)"),"gm"):new RegExp("".concat(c,"(?:^)?").concat(n,"[^\\s").concat(n,"]*"),"gm"),d=t.before(),v=t.end(),text=t.doc.textBetween(d,v,"\0","\0"),m=h.exec(text);null!==m;){var y=m.input.slice(Math.max(0,m.index-1),m.index);if(/^[\s\0]?$/.test(y)){var w=m.index+t.start(),x=w+m[0].length;l&&r.test(text.slice(x-1,x+1))&&(m[0]+=" ",x+=1),w<t.pos&&x>=t.pos&&(e={range:{from:w,to:x},query:m[0].slice(o.length),text:m[0]})}m=h.exec(text)}return e})(m),w=(Math.random()+1).toString(36).substr(2,5);y?(v.active=!0,v.decorationId=t.decorationId?t.decorationId:w,v.range=y.range,v.query=y.query,v.text=y.text):v.active=!1}else v.active=!1;return v.active||(v.decorationId=null,v.range={},v.query=null,v.text=null),v}},props:{handleKeyDown:function(view,t){var e=this.getState(view.state),n=e.active,r=e.range;return!!n&&N({view:view,event:t,range:r})},decorations:function(t){var e=this.getState(t),n=e.active,r=e.range,o=e.decorationId;return n?Xn.create(t.doc,[Jn.inline(r.from,r.to,{nodeName:"span",class:f,"data-decoration-id":o})]):null}}})}r.e,r.e;var po=Object(gr.tableNodes)({tableGroup:"block",cellContent:"block+",cellAttributes:{background:{default:null,getFromDOM:function(t){return t.style.backgroundColor||null},setDOMAttr:function(t,e){if(t){var style={style:"".concat(e.style||"","background-color: ").concat(t,";")};Object.assign(e,style)}}}}}),vo=(r.e,r.e,r.e,r.e,r.e,r.e,function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"keys",value:function(t){var e=t.type;return{"Mod-b":Object(o.r)(e)}}},{key:"commands",value:function(t){var e=t.type;return function(){return Object(o.r)(e)}}},{key:"inputRules",value:function(t){var e=t.type;return[Object(o.e)(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,e)]}},{key:"pasteRules",value:function(t){var e=t.type;return[Object(o.f)(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,e)]}},{key:"name",get:function(){return"bold"}},{key:"schema",get:function(){return{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(t){return"normal"!==t.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(t){return/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}}],toDOM:function(){return["strong",0]}}}}]),n}(r.d)),mo=function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"keys",value:function(t){var e=t.type;return{"Mod-`":Object(o.r)(e)}}},{key:"commands",value:function(t){var e=t.type;return function(){return Object(o.r)(e)}}},{key:"inputRules",value:function(t){var e=t.type;return[Object(o.e)(/(?:`)([^`]+)(?:`)$/,e)]}},{key:"pasteRules",value:function(t){var e=t.type;return[Object(o.f)(/(?:`)([^`]+)(?:`)/g,e)]}},{key:"name",get:function(){return"code"}},{key:"schema",get:function(){return{excludes:"_",parseDOM:[{tag:"code"}],toDOM:function(){return["code",0]}}}}]),n}(r.d),go=function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"keys",value:function(t){var e=t.type;return{"Mod-i":Object(o.r)(e)}}},{key:"commands",value:function(t){var e=t.type;return function(){return Object(o.r)(e)}}},{key:"inputRules",value:function(t){var e=t.type;return[Object(o.e)(/(?:^|[^_])(_([^_]+)_)$/,e),Object(o.e)(/(?:^|[^*])(\*([^*]+)\*)$/,e)]}},{key:"pasteRules",value:function(t){var e=t.type;return[Object(o.f)(/_([^_]+)_/g,e),Object(o.f)(/\*([^*]+)\*/g,e)]}},{key:"name",get:function(){return"italic"}},{key:"schema",get:function(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return["em",0]}}}}]),n}(r.d),yo=(r.d,r.d,r.d,function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"init",value:function(){var t=this;this.getSendableSteps=this.debounce((function(e){var n=function(t){var e=Cr.getState(t);return 0==e.unconfirmed.length?null:{version:e.version,steps:e.unconfirmed.map((function(s){return s.step})),clientID:Cr.get(t).spec.config.clientID,get origins(){return this._origins||(this._origins=e.unconfirmed.map((function(s){return s.origin})))}}}(e);n&&t.options.onSendable({editor:t.editor,sendable:{version:n.version,steps:n.steps.map((function(t){return t.toJSON()})),clientID:n.clientID}})}),this.options.debounce),this.editor.on("transaction",(function(e){var n=e.state;t.getSendableSteps(n)}))}},{key:"debounce",value:function(t,e){var n;return function(){for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];n&&clearTimeout(n),n=setTimeout((function(){t.apply(void 0,o),n=null}),e)}}},{key:"name",get:function(){return"collaboration"}},{key:"defaultOptions",get:function(){var t=this;return{version:0,clientID:Math.floor(4294967295*Math.random()),debounce:250,onSendable:function(){},update:function(e){var n=e.steps,r=e.version,o=t.editor,c=o.state,view=o.view,l=o.schema;(function(t){return Cr.getState(t).version})(c)>r||view.dispatch(kr(c,n.map((function(t){return Tt.d.fromJSON(l,t.step)})),n.map((function(t){return t.clientID}))))}}}},{key:"plugins",get:function(){return[Sr({version:this.options.version,clientID:this.options.clientID})]}}]),n}(r.c)),bo=(r.c,function(t){Zr(n,t);var e=ro(n);function n(){return Jr(this,n),e.apply(this,arguments)}return Kr(n,[{key:"keys",value:function(){return{"Mod-z":$r,"Mod-y":qr,"Shift-Mod-z":qr}}},{key:"commands",value:function(){return{undo:function(){return $r},redo:function(){return qr},undoDepth:function(){return Ur},redoDepth:function(){return Wr}}}},{key:"name",get:function(){return"history"}},{key:"defaultOptions",get:function(){return{depth:"",newGroupDelay:""}}},{key:"plugins",get:function(){return[Vr({depth:this.options.depth,newGroupDelay:this.options.newGroupDelay})]}}]),n}(r.c));r.c,r.c,r.c}}]);